(function(){NETRONIC_D365BC=window.NETRONIC_D365BC||{};NETRONIC_D365BC.nVSWidget=NETRONIC_D365BC.nVSWidget||{};NETRONIC_D365BC.nVSWidget.ViewType={Activities:0,Resources:1,Loads:2};NETRONIC_D365BC.nVSWidget.ObjectType={TimeArea:-2,Timescale:-1,Activity:1,Allocation:2,AllocationEntry:3,Resource:5,Link:6,Curve:7,Entity:13};NETRONIC_D365BC.nVSWidget.DragMode={None:0,DragStart:1,DragEnd:2,DragHor:4,DragVer:8};NETRONIC_D365BC.nVSWidget.SnapTargets={None:0,Start:1,End:2,DateLines:4,CalendarGrids:8,DateLineGrids:16};NETRONIC_D365BC.nVSWidget.TableType={Gantt:0,Entities:1};NETRONIC_D365BC.nVSWidget.AllocationBarDesign={Allocation:0,Entries:1,AllocationAndEntries:2,MergedEntries:3,GroupedEntries:4};NETRONIC_D365BC.nVSWidget.RowDesigns={None:0,Bars:1,Optimized:2,BarsInHiddenDescendantRows:4,CalendarGrid:8};NETRONIC_D365BC.nVSWidget.HorizontalAlignment={Left:0,Center:1,Right:2};NETRONIC_D365BC.nVSWidget.CollapseState={Unchanged:-1,Expanded:0,Collapsed:1};NETRONIC_D365BC.nVSWidget.UpdateModes={UpdateOnly:0,ImplicitAddObjects:1};NETRONIC_D365BC.nVSWidget.ActivityBarDragModes={None:0,DragStart:1,DragEnd:2,DragHorizontally:4,DragVertically:8,DragAutoHorOrVer:16};NETRONIC_D365BC.nVSWidget.AllocationBarDragModes={None:0,DragStart:1,DragEnd:2,DragHorizontally:4,DragVertically:8,DragAutoHorOrVer:16};NETRONIC_D365BC.nVSWidget.RowDragModes={None:0,DragOutside:32};NETRONIC_D365BC.nVSWidget.VisualType={Background:-1,Bar:0,Row:1,Curve:2,Link:3,CalendarGrid:4};NETRONIC_D365BC.nVSWidget.DateLineGridModes={None:0,Auto:1,Weekly:2,Daily:4}})();NETRONIC_D365BC.nVSWidget.versionNumber="5.0.1";NETRONIC_D365BC.nVSWidget.copyrightYear="2020-2021";NETRONIC_D365BC.nVSWidget.hamletVersionNumber="5.0.4",function(){netronic.nClassFactory.extendClass(NETRONIC_D365BC.nVSWidget,"nActivity",netronic.nResourcePlanningAppBase.rabActivity,{});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nActivity.prototype,"AddIn_BarText",{get:function(){return this._data.AddIn_BarText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nActivity.prototype,"AddIn_ContextMenuID",{get:function(){return this._data.AddIn_ContextMenuID}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nActivity.prototype,"AddIn_TableSortCode",{get:function(){var n=this._data.AddIn_TableSortCode;return n==null?"":this._data.AddIn_TableSortCode.toString()}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nActivity.prototype,"AddIn_TableText",{get:function(){return this._data.AddIn_TableText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nActivity.prototype,"AddIn_TooltipText",{get:function(){return this._data.AddIn_TooltipText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nActivity.prototype,"PM_AllowedBarDragModes",{get:function(){return this._data.PM_AllowedBarDragModes===-1?undefined:this._data.PM_AllowedBarDragModes}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nActivity.prototype,"PM_BarHeight",{get:function(){return this._data.PM_BarHeight===-1?undefined:this._data.PM_BarHeight}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nActivity.prototype,"PM_CollapsedRowDesign",{get:function(){return this._data.PM_CollapsedRowDesign===-1?undefined:this._data.PM_CollapsedRowDesign}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nActivity.prototype,"PM_ExpandedRowDesign",{get:function(){return this._data.PM_ExpandedRowDesign==-1?undefined:this._data.PM_ExpandedRowDesign}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nActivity.prototype,"PM_MinimumRowHeight",{get:function(){return this._data.PM_MinimumRowHeight==-1?undefined:this._data.PM_MinimumRowHeight}})}(),function(){netronic.nClassFactory.extendClass(NETRONIC_D365BC.nVSWidget,"nAllocation",netronic.nResourcePlanningAppBase.rabAllocation,{});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nAllocation.prototype,"AddIn_BarText",{get:function(){return this._data.AddIn_BarText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nAllocation.prototype,"AddIn_ContextMenuID",{get:function(){return this._data.AddIn_ContextMenuID}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nAllocation.prototype,"AddIn_TooltipText",{get:function(){return this._data.AddIn_TooltipText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nAllocation.prototype,"PM_AllowedBarDragModes",{get:function(){return this._data.PM_AllowedBarDragModes===-1?undefined:this._data.PM_AllowedBarDragModes}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nAllocation.prototype,"PM_AllowedBarDragModesInActivitiesView",{get:function(){return this._data.PM_AllowedBarDragModesInActivitiesView===-1?undefined:this._data.PM_AllowedBarDragModesInActivitiesView}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nAllocation.prototype,"PM_BarHeight",{get:function(){return this._data.PM_BarHeight===-1?undefined:this._data.PM_BarHeight}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nAllocation.prototype,"PM_RowDesign",{get:function(){return this._data.PM_RowDesign===-1?undefined:this._data.PM_RowDesign}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nAllocation.prototype,"PM_SnapTargetsForEnd",{get:function(){return this._data.PM_SnapTargetsForEnd===-1?undefined:this._data.PM_SnapTargetsForEnd}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nAllocation.prototype,"PM_SnapTargetsForStart",{get:function(){return this._data.PM_SnapTargetsForStart===-1?undefined:this._data.PM_SnapTargetsForStart}})}(),function(){netronic.nClassFactory.extendClass(NETRONIC_D365BC.nVSWidget,"nAllocationEntry",netronic.nResourcePlanningAppBase.rabAllocationEntry,{});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nAllocationEntry.prototype,"PM_Height",{get:function(){return this._data.PM_Height===-1?undefined:this._data.PM_Height}})}(),function(){netronic.nClassFactory.extendClass(NETRONIC_D365BC.nVSWidget,"nEntity",netronic.nResourcePlanningAppBase.rabEntity,{});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nEntity.prototype,"AddIn_ContextMenuID",{get:function(){return this._data.AddIn_ContextMenuID}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nEntity.prototype,"AddIn_TableSortCode",{get:function(){var n=this._data.AddIn_TableSortCode;return n==null?"":this._data.AddIn_TableSortCode.toString()}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nEntity.prototype,"AddIn_TableText",{get:function(){return this._data.AddIn_TableText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nEntity.prototype,"AddIn_TooltipText",{get:function(){return this._data.AddIn_TooltipText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nEntity.prototype,"PM_AllowedRowDragModes",{get:function(){return this._data.PM_AllowedRowDragModes===-1?undefined:this._data.PM_AllowedRowDragModes}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nEntity.prototype,"PM_MinimumRowHeight",{get:function(){return this._data.PM_MinimumRowHeight===-1?undefined:this._data.PM_MinimumRowHeight}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nEntity.prototype,"PM_RowCollapsible",{get:function(){return this._data.PM_RowCollapsible===-1?undefined:this._data.PM_RowCollapsible}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nEntity.prototype,"PM_RowSelectable",{get:function(){return this._data.PM_RowSelectable===-1?undefined:this._data.PM_RowSelectable}})}(),function(){netronic.nClassFactory.extendClass(NETRONIC_D365BC.nVSWidget,"nLink",netronic.nResourcePlanningAppBase.rabLink,{});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nLink.prototype,"AddIn_ContextMenuID",{get:function(){return this._data.AddIn_ContextMenuID}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nLink.prototype,"AddIn_TooltipText",{get:function(){return this._data.AddIn_TooltipText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nLink.prototype,"PM_RoutingType",{get:function(){return this._data.PM_RoutingType===-1?undefined:this._data.PM_RoutingType}})}(),function(){var n=netronic.nGanttWidget.DisplayedElements;netronic.nClassFactory.extendClass(NETRONIC_D365BC.nVSWidget,"nResource",netronic.nResourcePlanningAppBase.rabResource,{});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nResource.prototype,"AddIn_TooltipText",{get:function(){return this._data.AddIn_TooltipText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nResource.prototype,"AddIn_TableText",{get:function(){return this._data.AddIn_TableText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nResource.prototype,"AddIn_ContextMenuID",{get:function(){return this._data.AddIn_ContextMenuID}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nResource.prototype,"AddIn_TableSortCode",{get:function(){var n=this._data.AddIn_TableSortCode;return n==null?"":this._data.AddIn_TableSortCode.toString()}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nResource.prototype,"PM_CollapsedRowDesign",{get:function(){return this._data.PM_CollapsedRowDesign===-1?undefined:this._data.PM_CollapsedRowDesign}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nResource.prototype,"PM_ExpandedRowDesign",{get:function(){return this._data.PM_ExpandedRowDesign===-1?undefined:this._data.PM_ExpandedRowDesign}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nResource.prototype,"PM_MinimumRowHeight",{get:function(){return this._data.PM_MinimumRowHeight===-1?undefined:this._data.PM_MinimumRowHeight}})}(),function(){netronic.nClassFactory.extendClass(NETRONIC_D365BC.nVSWidget,"nCurve",netronic.nResourcePlanningAppBase.rabCurve,{});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nCurve.prototype,"Type",{get:function(){return this._data.Type||0}})}(),function(){netronic.nClassFactory.extendClass(NETRONIC_D365BC.nVSWidget,"nPeriodHighlighterEntry",netronic.nResourcePlanningAppBase.rabPeriodHighlighterEntry,{});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nPeriodHighlighterEntry.prototype,"AddIn_TooltipText",{get:function(){return this._data.AddIn_TooltipText}});Object.defineProperty(NETRONIC_D365BC.nVSWidget.nPeriodHighlighterEntry.prototype,"AddIn_ContextMenuID",{get:function(){return this._data.AddIn_ContextMenuID}})}(),function(){var n={construct:function(n){"use strict";var t=this;t._super(n,{modelOptions:{curveClass:NETRONIC_D365BC.nVSWidget.nCurve,activityClass:NETRONIC_D365BC.nVSWidget.nActivity,allocationClass:NETRONIC_D365BC.nVSWidget.nAllocation,allocationEntryClass:NETRONIC_D365BC.nVSWidget.nAllocationEntry,linkClass:NETRONIC_D365BC.nVSWidget.nLink,resourceClass:NETRONIC_D365BC.nVSWidget.nResource,entityClass:NETRONIC_D365BC.nVSWidget.nEntity,periodHighlighterEntryClass:NETRONIC_D365BC.nVSWidget.nPeriodHighlighterEntry},ganttViewClass:NETRONIC_D365BC.nVSWidget.nGanttView,ganttViewOptions:{ganttWidget:{rowItemsSelectable:!0}},viewClass:NETRONIC_D365BC.nVSWidget.nView})},_addObject:function(n,t,i){"use strict";var r=this;r._super(n,t,i)}};netronic.nClassFactory.extendClass(NETRONIC_D365BC.nVSWidget,"nApplication",netronic.nResourcePlanningAppBase.rabWidgetApplication,n)}(jQuery),function(){var n=netronic.nResourcePlanningAppBase.ItemType,t=NETRONIC_D365BC.nVSWidget.VisualType,r=netronic.nGanttWidget.ElemType,i=netronic.nGanttWidget.BarShape,u={construct:function(n,t,i,r,u){"use strict";var f=this;f._super(n,t,i,r,u)},_createBarFunc:function(t){"use strict";var o=this,r,f,u,e;this._super(t);r=t.timeItem;r.rab_itemType===n.Allocation?f=r.data():r.rab_itemType===n.Activity&&(f=r.data());u=t.timeItem.barShape;f&&(u===i.Rectangle||u===i.RectangleWithLeftTopBevel||u===i.Summary||u===i.Diamond)&&(e=f.AddIn_BarText,e&&(t.caption==null||typeof t.caption=="string"?t.caption=e:t.caption.text=e))},_handleContextMenuEvent:function(i){"use strict";var f=this,u,h,o,e,s,c,l,a,v;f._super(i);typeof i.sender=="object"&&(u=i.sender,u&&(u.rab_itemType===n.PeriodHighlighterEntry?(i.visualType=t.PeriodHighlighter,u=i.rowItem):i.visualType=i.elemType===r.Row?t.Background:u.rab_itemType===n.Resource||u.rab_itemType===n.Entity||u.rab_itemType===n.ActivityRow?t.Row:t.Bar,o=(u.rab_itemType===n.AllocationEntry?u.rab_parentItem:u).data(),e=o,i.visualType===t.PeriodHighlighter&&(e=o.PM_PeriodHighlighterID?f.viewModel().model().periodHighlighterByID(o.PM_PeriodHighlighterID):f.viewModel().model().calendarGridByID(o.PM_CalendarGridID),e&&e.Entries&&(e=e.Entries[i.sender.entries[i.entryIndex].rab_entryIndex])),s=e&&e.AddIn_ContextMenuID,s&&(c=f.app().getOption("widget")._contextMenus[s],c&&(l=c.Items,l&&(a=[],v=l.map(function(n,t){var i=n?typeof n=="object"?n.Text:n:undefined;return{Text:i!=null?"<div>"+i.toString()+"<\/div>":"undefined",Code:n&&n.Code!=null?n.Code.toString():undefined,SortCode:n&&n.SortCode!=null?n.SortCode.toString():undefined,index:t}}).sort(function(n,t){var i=n.SortCode,r=t.SortCode,f=i!=null,u=r!=null;return f?u?i>r?1:i<r?-1:0:1:u?-1:n.index1-t.index2}),v.forEach(function(n,t){a.push({title:n.Text,cmd:t.toString()})}),h=netronic.nPopup.showContextMenu(f.ganttWidget().element[0],a,i.event)))),h?h.done(function(r,e){var c=v[parseInt(e)],h={ContextMenuID:s,ContextMenuItemIndex:c.index,ContextMenuItemCode:c.Code,ItemIndex:c.index,ObjectID:o.ID,ObjectType:f.getObjectTypeFromItem(u),VisualType:i.visualType};u.rab_itemType!==n.ActivityRow&&u.rab_itemType!==n.Entity&&(h.Date=f._ganttWidget.pageXToDate(i.event.pageX));u.rab_itemType===n.Resource&&h.Date<f._ganttWidget.timeAxis().currentlyVisibleStart()&&delete h.Date;i.visualType===t.PeriodHighlighter&&(h.CalendarGridID=h.PeriodHighlighterID=u.data().PM_PeriodHighlighterID,h.CalendarGridEntryIndex=h.PeriodHighlighterEntryIndex=i.sender.entries[i.entryIndex].rab_entryIndex);f.app().getOption("widget")._callOnContextMenuItemClicked(h)}):netronic.nPopup.closeContextMenu()))}};netronic.nClassFactory.extendClass(NETRONIC_D365BC.nVSWidget,"nGanttView",netronic.nResourcePlanningAppBase.rabWidgetGanttView,u)}(jQuery),function(n){var u=NETRONIC_D365BC.nVSWidget.Mode,t=netronic.nResourcePlanningAppBase.RowDesigns,i=netronic.nGanttWidget.BarSnapTargets,r="nvs";n.widget("NETRONIC_D365BC.nVSWidget",netronic.nResourcePlanningAppBase.rabWidget,{_contextMenus:{},options:{applicationClass:NETRONIC_D365BC.nVSWidget.nApplication,newCallbackBehaviorEnabled:!0,pm_defaultAllocationBarDesign:netronic.nResourcePlanningAppBase.AllocationBarDesign.GroupedEntries,pm_contextMenuCallbackOnRowInTimeArea:!0,pm_defaultActivityCollapsedRowDesign:t.Bars|t.Optimized|t.CalendarGrid,pm_defaultActivityExpandedRowDesign:t.Bars|t.Optimized|t.CalendarGrid,pm_defaultResourceCollapsedRowDesign:t.Bars|t.Optimized|t.CalendarGrid,pm_defaultResourceExpandedRowDesign:t.Bars|t.Optimized|t.CalendarGrid,pm_defaultAllocationSnapTargetsForStart:i.Start|i.End|i.CalendarGrids,pm_defaultAllocationSnapTargetsForEnd:i.Start|i.End|i.CalendarGrids,pm_defaultActivitySnapTargetsForStart:i.CalendarGrids,pm_defaultActivitySnapTargetsForEnd:i.CalendarGrids,pm_defaultLinkSelectable:!1,additionalDateInterpretedAsEmpty:"0001-01-01T00:00:00.0000000",locale:"en-US",weekNumbering:"ISO8601",tableViewWidth:300,customName:"VS Add-in Developers Toolbox Control Add-in",customCopyrightYear:NETRONIC_D365BC.nVSWidget.copyrightYear,customVersion:NETRONIC_D365BC.nVSWidget[window.Hamlet?"hamletVersionNumber":"versionNumber"],onContextMenuItemClicked:null},_create:function(){this.element.addClass(r+"-widget");this._super()},_destroy:function(){this._super();this.element.removeClass(r+"-widget")},_setOption:function(n,t){"use strict";switch(n){case"onContextMenuItemClicked":this.options[n]=t;break;case"viewType":if(t===-1)return;case"entitiesTableViewWidth":case"entitiesTableWidth":case"tableViewWidth":case"tableViewWidthInActivitiesView":case"tableViewWidthInLoadsView":case"tableViewWidthInResourcesView":case"tableWidth":case"pm_forcedAllocationAllowedBarDragModes":case"pm_forcedAllocationAllowedBarDragModesInActivitiesView":case"pm_forcedActivityAllowedBarDragModes":t===-1&&(t=null);default:this._super(n,t)}},addContextMenus:function(n){"use strict";var t=this;Array.isArray(n)&&n.forEach(function(n){n&&typeof n.ID=="string"&&Array.isArray(n.Items)&&(t._contextMenus[n.ID]=n)})},updateContextMenus:function(n){"use strict";var t=this;Array.isArray(n)&&n.forEach(function(n){n&&typeof n.ID=="string"&&Array.isArray(n.Items)&&(t._contextMenus[n.ID]=n)})},removeContextMenus:function(n){"use strict";var t=this;Array.isArray(n)&&n.forEach(function(n){n&&(typeof n=="string"?delete t._contextMenus[n]:typeof n.ID=="string"&&delete t._contextMenus[n.ID])})},_callOnContextMenuItemClicked:function(n){"use strict";typeof this.options.onContextMenuItemClicked=="function"&&this.options.onContextMenuItemClicked.call(this,n)}});NETRONIC_D365BC.nVSWidget=n.extend(n.NETRONIC_D365BC.nVSWidget,NETRONIC_D365BC.nVSWidget)}(jQuery);var windowsLCIDToBCP47Map={"4":"zh_CHS","1025":"ar_SA","1026":"bg_BG","1027":"ca_ES","1028":"zh_TW","1029":"cs_CZ","1030":"da_DK","1031":"de_DE","1032":"el_GR","1033":"en_US","1034":"es_ES","1035":"fi_FI","1036":"fr_FR","1037":"he_IL","1038":"hu_HU","1039":"is_IS","1040":"it_IT","1041":"ja_JP","1042":"ko_KR","1043":"nl_NL","1044":"nb_NO","1045":"pl_PL","1046":"pt_BR","1047":"rm_CH","1048":"ro_RO","1049":"ru_RU","1050":"hr_HR","1051":"sk_SK","1052":"sq_AL","1053":"sv_SE","1054":"th_TH","1055":"tr_TR","1056":"ur_PK","1057":"id_ID","1058":"uk_UA","1059":"be_BY","1060":"sl_SI","1061":"et_EE","1062":"lv_LV","1063":"lt_LT","1064":"tg_TJ","1065":"fa_IR","1066":"vi_VN","1067":"hy_AM","1069":"eu_ES","1070":"wen_DE","1071":"mk_MK","1074":"tn_ZA","1076":"xh_ZA","1077":"zu_ZA","1078":"af_ZA","1079":"ka_GE","1080":"fo_FO","1081":"hi_IN","1082":"mt_MT","1083":"se_NO","1086":"ms_MY","1087":"kk_KZ","1088":"ky_KG","1089":"sw_KE","1090":"tk_TM","1092":"tt_RU","1093":"bn_IN","1094":"pa_IN","1095":"gu_IN","1096":"or_IN","1097":"ta_IN","1098":"te_IN","1099":"kn_IN","1100":"ml_IN","1101":"as_IN","1102":"mr_IN","1103":"sa_IN","1104":"mn_MN","1105":"bo_CN","1106":"cy_GB","1107":"kh_KH","1108":"lo_LA","1109":"my_MM","1110":"gl_ES","1111":"kok_IN","1114":"syr_SY","1115":"si_LK","1118":"am_ET","1121":"ne_NP","1122":"fy_NL","1123":"ps_AF","1124":"fil_PH","1125":"div_MV","1128":"ha_NG","1130":"yo_NG","1131":"quz_BO","1132":"ns_ZA","1133":"ba_RU","1134":"lb_LU","1135":"kl_GL","1144":"ii_CN","1146":"arn_CL","1148":"moh_CA","1150":"br_FR","1152":"ug_CN","1153":"mi_NZ","1154":"oc_FR","1155":"co_FR","1156":"gsw_FR","1157":"sah_RU","1158":"qut_GT","1159":"rw_RW","1160":"wo_SN","1164":"gbz_AF","2049":"ar_IQ","2052":"zh_CN","2055":"de_CH","2057":"en_GB","2058":"es_MX","2060":"fr_BE","2064":"it_CH","2067":"nl_BE","2068":"nn_NO","2070":"pt_PT","2077":"sv_FI","2080":"ur_IN","2092":"az_AZ","2094":"dsb_DE","2107":"se_SE","2108":"ga_IE","2110":"ms_BN","2115":"uz_UZ","2128":"mn_CN","2129":"bo_BT","2141":"iu_CA","2143":"tmz_DZ","2155":"quz_EC","3073":"ar_EG","3076":"zh_HK","3079":"de_AT","3081":"en_AU","3082":"es_ES","3084":"fr_CA","3098":"sr_SP","3131":"se_FI","3179":"quz_PE","4097":"ar_LY","4100":"zh_SG","4103":"de_LU","4105":"en_CA","4106":"es_GT","4108":"fr_CH","4122":"hr_BA","4155":"smj_NO","5121":"ar_DZ","5124":"zh_MO","5127":"de_LI","5129":"en_NZ","5130":"es_CR","5132":"fr_LU","5179":"smj_SE","6145":"ar_MA","6153":"en_IE","6154":"es_PA","6156":"fr_MC","6203":"sma_NO","7169":"ar_TN","7177":"en_ZA","7178":"es_DO","7194":"sr_BA","7227":"sma_SE","8193":"ar_OM","8201":"en_JA","8202":"es_VE","8218":"bs_BA","8251":"sms_FI","9217":"ar_YE","9225":"en_CB","9226":"es_CO","9242":"rs_latn_RS","9275":"smn_FI","10241":"ar_SY","10249":"en_BZ","10250":"es_PE","11265":"ar_JO","11273":"en_TT","11274":"es_AR","12289":"ar_LB","12297":"en_ZW","12298":"es_EC","13313":"ar_KW","13321":"en_PH","13322":"es_CL","14337":"ar_AE","14346":"es_UR","15361":"ar_BH","15370":"es_PY","16385":"ar_QA","16394":"es_BO","17417":"en_MY","17418":"es_SV","18441":"en_IN","18442":"es_HN","19466":"es_NI","20490":"es_PR","21514":"es_US","31748":"zh_CHT"},windowsTimeZoneToIANAMap={"Dateline Standard Time":"Etc/GMT+12","UTC-11":"Etc/GMT+11","Aleutian Standard Time":"America/Adak","Hawaiian Standard Time":"Pacific/Honolulu","Marquesas Standard Time":"Pacific/Marquesas","Alaskan Standard Time":"America/Anchorage","UTC-09":"Etc/GMT+9","Pacific Standard Time (Mexico)":"America/Tijuana","UTC-08":"Etc/GMT+8","Pacific Standard Time":"America/Los_Angeles","US Mountain Standard Time":"America/Phoenix","Mountain Standard Time (Mexico)":"America/Chihuahua","Mountain Standard Time":"America/Denver","Central America Standard Time":"America/Guatemala","Central Standard Time":"America/Chicago","Easter Island Standard Time":"Pacific/Easter","Central Standard Time (Mexico)":"America/Mexico_City","Canada Central Standard Time":"America/Regina","SA Pacific Standard Time":"America/Bogota","Eastern Standard Time (Mexico)":"America/Cancun","Eastern Standard Time":"America/New_York","Haiti Standard Time":"America/Port-au-Prince","Cuba Standard Time":"America/Havana","US Eastern Standard Time":"America/Indianapolis","Paraguay Standard Time":"America/Asuncion","Atlantic Standard Time":"America/Halifax","Venezuela Standard Time":"America/Caracas","Central Brazilian Standard Time":"America/Cuiaba","SA Western Standard Time":"America/La_Paz","Pacific SA Standard Time":"America/Santiago","Turks And Caicos Standard Time":"America/Grand_Turk","Newfoundland Standard Time":"America/St_Johns","Tocantins Standard Time":"America/Araguaina","E. South America Standard Time":"America/Sao_Paulo","SA Eastern Standard Time":"America/Cayenne","Argentina Standard Time":"America/Buenos_Aires","Greenland Standard Time":"America/Godthab","Montevideo Standard Time":"America/Montevideo","Magallanes Standard Time":"America/Punta_Arenas","Saint Pierre Standard Time":"America/Miquelon","Bahia Standard Time":"America/Bahia","UTC-02":"Etc/GMT+2","Azores Standard Time":"Atlantic/Azores","Cape Verde Standard Time":"Atlantic/Cape_Verde",UTC:"Etc/GMT","GMT Standard Time":"Europe/London","Greenwich Standard Time":"Atlantic/Reykjavik","W. Europe Standard Time":"Europe/Berlin","Central Europe Standard Time":"Europe/Budapest","Romance Standard Time":"Europe/Paris","Morocco Standard Time":"Africa/Casablanca","Sao Tome Standard Time":"Africa/Sao_Tome","Central European Standard Time":"Europe/Warsaw","W. Central Africa Standard Time":"Africa/Lagos","Jordan Standard Time":"Asia/Amman","GTB Standard Time":"Europe/Bucharest","Middle East Standard Time":"Asia/Beirut","Egypt Standard Time":"Africa/Cairo","E. Europe Standard Time":"Europe/Chisinau","Syria Standard Time":"Asia/Damascus","West Bank Standard Time":"Asia/Hebron","South Africa Standard Time":"Africa/Johannesburg","FLE Standard Time":"Europe/Kiev","Israel Standard Time":"Asia/Jerusalem","Kaliningrad Standard Time":"Europe/Kaliningrad","Sudan Standard Time":"Africa/Khartoum","Libya Standard Time":"Africa/Tripoli","Namibia Standard Time":"Africa/Windhoek","Arabic Standard Time":"Asia/Baghdad","Turkey Standard Time":"Europe/Istanbul","Arab Standard Time":"Asia/Riyadh","Belarus Standard Time":"Europe/Minsk","Russian Standard Time":"Europe/Moscow","E. Africa Standard Time":"Africa/Nairobi","Iran Standard Time":"Asia/Tehran","Arabian Standard Time":"Asia/Dubai","Astrakhan Standard Time":"Europe/Astrakhan","Azerbaijan Standard Time":"Asia/Baku","Russia Time Zone 3":"Europe/Samara","Mauritius Standard Time":"Indian/Mauritius","Saratov Standard Time":"Europe/Saratov","Georgian Standard Time":"Asia/Tbilisi","Caucasus Standard Time":"Asia/Yerevan","Afghanistan Standard Time":"Asia/Kabul","West Asia Standard Time":"Asia/Tashkent","Ekaterinburg Standard Time":"Asia/Yekaterinburg","Pakistan Standard Time":"Asia/Karachi","India Standard Time":"Asia/Calcutta","Sri Lanka Standard Time":"Asia/Colombo","Nepal Standard Time":"Asia/Katmandu","Central Asia Standard Time":"Asia/Almaty","Bangladesh Standard Time":"Asia/Dhaka","Omsk Standard Time":"Asia/Omsk","Myanmar Standard Time":"Asia/Rangoon","SE Asia Standard Time":"Asia/Bangkok","Altai Standard Time":"Asia/Barnaul","W. Mongolia Standard Time":"Asia/Hovd","North Asia Standard Time":"Asia/Krasnoyarsk","N. Central Asia Standard Time":"Asia/Novosibirsk","Tomsk Standard Time":"Asia/Tomsk","China Standard Time":"Asia/Shanghai","North Asia East Standard Time":"Asia/Irkutsk","Singapore Standard Time":"Asia/Singapore","W. Australia Standard Time":"Australia/Perth","Taipei Standard Time":"Asia/Taipei","Ulaanbaatar Standard Time":"Asia/Ulaanbaatar","Aus Central W. Standard Time":"Australia/Eucla","Transbaikal Standard Time":"Asia/Chita","Tokyo Standard Time":"Asia/Tokyo","North Korea Standard Time":"Asia/Pyongyang","Korea Standard Time":"Asia/Seoul","Yakutsk Standard Time":"Asia/Yakutsk","Cen. Australia Standard Time":"Australia/Adelaide","AUS Central Standard Time":"Australia/Darwin","E. Australia Standard Time":"Australia/Brisbane","AUS Eastern Standard Time":"Australia/Sydney","West Pacific Standard Time":"Pacific/Port_Moresby","Tasmania Standard Time":"Australia/Hobart","Vladivostok Standard Time":"Asia/Vladivostok","Lord Howe Standard Time":"Australia/Lord_Howe","Bougainville Standard Time":"Pacific/Bougainville","Russia Time Zone 10":"Asia/Srednekolymsk","Magadan Standard Time":"Asia/Magadan","Norfolk Standard Time":"Pacific/Norfolk","Sakhalin Standard Time":"Asia/Sakhalin","Central Pacific Standard Time":"Pacific/Guadalcanal","Russia Time Zone 11":"Asia/Kamchatka","New Zealand Standard Time":"Pacific/Auckland","UTC+12":"Etc/GMT-12","Fiji Standard Time":"Pacific/Fiji","Chatham Islands Standard Time":"Pacific/Chatham","UTC+13":"Etc/GMT-13","Tonga Standard Time":"Pacific/Tongatapu","Samoa Standard Time":"Pacific/Apia","Line Islands Standard Time":"Pacific/Kiritimati"};(function(n){netronic_D365BC=window.netronic_D365BC||{};var t=nwaf_rab.ObjectType,i={construct:function(){"use strict";this._options={AddIn_FullObjectsInEvents:!1,AddIn_HamletTooltips:!1,AddIn_HamletTableText:!1,AddIn_OnDropWithCompletion:!1,AddIn_OnCollapseStateChangedWithCompletion:!1,AddIn_OnCurveCollapseStateChangedWithCompletion:!1,AddIn_PingTimeInMilliseconds:0,AddIn_KeydownList:null,AddIn_KeyupList:null,AddIn_ProductName:null,AddIn_ProductVersion:null,AddIn_ForcedFillOfPageSpace:!1,AddIn_DeselectionOfRowsOrBarsOnLinkContextMenu:!0,AddIn_ActivitySortCodeSources:null,AddIn_AllocationSortCodeSources:null,AddIn_EntitySortCodeSources:null,AddIn_ResourceSortCodeSources:null};this._interfaceReady=!1;this._implementInterface();this._prepareWorkArea();this._completionDeferreds={};this._nextCompletionID=0},_implementInterface:function(){"use strict";var n=this;this._interfaceReady===!1&&(window.FitFullTimeAreaIntoView=function(){n._II_fitTimeAreaIntoView()},window.FitTimeAreaIntoView=function(t,i){n._II_fitTimeAreaIntoView(t,i)},window.SetTimeResolutionForView=function(t,i,r){n._II_setTimeResolutionForView(t,i,r)},window.SaveAsPDF=function(t,i){n._II_saveAsPDF(t,i)},window.RemoveAll=function(){n._II_removeAll()},window.Render=function(){n._II_render()},window.ScrollToDate=function(t){n._II_scrollToDate(t)},window.ScrollToObject=function(t,i,r,u){n._II_scrollToObject(t,i,r,u)},window.SelectObjects=function(t,i,r){n._II_selectObjects(t,i,r)},window.SetSettings=function(t){n._II_setSettings(t)},window.About=function(){n._II_about()},window.AddActivities=function(t){n._II_addActivities(t)},window.UpdateActivities=function(t){n._II_updateActivities(t)},window.RemoveActivities=function(t){n._II_removeActivities(t)},window.AddAllocations=function(t){n._II_addAllocations(t)},window.UpdateAllocations=function(t){n._II_updateAllocations(t)},window.RemoveAllocations=function(t){n._II_removeAllocations(t)},window.AddCalendars=function(t){n._II_addCalendars(t)},window.UpdateCalendars=function(t){n._II_updateCalendars(t)},window.RemoveCalendars=function(t){n._II_removeCalendars(t)},window.AddCurves=function(t){n._II_addCurves(t)},window.UpdateCurves=function(t){n._II_updateCurves(t)},window.RemoveCurves=function(t){n._II_removeCurves(t)},window.AddResources=function(t){n._II_addResources(t)},window.UpdateResources=function(t){n._II_updateResources(t)},window.RemoveResources=function(t){n._II_removeResources(t)},window.AddLinks=function(t){n._II_addLinks(t)},window.UpdateLinks=function(t){n._II_updateLinks(t)},window.RemoveLinks=function(t){n._II_removeLinks(t)},window.AddEntities=function(t){n._II_addEntities(t)},window.UpdateEntities=function(t){n._II_updateEntities(t)},window.RemoveEntities=function(t){n._II_removeEntities(t)},window.AddSymbols=function(t){n._II_addSymbols(t)},window.UpdateSymbols=function(t){n._II_updateSymbols(t)},window.RemoveSymbols=function(t){n._II_removeSymbols(t)},window.AddContextMenus=function(t){n._II_addContextMenus(t)},window.UpdateContextMenus=function(t){n._II_updateContextMenus(t)},window.RemoveContextMenus=function(t){n._II_removeContextMenus(t)},window.AddCalendarGrids=function(t){n._II_addPeriodHighlighters(t)},window.UpdateCalendarGrids=function(t){n._II_updatePeriodHighlighters(t)},window.RemoveCalendarGrids=function(t){n._II_removePeriodHighlighters(t)},window.AddPeriodHighlighters=function(t){n._II_addPeriodHighlighters(t)},window.UpdatePeriodHighlighters=function(t){n._II_updatePeriodHighlighters(t)},window.RemovePeriodHighlighters=function(t){n._II_removePeriodHighlighters(t)},window.AddDateLines=function(t){n._II_addDateLines(t)},window.UpdateDateLines=function(t){n._II_updateDateLines(t)},window.RemoveDateLines=function(t){n._II_removeDateLines(t)},window.AddTooltipTemplates=function(t){n._II_addTooltipTemplates(t)},window.UpdateTooltipTemplates=function(t){n._II_updateTooltipTemplates(t)},window.RemoveTooltipTemplates=function(t){n._II_removeTooltipTemplates(t)},window.AddTableRowDefinitions=function(t){n._II_addTableRowDefinitions(t)},window.UpdateTableRowDefinitios=function(t){n._II_updateTableRowDefinitions(t)},window.RemoveTableRowDefinitions=function(t){n._II_removeTableRowDefinitions(t)},window.EventProcessingDone=function(t){n._II_eventProcessingDone(t)},window.LogToConsole=window.LogTextToConsole=window.LogJsonArrayToConsole=function(n){console&&console.log(n)},this._interfaceReady=!0)},_prepareWorkArea:function(){"use strict";var t,n,i;this._vsWidget||(t=document.getElementById("controlAddIn"),n=document.createElement("div"),n.setAttribute("id","WorkArea"),n.setAttribute("style","height: 100%; width: 100%;"),n.setAttribute("class","nvs-logo"),t.appendChild(n),i={Version:NETRONIC_D365BC.nVSWidget[window.Hamlet?"hamletVersionNumber":"versionNumber"]},Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnRequestSettings",[i]))},_stretchContainer:function(){"use strict";var h=netronic.nScrollBarWidthDetector.scrollBarWidth(),i=n(window.frameElement),t,s,r,o;if(i.length!==0){if(t=i.closest(".ms-nav-scrollable"),t.length!==0){var u=t[0].getBoundingClientRect().height,f=t.prop("scrollHeight"),e=0;f>u&&(e=f-u);i.css("max-height","10000px");i.css("height","10000px");s=t.prop("scrollHeight");r=s===f?u-h+e:u-(s-1e4)-h+e;o=i.css("min-height").replace("px","");r<o&&(r=o);i.css("height",r+"px");i.css("max-height",r+"px");return}if(t=n(parent.document).find(".ms-core-overlay"),t.length===0&&(t=n(parent.document).find(".entity-content-container"),t.length!==0)){i=t.find("iframe:first");i.css("height",t.prop("offsetHeight")-3+"px");return}if(t.length!==0){var u=t[0].getBoundingClientRect().height,f=t.prop("scrollHeight"),e=0;f>u&&(e=f-u);i=n(parent.document).find("iframe:first");i.css("height","10000px");var s=t.prop("scrollHeight"),r=u-(s-1e4)-h+e,o=i.css("min-height").replace("px","");r<o&&(r=o);i.css("height",r+"px")}}},_initResize:function(t){"use strict";var r=this,i,u,f;t&&(n(top.window).bind("resize",function(){clearTimeout(i);i=setTimeout(r._stretchContainer,500)}),u=n(window).width(),f=n(window).height(),n(window).bind("resize",function(){var t=n(window).width(),e=n(window).height();(t!==u||e!==f)&&(clearTimeout(i),i=setTimeout(r._stretchContainer,10));u=t;f=e}),r._stretchContainer())},_initWidget:function(){"use strict";var i=this,r,u;if(this._vsWidget===undefined){if(r=n("#WorkArea"),r.attr("class",""),u={viewType:netronic.nResourcePlanningAppBase.ViewType.Resources,additionalDateStringInterpretedAsEmpty:netronic_D365BC.isCALVersion?"0001-01-01T00:00:00":"0001-01-01T00:00:00.0000000"},this._vsWidget=this._createWidgetInstance(r,u),this._initResize(this._options.AddIn_ForcedFillOfPageSpace),this._activitiesTableColumns=[{}],this._resourcesTableColumns=[{}],this._entitiesTableColumns=[{}],this._vsWidget.option("onDetermineColumnDefinitions",function(n){n.columns=n.tableType===netronic.nResourcePlanningAppBase.TableType.Entities?i._entitiesTableColumns:n.viewType===NETRONIC_D365BC.nVSWidget.ViewType.Activities?i._activitiesTableColumns:i._resourcesTableColumns;n.columns[0].textSource=i._options.AddIn_HamletTableText?"Name":"AddIn_TableText"}),this._vsWidget.option("onShowTooltip",function(n){var s,u,t,l,a,v,h,c;if(i._options.AddIn_HamletTooltips){if(s=n.objectType,u=n.object,u!=null&&u.NET_CustomPropertyBag!=null&&u.NET_CustomPropertyBag.ToolTipInfo!=null&&(t=u.NET_CustomPropertyBag.ToolTipInfo,l="",t!=null)){var y=t.preLine!=null?t.preLine:"<\/tr>",p=t.htmlTooltipLineTemplate!=null?t.htmlTooltipLineTemplate:"<td>#description#<\/td><td>#value#<\/td>",w=t.postLine!=null?t.postLine:"<\/tr>",b=t.postBlock!=null?t.postBlock:"<\/table>";if(s!=null&&s==netronic.nResourcePlanningAppBase.ObjectType.Resource){var r=l,f=t.isResourceGroup?"RG_":"R_",e=function(n,t,i){var u,r;return i===undefined&&(i=!0),u=!i||t>0||t!="",n!=null&&t!=null&&u?(r=y,r+=p.replace("#description#",n),r=r.replace("#value#",t),r+w):""},o=function(t,i,u){var o=t+i+a,f=n.singleLoads[o];f!=null&&f>0&&(r+=e(u,f))};r+=e(t.capacityCurveDescription!=null?t.capacityCurveDescription:"capacity",n.capacity,!1);r+=e(t.loadCurveDescription!=null?t.loadCurveDescription:"total load",n.load,!1);n.singleLoads&&(a=u.ID.substring(f.length),o("","ALC_",t.absenceCurveDescription!=null?t.absenceCurveDescription:"Absence"),o(f,"PC_AL_",t.ALCurveDescription!=null?t.ALCurveDescription:"Assembly Load"),o(f,"PC_JPL_",t.JPLCurveDescription!=null?t.JPLCurveDescription:"Job Load"),o(f,"PC_SOA_",t.SOACurveDescription!=null?t.SOACurveDescription:"Service Load: "));n.date!=null&&(v=n.date,r+=e(t.dateDescription!=null?t.dateDescription:"Date",v.toLocaleDateString(i._vsWidget.options.locale)));r+=b}h="";t.TooltipText!=null&&t.TooltipText!=""&&(h=r!=null?t.TooltipText+r:t.TooltipText);n.innerHTML=h}}else c=n.object,c&&!n.tooltipTemplateID&&(n.innerHTML=((n.periodHighlighter||n.calendarGrid)&&n.entry||c).AddIn_TooltipText)}),this._vsWidget.option("canDrag",function(n){var t={ObjectType:n.objectType,VisualType:n.visualType,AllowedDragModes:n.allowedDragModes};i._options.AddIn_FullObjectsInEvents?t.Object=n.object:t.ObjectID=n.object?n.object.ID:"";n.selectedObjects&&(t.SelectedObjectIDs=n.selectedObjects.map(function(n){return n.ID}));Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("CanDrag",[t])}),this._vsWidget.option("onDragStart",function(n){var t={ObjectType:n.objectType,VisualType:n.visualType,DragMode:n.dragMode};n.entryIndex!==null&&(t.EntryIndex=n.entryIndex);i._options.AddIn_FullObjectsInEvents?t.Object=n.object:t.ObjectID=n.object?n.object.ID:"";Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnDragStart",[t])}),this._vsWidget.option("onDragEnd",function(n){var t={ObjectType:n.objectType,VisualType:n.visualType,DragMode:n.dragMode};n.entryIndex!==null&&(t.EntryIndex=n.entryIndex);i._options.AddIn_FullObjectsInEvents?t.Object=n.object:t.ObjectID=n.object?n.object.ID:"";Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnDragEnd",[t])}),this._vsWidget.option("onDrop",function(t){var r={ObjectType:t.objectType,VisualType:t.visualType,DragMode:t.dragMode,NewRowObjectType:t.newRowObjectType,WorkingTimeDistance:t.workingTimeDistance||0},u;t.newStart&&(r.NewStart=t.newStart);t.newEnd&&(r.NewEnd=t.newEnd);t.newDate&&(r.NewDate=t.newDate);t.entryIndex!==null&&(r.EntryIndex=t.entryIndex);i._options.AddIn_FullObjectsInEvents?(r.Object=t.object,r.NewRowObject=t.newRowObject):(r.ObjectID=t.object?t.object.ID:"",r.NewRowObjectID=t.newRowObject?t.newRowObject.ID:"");t.startsAndEndsOfCoupledObjects&&(r.StartsAndEndsOfCoupledObjects=t.startsAndEndsOfCoupledObjects.map(function(n){var t={NewStart:n.newStart,NewEnd:n.newEnd};return i._options.AddIn_FullObjectsInEvents?t.Object=n.object:t.ObjectID=n.object.ID,t}));i._options.AddIn_OnDropWithCompletion&&(u=n.Deferred(),r.CompletionID=(i._nextCompletionID++).toString(),i._completionDeferreds[r.CompletionID]=u,t.promise=u.promise());Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnDrop",[r])}),this._vsWidget.option("onTableCellDefinitionWidthChanged",function(n){var t={TableType:n.tableType,TableRowDefinitionID:n.tableRowDefinition.ID,CellIndex:n.cellIndex,NewWidth:Math.floor(n.newWidth+.001),OldWidth:Math.floor(n.oldWidth+.001)};Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnTableCellDefinitionWidthChanged",[t])}),this._vsWidget.option("onClicked",function(n){var t={ObjectType:n.objectType,VisualType:n.visualType};n.date&&(t.Date=n.date);n.visualType===NETRONIC_D365BC.nVSWidget.VisualType.PeriodHighlighter&&(t.PeriodHighlighterID=n.calendarGrid.ID,t.PeriodHighlighterEntryIndex=n.entryIndex,window.Hamlet&&(t.CalendarGridID=t.PeriodHighlighterID,t.CalendarGridEntryIndex=t.PeriodHighlighterEntryIndex));n.entryIndex!=null&&(t.EntryIndex=n.entryIndex);i._options.AddIn_FullObjectsInEvents?t.Object=n.object:t.ObjectID=n.object?n.object.ID:"";Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnClicked",[t])}),this._vsWidget.option("onDoubleClicked",function(n){var t={ObjectType:n.objectType,VisualType:n.visualType};n.date&&(t.Date=n.date);n.visualType===NETRONIC_D365BC.nVSWidget.VisualType.PeriodHighlighter&&(t.PeriodHighlighterID=n.calendarGrid.ID,t.PeriodHighlighterEntryIndex=n.entryIndex,window.Hamlet&&(t.CalendarGridID=t.PeriodHighlighterID,t.CalendarGridEntryIndex=t.PeriodHighlighterEntryIndex));n.entryIndex!=null&&(t.EntryIndex=n.entryIndex);i._options.AddIn_FullObjectsInEvents?t.Object=n.object:t.ObjectID=n.object?n.object.ID:"";Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnDoubleClicked",[t])}),this._vsWidget.option("onSelectionChanged",function(n){if(!i._options.AddIn_DeselectionOfRowsOrBarsOnLinkContextMenu&&n.reason===nwaf_rab.SelectionChangedReason.ContextMenu&&n.reasonObjectType===nwaf_rab.ObjectType.Link&&n.previouslySelectedObjects&&n.previouslySelectedObjects.length&&n.previouslySelectedObjectsType!==nwaf_rab.ObjectType.Link)n.cancel=!0;else{var t={ObjectType:n.objectType,VisualType:n.visualType};i._options.AddIn_FullObjectsInEvents?t.Object=n.object:t.ObjectID=n.object?n.object.ID:"";t.SelectedObjectIDs=n.selectedObjects.map(function(n){return n.ID});Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnSelectionChanged",[t])}}),this._vsWidget.option("onCollapseStateChanged",function(t){var r={ObjectType:t.objectType,NewCollapseState:t.newCollapseState,Interactively:t.interactively,IsForAllocationRows:t.isForAllocationRows},u;i._options.AddIn_FullObjectsInEvents?r.Object=t.object:r.ObjectID=t.object?t.object.ID:"";i._options.AddIn_OnCollapseStateChangedWithCompletion&&(u=n.Deferred(),r.CompletionID=(i._nextCompletionID++).toString(),i._completionDeferreds[r.CompletionID]=u,t.promise=u.promise());Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnCollapseStateChanged",[r]);t.object.PM_CollapseState=t.newCollapseState?1:0}),this._vsWidget.option("onCurveCollapseStateChanged",function(t){var r={ObjectType:t.objectType,NewCollapseState:t.newCollapseState},u;i._options.AddIn_FullObjectsInEvents?r.Object=t.object:r.ObjectID=t.object?t.object.ID:"";t.resource&&(i._options.AddIn_FullObjectsInEvents?r.Resource=t.resource:r.ResourceID=t.resource.ID);i._options.AddIn_OnCurveCollapseStateChangedWithCompletion&&(u=n.Deferred(),r.CompletionID=(i._nextCompletionID++).toString(),i._completionDeferreds[r.CompletionID]=u,t.promise=u.promise());Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnCurveCollapseStateChanged",[r]);t.object.PM_CurveCollapseState=t.newCollapseState?1:0}),this._vsWidget.option("onContextMenuItemClicked",function(n){Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnContextMenuItemClicked",[n])}),window.Hamlet)this._vsWidget.element.on("keydown.nVSCAI keyup.nVSCAI",function(n){return i._handleKeyEvent(n)});return this._vsWidget.option("onTimeAreaViewParametersChanged",function(n){var t={ScrollOffset:Math.floor(n.scrollOffset+.001),Width:Math.floor(n.width+.001),Start:n.start,End:n.end,TimeResolutionUnit:n.timeResolutionUnit,TimeResolutionUnitCount:n.timeResolutionUnitCount};Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnTimeAreaViewParametersChanged",[t])}),this._vsWidget.option("onVerticalScrollOffsetChanged",function(n){var t={TableType:n.tableType,ScrollOffset:Math.floor(n.scrollOffset+.001),TopViewScrollOffset:Math.floor(n.topViewScrollOffset+.001)};i._options.AddIn_FullObjectsInEvents?(t.RowObjectAtTop=n.rowObjectAtTop,t.TopViewRowObjectAtTop=n.topViewRowObjectAtTop):(t.RowObjectIDAtTop=n.rowObjectAtTop?n.rowObjectAtTop.ID:"",t.TopViewRowObjectIDAtTop=n.topViewRowObjectAtTop?n.topViewRowObjectAtTop.ID:"");Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnVerticalScrollOffsetChanged",[t])}),this._vsWidget.option("compareObjects",function(n){var r=function(t){var u=!0,i,r;return(t.charAt(0)==="-"&&(u=!1,t=t.substring(1)),!t)?!0:(i=n.objectA[t],r=n.objectB[t],i===r)?!0:(n.isALowerThanB=u?i<r:i>r,!1)};switch(n.objectType){case t.Activity:if(Array.isArray(i._options.AddIn_ActivitySortCodeSources)&&!i._options.AddIn_ActivitySortCodeSources.every(r))return;break;case t.Allocation:if(Array.isArray(i._options.AddIn_AllocationSortCodeSources)&&!i._options.AddIn_AllocationSortCodeSources.every(r))return;break;case t.Entity:if(Array.isArray(i._options.AddIn_EntitySortCodeSources)&&!i._options.AddIn_EntitySortCodeSources.every(r))return;break;case t.Resource:if(Array.isArray(i._options.AddIn_ResourceSortCodeSources)&&!i._options.AddIn_ResourceSortCodeSources.every(r))return}r("AddIn_TableSortCode")&&r("ID")}),!0}return!1},_createWidgetInstance:function(n,t){"use strict";return n.nVSWidget(t).nVSWidget("instance")},_handlePingTimeInMilliseconds:function(){"use strict";this._pingIntervalID!==undefined&&(window.clearInterval(this._pingIntervalID),delete this._pingIntervalID);this._options.AddIn_PingTimeInMilliseconds>0&&(this._pingIntervalID=window.setInterval(function(){Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnPing",null)},this._options.AddIn_PingTimeInMilliseconds))},_sendKeyEventToD365:function(n,t){"use strict";Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("On"+t,[{AltKey:n.altKey,CtrlKey:n.ctrlKey,Key:n.key,Location:event.location,MetaKey:n.metaKey,Repeat:event.repeat,ShiftKey:n.shiftKey}]);n.preventDefault()},_handleKeyEvent:function(n){"use strict";function t(n,t){return!n&&typeof n!="boolean"||!!n===t}var u=this;if(!n.defaultPrevented){var f=n.originalEvent,i=n.type.substring(0,1).toUpperCase()+n.type.substring(1),r=this._options[["AddIn_",i,"List"].join("")];Array.isArray(r)&&!f.isComposing&&n.keyCode!==229&&r.every(function(f){switch(typeof f){case"string":if(r.indexOf(n.key)>=0)return u._sendKeyEventToD365(n,i),!1;break;case"object":if(f.Key===n.key){var s=f.AltKey,o=f.CtrlKey,e=f.MetaKey,h=f.ShiftKey;if((f.CmdKey||typeof f.CmdKey=="boolean")&&(e=netronic.nOSDetector.isMac?!!f.CmdKey:!f.CmdKey,o=!e),t(s,n.altKey)&&t(o,n.ctrlKey)&&t(e,n.metaKey)&&t(h,n.shiftKey))return u._sendKeyEventToD365(n,i),!1}}return!0})}},_setActivitiesDefaultValues:function(n){"use strict";var t=this;n.forEach(function(n){n.PM_AllowedBarDragModes===-1&&(n.PM_AllowedBarDragModes=undefined)})},_setAllocationsDefaultValues:function(n){"use strict";var t=this;n.forEach(function(n){n.PM_AllowedBarDragModes===-1&&(n.PM_AllowedBarDragModes=undefined)})},_II_fitTimeAreaIntoView:function(n,t){"use strict";if(this._vsWidget){var i=undefined,r=undefined;n&&(i=new Date(n));t&&(r=new Date(t));this._vsWidget.fitTimeAreaIntoView(i,r)}else alert("_II_fitTimeAreaIntoView failed")},_II_setTimeResolutionForView:function(n,t,i){"use strict";this._vsWidget?(i&&(i=new Date(i)),this._vsWidget.setTimeResolutionForView(n,t,i)):alert("_II_setTimeResolutionForView failed")},_II_removeAll:function(){"use strict";this._vsWidget?(this._vsWidget.removeAll(),this._vsWidget.option("defaultCalendarID",null)):alert("_II_removeAll failed")},_II_render:function(){"use strict";this._vsWidget?this._vsWidget.render():alert("_II_render failed")},_II_saveAsPDF:function(t,i){"use strict";var f=this,r,u;this._vsWidget?(r={},i&&Object.keys(i).forEach(function(n){r[n.charAt(0).toLowerCase()+n.substring(1)]=i[n]}),u=n("<div><\/div>").css({position:"absolute","z-index":100,cursor:"wait",width:"100%",height:"100%",background:"rgba(0, 0, 0, 0.1)"}).prependTo(n("body")),window.setTimeout(function(){var i=function(){u.remove();Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnSaveAsPDFFinished",[])},n;if(nwaf_apptools.nOSDetector.isIE)n="It is not possible to save a PDF neither within Internet Explorer\nnor the Windows client of Business Central!";else try{f._vsWidget.saveAsPDF(t,r).then(i,i)}catch(e){n=e.message}n&&(nwaf_apptools.nPopup.showMessageBox(document.getElementById("controlAddIn"),"Visual Scheduling Control Add-in",n,["OK"],0,-1,undefined,!0,undefined),i())},1)):alert("_II_saveAsPDF failed")},_II_scrollToDate:function(n){"use strict";n&&this._vsWidget?this._vsWidget.scrollToDate(new Date(n)):alert("_II_scrollToDate failed")},_II_scrollToObject:function(n,t,i,r){"use strict";t&&this._vsWidget?this._vsWidget.scrollToObject(n,t,i,r):alert("_II_scrollToObject failed")},_II_selectObjects:function(n,t,i){"use strict";t&&this._vsWidget?this._vsWidget.selectObjects(n,t,i):alert("_II_selectObjects failed")},_II_setSettings:function(n){"use strict";var t=this,i;n?(i=!1,(n.Start||n.End)&&(n.Start&&n.End&&(i=this._initWidget()),this._vsWidget&&(n.Start&&this._vsWidget.option("start",new Date(n.Start)),n.End&&this._vsWidget.option("end",new Date(n.End)))),this._vsWidget&&(Object.keys(n).forEach(function(i){var r=n[i];if(i.substring(0,6)==="AddIn_")t._options[i]=r,i==="AddIn_PingTimeInMilliseconds"?t._handlePingTimeInMilliseconds():i==="AddIn_ForcedFillOfPageSpace"?t._initResize(r):window.Hamlet&&(i==="AddIn_ProductName"?t._vsWidget.option("customName",r):i==="AddIn_ProductVersion"&&t._vsWidget.option("customVersion",r));else if(i.substring(0,7).toLowerCase()!=="custom_"){i=i.substring(0,3)==="PM_"?"pm_"+i.substring(3,4).toLowerCase()+i.substring(4):i.substring(0,1).toLowerCase()+i.substring(1);switch(i){case"workDate":if(r==="0001-01-01T00:00:00")return;r=new Date(r);break;case"viewType":case"tableWidth":case"tableViewWidth":case"entitiesTableWidth":case"entitiesTableViewWidth":case"pm_symbolColumnWidth":case"pm_entitiesTableSymbolColumnWidth":if(r<0)return;break;case"localeId":case"languageId":if(r=windowsLCIDToBCP47Map[r],r==null)return;r=r.replace(/_/g,"-");i=i.substring(0,i.length-2);break;case"timeZone":if(r==null)return;r=windowsTimeZoneToIANAMap[r]}t._vsWidget.option(i,r)}}),this._vsWidget.render(),i&&Microsoft.Dynamics.NAV.InvokeExtensibilityMethod("OnControlAddInReady",null))):alert("_II_setSettings failed")},_II_about:function(){"use strict";this._vsWidget?this._vsWidget.about():alert("_II_about failed")},_II_addActivities:function(n){"use strict";n&&this._vsWidget?(this._setActivitiesDefaultValues(n),this._vsWidget.addActivities(n)):alert("_II_addActivities failed")},_II_updateActivities:function(n){"use strict";n&&this._vsWidget?(this._setActivitiesDefaultValues(n),this._vsWidget.updateActivities(n)):alert("_II_updateActivities failed")},_II_removeActivities:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeActivities(n):alert("_II_removeActivities failed")},_II_addAllocations:function(n){"use strict";n&&this._vsWidget?(this._setAllocationsDefaultValues(n),this._vsWidget.addAllocations(n)):alert("_II_addAllocations failed")},_II_updateAllocations:function(n){"use strict";n&&this._vsWidget?(this._setAllocationsDefaultValues(n),this._vsWidget.updateAllocations(n)):alert("_II_updateAllocations failed")},_II_removeAllocations:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeAllocations(n):alert("_II_removeAllocations failed")},_II_addCalendars:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addCalendars(n):alert("_II_addCalendars failed")},_II_updateCalendars:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updateCalendars(n):alert("_II_updateCalendars failed")},_II_removeCalendars:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeCalendars(n):alert("_II_removeCalendars failed")},_II_addCurves:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addCurves(n):alert("_II_addCurves failed")},_II_updateCurves:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updateCurves(n):alert("_II_updateCurves failed")},_II_removeCurves:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeCurves(n):alert("_II_removeCurves failed")},_II_addResources:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addResources(n):alert("_II_addResources failed")},_II_updateResources:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updateResources(n):alert("_II_updateResources failed")},_II_removeResources:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeResources(n):alert("_II_removeResources failed")},_II_addLinks:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addLinks(n):alert("_II_addLinks failed")},_II_updateLinks:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updateLinks(n):alert("_II_updateLinks failed")},_II_removeLinks:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeLinks(n):alert("_II_removeLinks failed")},_II_addEntities:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addEntities(n):alert("_II_addEntities failed")},_II_updateEntities:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updateEntities(n):alert("_II_updateEntities failed")},_II_removeEntities:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeEntities(n):alert("_II_removeEntities failed")},_II_addSymbols:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addSymbols(n):alert("_II_addSymbols failed")},_II_updateSymbols:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updateSymbols(n):alert("_II_updateSymbols failed")},_II_removeSymbols:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeSymbols(n):alert("_II_removeSymbols failed")},_II_addContextMenus:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addContextMenus(n):alert("_II_addContextMenus failed")},_II_updateContextMenus:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updateContextMenus(n):alert("_II_updateContextMenus failed")},_II_removeContextMenus:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeContextMenus(n):alert("_II_removeContextMenus failed")},_II_addPeriodHighlighters:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addPeriodHighlighters(n):alert("_II_addPeriodHighlighters failed")},_II_updatePeriodHighlighters:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updatePeriodHighlighters(n):alert("_II_updatePeriodHighlighters failed")},_II_removePeriodHighlighters:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removePeriodHighlighters(n):alert("_II_removePeriodHighlighters failed")},_II_addDateLines:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addDateLines(n):alert("_II_addDateLines failed")},_II_updateDateLines:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updateDateLines(n):alert("_II_updateDateLines failed")},_II_removeDateLines:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeDateLines(n):alert("_II_removeDateLines failed")},_II_addTooltipTemplates:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addTooltipTemplates(n):alert("_II_addTooltipTemplates failed")},_II_updateTooltipTemplates:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updateTooltipTemplates(n):alert("_II_updateTooltipTemplates failed")},_II_removeTooltipTemplates:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeTooltipTemplates(n):alert("_II_removeTooltipTemplates failed")},_II_addTableRowDefinitions:function(n){"use strict";n&&this._vsWidget?this._vsWidget.addTableRowDefinitions(n):alert("_II_addTableRowDefinitions failed")},_II_updateTableRowDefinitions:function(n){"use strict";n&&this._vsWidget?this._vsWidget.updateTableRowDefinitions(n):alert("_II_updateTableRowDefinitions failed")},_II_removeTableRowDefinitions:function(n){"use strict";n&&this._vsWidget?this._vsWidget.removeTableRowDefinitions(n):alert("_II_removeTableRowDefinitions failed")},_II_eventProcessingDone:function(n){"use strict";if(this._vsWidget){if(n=parseInt(n),n>=0){var t=this._completionDeferreds[n];t&&(delete this._completionDeferreds[n],t.resolve())}}else alert("_II_eventProcessingDone failed")}};netronic.nClassFactory.extendClass(netronic_D365BC,"nVSControlAddIn",Class,i)})(jQuery);