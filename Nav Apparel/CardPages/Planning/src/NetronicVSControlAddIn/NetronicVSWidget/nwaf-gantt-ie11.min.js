/*! (c) Copyright 2013-2021 NETRONIC Software GmbH. All rights reserved. Version 6.0.5 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("nwaf_apptools"),require("jquery"),require("jquery-ui/ui/widget"),require("d3"),require("hammerjs")):"function"==typeof define&&define.amd?define(["nwaf_apptools","jquery","jquery-ui/ui/widget","d3","hammerjs"],t):"object"==typeof exports?exports.nwaf_gantt=t(require("nwaf_apptools"),require("jquery"),require("jquery-ui/ui/widget"),require("d3"),require("hammerjs")):e.nwaf_gantt=t(e.nwaf_apptools,e.jQuery,e.jQuery,e.d3,e.Hammer)}(self,(function(e,t,i,a,n){return function(){var r={3922:function(e,t,i){i(9600),i(2420),i(1539),i(9714),Math.sign=Math.sign||function(e){return 0===(e=+e)||isNaN(e)?e:e>0?1:-1};var a=i(3755),n=i(9748),r=n.NGANTT_BAR_RECT_CLASS,o="ngantt-arrow-bar-path",s=n.NGANTT_BAR_TEXT_CLASS,l=n.ElemType,c=n.BarType,d=function(){this._optionCache={}};a.extend(d.prototype,{createBar:function(e){e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+o,{elemType:l.BarRectangle,shape:e.barShapeId}));var t=e.dataItem.item,i=[t.startOffset,t.endOffset,t.isArrowLeft,t.isArrowRight,t.leftArrowDegree,t.rightArrowDegree,e.barHeight].join(",");if(!this._optionCache[i]){var a=+t.startOffset||0,n=+t.endOffset||0,s=null==t.isArrowLeft||!!t.isArrowLeft,c=null==t.isArrowRight||!!t.isArrowRight,d=null==t.leftArrowDegree?45:+t.leftArrowDegree||0,m=null==t.rightArrowDegree?45:+t.rightArrowDegree||0;(d<1||d>179)&&(d=45),d%90==0&&(s=!1),(m<1||m>179)&&(m=45),m%90==0&&(c=!1);var u=e.barHeight/2,h=s?Math.tan((90-d)*(Math.PI/180))*u:0,p=c?Math.tan((90-m)*(Math.PI/180))*u:0;this._optionCache[i]={startOffset:a,endOffset:n,isArrowLeft:s,isArrowRight:c,barHeightAsString:e.barHeight.toString(),halfBarHeight:u,halfBarHeightAsString:u.toString(),arrowLengthLeft:h,arrowLengthLeftAsString:h.toString(),negativeArrowLengthLeftAsString:(-h).toString(),arrowLengthRight:p,arrowLengthRightAsString:p.toString(),negativeArrowLengthRightAsString:(-p).toString(),absArrowLengthBoth:Math.abs(h)+Math.abs(p),maxArrowLengthLeft:Math.max(0,h),maxArrowLengthRight:Math.max(0,p)}}},positionBar:function(e){if(e.barD3){var t=e.dataItem.item,i=[t.startOffset,t.endOffset,t.isArrowLeft,t.isArrowRight,t.leftArrowDegree,t.rightArrowDegree,e.barHeight].join(","),a=this._optionCache[i],n=a.arrowLengthLeft,r=a.arrowLengthRight,o=a.arrowLengthLeftAsString,l=a.arrowLengthRightAsString,c=(a.negativeArrowLengthLeftAsString,a.negativeArrowLengthRightAsString),d=Math.max(0,e.width+a.startOffset+a.endOffset),m=Math.max(0,d-a.maxArrowLengthLeft-a.maxArrowLengthRight);d<a.absArrowLengthBoth&&(n=d*(n/a.absArrowLengthBoth),r=d*(r/a.absArrowLengthBoth),o=n.toString(),l=r.toString(),c=(-r).toString());var u=a.halfBarHeightAsString,h=m.toString(),p=(-m).toString();a.isArrowLeft?a.isArrowRight?e.barD3.select(".ngantt-arrow-bar-path").attr("d",["M",-Math.min(n,0)-a.startOffset,",",u,"l",o,",-",u,"h",h,"l",l,",",u,"l",c,",",u,"h",p,"Z"].join("")):e.barD3.select(".ngantt-arrow-bar-path").attr("d",["M",-Math.min(n,0)-a.startOffset,",",u,"l",o,",-",u,"h",h,"v",a.barHeightAsString,"h",p,"Z"].join("")):a.isArrowRight?e.barD3.select(".ngantt-arrow-bar-path").attr("d",["M",-a.startOffset,",0h",m,"l"+l,",",u,"l",c,",",u,"h",p,"Z"].join("")):e.barD3.select(".ngantt-arrow-bar-path").attr("d",["M",-a.startOffset,",0h",m,"v",a.barHeightAsString,"h",p,"Z"].join("")),e.barD3.select("."+s).attr("transform","translate("+(n>0?n-4:0)+")")}e.worldViewVisible&&(e.worldViewPathData=[{x:0,y:0},{x:e.worldViewBarWidth,y:0},{x:e.worldViewBarWidth,y:e.barHeight},{x:0,y:e.barHeight},{x:0,y:0}])},checkForBarType:function(e){return e===c.StartEnd||e===c.StartDuration||e===c.EndDuration},getBarOffsets:function(e){return{startOffset:+e.item.startOffset||0,endOffset:+e.item.endOffset||0}}}),e.exports=d},7913:function(e,t,i){var a=i(3755),n=i(9748),r=n.NGANTT_BAR_RECT_CLASS,o=n.NGANTT_BAR_TEXT_CLASS,s=n.BarType,l=n.DisplayedElements,c=n.ElemType,d=function(){};a.extend(d.prototype,{createBar:function(e){e.barD3.append("path").attr("class",e.enrichClassFunc(r+" ngantt-arrow-path",{elemType:c.BarRectangle,shape:e.barShapeId})).attr("transform","translate(0,"+e.barHeight/2+")").attr("d","M-8,0 L0,-10 L0,10 L-8,0")},positionBar:function(e){e.barD3&&(e.rowDataItem.isHidden||(e.rowDataItems.isLeaf?e.rowDataItem.areLeavesCollapsed&&e.ganttWidget._getCurrentlyDisplayedElementsInRow(e.rowDataItem)&l.BarsOfCollapsedLeafRows:e.rowDataItem.isCollapsed&&e.ganttWidget._getCurrentlyDisplayedElementsInRow(e.rowDataItem)&l.BarsOfCollapsedChildRows)?e.barD3.select("."+o).remove():e.barD3.select("."+o).attr("x",2))},checkForBarType:function(e){return e===s.Single||e===s.SingleRespectedByOptimization}}),e.exports=d},1150:function(e,t,i){var a=i(3755),n=i(9748),r=n.NGANTT_BAR_RECT_CLASS,o=n.NGANTT_BAR_TEXT_CLASS,s=n.BarType,l=n.DisplayedElements,c=n.ElemType,d=function(){};a.extend(d.prototype,{createBar:function(e){e.barD3.append("path").attr("class",e.enrichClassFunc(r+" ngantt-arrow-path",{elemType:c.BarRectangle,shape:e.barShapeId})).attr("transform","translate(0,"+e.barHeight/2+")").attr("d","M8,0 L0,-10 L0,10 L8,0")},positionBar:function(e){e.barD3&&(e.rowDataItem.isHidden||(e.rowDataItems.isLeaf?e.rowDataItem.areLeavesCollapsed&&e.ganttWidget._getCurrentlyDisplayedElementsInRow(e.rowDataItem)&l.BarsOfCollapsedLeafRows:e.rowDataItem.isCollapsed&&e.ganttWidget._getCurrentlyDisplayedElementsInRow(e.rowDataItem)&l.BarsOfCollapsedChildRows)?e.barD3.select("."+o).remove():(e.barD3.select("."+o).attr("x",10),e.barD3.selectAll(".ntexthelper-wrapping-line").attr("x",10)))},checkForBarType:function(e){return e===s.Single||e===s.SingleRespectedByOptimization}}),e.exports=d},797:function(e,t,i){i(2222),i(9554),i(2772),i(1249),i(5827),i(7042),i(5212),i(9653),i(7941),i(4747);var a=i(3755),n=i(5680),r=i(7930),o=r.nD3MigrationHelper.transform,s=r.nCursorHelper,l=r.nDateHelper,c=r.nEventDispatcher,d=r.nOSDetector,m=i(7857),u=i(9748),h=u.BarInteractions,p=u._BarInteractions,_=u.BarSnapTargets,f=u.TimeType,g=u.ElemType,T=u._BarTypeFlags,D=u.BarType,v=u.DisplayedElements,y=u.NGANTT_BAR_PHANTOM_CLASS,w=u.NGANTT_TIMEAREA_ROW_CONTENTS_CLASS,S=function(e,t){this._ganttWidget=e,this._options=a.extend({},t),this._isInitiated=!1};a.extend(S.prototype,{setOption:function(e,t){this._options[e]=t},isInitiated:function(){return this._isInitiated},isActive:function(){return this._isInitiated&&this._isActive},isDropped:function(){return this._isInitiated&&this._isDropped},isAutomaticRowExpansionEnabled:function(){return this._isInitiated&&(this._isAutomaticRowExpansionEnabled||this._interaction&p.DragHorOrVerOverride)},hasCoupledTimeItems:function(){return this._isInitiated&&!!this._coupledTimeDataItems},isDraggedTimeItem:function(e){return this._isInitiated&&e===this._timeDataItem},getPointerX:function(){return this._isInitiated&&this._pointerX},getPointerDateTime:function(){return this._isInitiated&&this._pointerDateTime},initiate:function(e,t,i){"use strict";var a=this;if(!a._isInitiated&&(a._createBarPhantom(e,t),a._isInitiated)){if(a._isActive=i,a._interaction&p.Compound)for(;t.parentTimeDataItem;)t=t.parentTimeDataItem;a.isAutomaticRowExpansionEnabled()&&a._options.checkForAutomaticRowExpansionFunc(e.center.x,e.center.y,t.rowDataItem.visibleRowDataItem),a.checkForAutoscrollOnBarDragging(e,t),a._pointerType=e.pointerType,a._options.setBarInteractionCursorFunc(a._options.interaction);var n={sender:t.item,elemType:g.Bar,interaction:a._interaction&~p.Compound,cancel:!1};if((a._options.dragStartFunc||a._options.dragEnterFunc)&&(a._options.dragStartFunc&&(a._options.dragStartFunc.call(a,n),Array.isArray(n.coupledItems)&&(a._coupledTimeDataItems=[],n.coupledItems.forEach((function(i){var n=a._options.getTimeDataItemFunc(i);n&&n!==t&&(n.elem&&n.item.start&&a._createBarPhantom(e,n,!0),a._coupledTimeDataItems.push(n))})),a._coupledTimeDataItems.length||delete a._coupledTimeDataItems),delete n.coupledItems),!n.cancel&&a._options.dragEnterFunc&&a._options.dragEnterFunc.call(a,n),n.cancel))return a.terminate(e,!0),!1;var r=null==t.item.snapTargetsForStart?a._options.defaultBarSnapTargetsForStart:t.item.snapTargetsForStart,o=null==t.item.snapTargetsForEnd?a._options.defaultBarSnapTargetsForEnd:t.item.snapTargetsForEnd;if(a._snapTargetsForStart=r,a._snapTargetsForEnd=o,r||o){if(a._options.dragEnterFunc&&Array.isArray(n.snapTargetStartDates)&&(a._snapTargetStartDates=n.snapTargetStartDates.slice()),a._options.dragEnterFunc&&Array.isArray(n.snapTargetEndDates)&&(a._snapTargetEndDates=n.snapTargetEndDates.slice()),a._snapTargetStartDates&&a._snapTargetStartDates.sort((function(e,t){return e-t})),a._snapTargetEndDates&&a._snapTargetEndDates.sort((function(e,t){return e-t})),a._createCachedRowDependentSnapTargets(t.rowDataItem.visibleRowDataItem),(r|o)&_.CalendarGrids){a._snapTargetStartWorkingTimeDates=[],a._snapTargetEndWorkingTimeDates=[];var s=t.rowDataItem.item.calendar,l=s?s.timeTypeChangeTimes():void 0;if(l){var c=s.determineTimeType(l[0])!==f.NonWorkingTime;l.forEach((function(e){c?a._snapTargetStartWorkingTimeDates.push(e):a._snapTargetEndWorkingTimeDates.push(e),c=!c}))}}if((r|o)&_.DateLines){var d={},m=a._options.dateLines;m&&(m.forEach((function(e){!1!==e.isSnapTarget&&e.date instanceof Date&&(d[e.date.getTime()]=!0)})),a._snapTargetDateLineDates=[],Object.keys(d).forEach((function(e){a._snapTargetDateLineDates.push(new Date(+e))})),a._snapTargetDateLineDates.sort((function(e,t){return e-t})))}if((r|o)&_.DateLineGrids){var u={},h=a._options.timeAxis.actualStart().getTime(),T=a._options.timeAxis.actualEnd().getTime(),D=a._options.dateLineGrids;D&&(D.forEach((function(e){!1!==e.isSnapTarget&&a._options.callFunctionForAllDatesInDateLineGridFunc(h,T,e.timeType,(function(e){u[e.getTime()]=!0}))})),a._snapTargetDateLineGridDates=[],Object.keys(u).forEach((function(e){a._snapTargetDateLineGridDates.push(new Date(+e))})),a._snapTargetDateLineGridDates.sort((function(e,t){return e-t})))}}}return a._isInitiated},_createCachedRowDependentSnapTargets:function(e){var t=this;if(!t._cachedSnapTargetsForRowDataItemIDs[e.id]){var i=t._cachedSnapTargetsForRowDataItemIDs[e.id]={};if(t._snapTargetsForStart||t._snapTargetsForEnd){var a={},n={};(t._snapTargetsForStart|t._snapTargetsForEnd)&(_.Start|_.End)&&e.item.timeItems&&t._options.determineTimeDataItemsFunc(e.item.timeItems,!0).forEach((function(e){e!==t._timeDataItem&&(!t._coupledTimeDataItems||t._coupledTimeDataItems.indexOf(e)<0)&&(!t._snapTargetStartDates&&(t._snapTargetsForStart|t._snapTargetsForEnd)&_.Start&&e.item.startIsSnapTarget&&e.item.start instanceof Date&&(a[1e3*Math.floor(e.item.start.getTime()/1e3)]=!0),!t._snapTargetEndDates&&(t._snapTargetsForStart|t._snapTargetsForEnd)&_.End&&e.item.endIsSnapTarget&&e.item.end instanceof Date&&(n[1e3*Math.ceil(e.item.end.getTime()/1e3)]=!0))})),i._snapRowDependentTargetStartDates=[],Object.keys(a).forEach((function(e){i._snapRowDependentTargetStartDates.push(new Date(+e))})),i._snapRowDependentTargetStartDates.length?i._snapRowDependentTargetStartDates.sort((function(e,t){return e-t})):delete i._snapRowDependentTargetStartDates,i._snapRowDependentTargetEndDates=[],Object.keys(n).forEach((function(e){i._snapRowDependentTargetEndDates.push(new Date(+e))})),i._snapRowDependentTargetEndDates.length?i._snapRowDependentTargetEndDates.sort((function(e,t){return e-t})):delete i._snapRowDependentTargetEndDates}["leafRowDataItems","childRowDataItems"].forEach((function(i,a){Array.isArray(e[i])&&t._options.getCurrentlyDisplayedElementsInRowFunc(e)&(a?v.BarsOfCollapsedChildRows:v.BarsOfCollapsedLeafRows)&&e[i].forEach((function(e){e&&t._createCachedRowDependentSnapTargets(e)}))}))}},_determineRowDependentSnapTargets:function(e){"use strict";var t=this,i=t._cachedSnapTargetsForRowDataItemIDs[e.id]||{},n=i;return function e(n){n.isLeaf||["leafRowDataItems","childRowDataItems"].forEach((function(r,o){Array.isArray(n[r])&&n[o?"isCollapsed":"areLeavesCollapsed"]&&t._options.getCurrentlyDisplayedElementsInRowFunc(n)&(o?v.BarsOfCollapsedChildRows:v.BarsOfCollapsedLeafRows)&&(i=a.extend({},i),n[r].forEach((function(a){if(a){var n=t._cachedSnapTargetsForRowDataItemIDs[a.id];i._snapRowDependentTargetStartDates=(i._snapRowDependentTargetStartDates||[]).concat(n._snapRowDependentTargetStartDates||[]),i._snapRowDependentTargetEndDates=(i._snapRowDependentTargetEndDates||[]).concat(n._snapRowDependentTargetEndDates||[]),o&&e(a)}})))}))}(e),i!==n&&(i._snapRowDependentTargetStartDates.sort((function(e,t){return e-t})),i._snapRowDependentTargetEndDates.sort((function(e,t){return e-t}))),i},terminate:function(e,t){"use strict";var i=this;i._isInitiated&&(i._options.setBarInteractionCursorFunc(h.None),i._options.onEventFunc&&e&&i._options.onEventFunc.call(i,{sender:null,eventType:"tooltip",event:e.srcEvent,hammerEvent:e}),i._options.stopAutoscrollFunc(),i._dropBarPhantoms(t||!i._dropAllowed))},checkForAutoscrollOnBarDragging:function(e,t){"use strict";var i=this,a=i._interaction&(h.DragHor|h.DragHorOrVer|h.DragLeftSide|h.DragRightSide|p.DragHorOrVerOverride),n=i._interaction&(h.DragVer|h.DragHorOrVer|p.DragHorOrVerOverride);i._options.checkForAutoscrollFunc(e,t,a,n)},_createBarPhantom:function(e,t,i){"use strict";var a,r=this,s=n.select(t.elem),l=r._options.pointToSVGRelativeFunc(t.elem,e.center.x,e.center.y);if(a=i?r._interaction:r._options.determineBarInteractionFunc(s,r._options.getActualBarInteractionsFunc(t),l,e,!0)){var c,_=r._options.determineSuperTimeDataItemFunc(t);if(a&p.Compound||_===t){if(c=r._options.determineLeafTimeDataItemsFunc(_),null==_.item.barShape&&(t=void 0,c.some((function(e){return!!(r._options.getActualBarInteractionsFunc(e)&(h.DragHor|h.DragVer|h.DragHorOrVer|p.DragHorOrVerOverride))&&(t=e,!0)})),!t))return;_!==t&&(_.item.childTimeItems.length>1&&(d.isFirefox&&!_.elem.childNodes.length?l.y+=o(n.select(_.elem).attr("transform")).translate[1]-o(s.attr("transform")).translate[1]:l=r._options.pointToSVGRelativeFunc(_.elem,e.center.x,e.center.y)),t=_,s=n.select(t.elem))}var f,D,v=t.item.calendar||t.rowDataItem.item.calendar||r._options.defaultCalendar,S=r._ganttWidget.pageXToDate(e.center.x),b=r._options.determineTimeRangeFunc(t);a===h.DragRightSide?(f=0,D=r._options.timeAxis.convertDateToX(b.end)-r._ganttWidget.pageXToTimeAxisX(e.center.x)):a===h.DragLeftSide?(f=0,D=r._ganttWidget.pageXToTimeAxisX(e.center.x)-r._options.timeAxis.convertDateToX(b.start)):(f=i?void 0:m.calculateWorkingTime(v,S,b.start),D=0);var I=n.select(r._options.getOrCreateSpecialRowElemFunc(t.rowDataItem.visibleRowDataItem,!0,0)).select("."+w),A={phantomType:g.Bar,isMaster:!i,timeDataItem:t,start:b.start,duration:m.calculateWorkingTime(v,b.end,b.start),end:b.end,rowDataItem:t.rowDataItem,workingTimeSpanFromStartToMouseX:f,distanceFromStartToMouseX:D,newY:t.newY,oldVerticalScrollOffset:r._options.getBodyViewScrollTopFunc(t.rowDataItem.item.atTheTop),dropAllowed:!0,version:1};i&&(A.isStartingBeforeMaster=r._timeDataItem.phantomDataItem.start>b.start,A.workingTimeSpanBetweenBars=A.isStartingBeforeMaster?m.calculateWorkingTime(v,b.end,r._timeDataItem.phantomDataItem.start):m.calculateWorkingTime(v,b.start,r._timeDataItem.phantomDataItem.end)),A.duration||b.start.getTime()===b.end.getTime()||(A.duration=b.end-b.start,A.isInNonworkingTime=!0),t.phantomDataItem=A,s.style("opacity",null!=t.item.opacity?t.item.opacity*u._DefaultBarOpacity:u._DefaultBarOpacity);var E=r._options.createBarFunc(I,A);E.attr("transform","translate("+r._ganttWidget.convertXToLimitedX(A.newX)+","+A.newY+")").style("opacity",t.item.opacity),A.backgroundElem&&n.select(A.backgroundElem).attr("transform",E.attr("transform"));var R=r._options.determineTimeDataItemExtentFunc(_,void 0,void 0,!0),x=t.rowDataItem.visibleRowDataItem.subRowDataItems[t.subRowIndex];A.frameD3=I.append("g").attr("transform","translate("+r._ganttWidget.convertXToLimitedX(R.left)+","+(r._ganttWidget.determineActualRowMargins().top+x.offsetY+R.top-x.minimumY)+")");var C=A.frameD3.append("rect").attr("class",y).attr("x",-r._options.phantomFrameDistance).attr("y",-r._options.phantomFrameDistance).attr("rx",r._options.phantomFrameRounding).attr("ry",r._options.phantomFrameRounding).attr("height",R.bottom-R.top+2*r._options.phantomFrameDistance);!function e(){C.transition("stroke-width").duration(r._options.phantomTransitionDuration).style("stroke-width",4-parseInt(C.style("stroke-width")))[n.timeFormat?"on":"each"]("end",e)}();var L=r._options.registerBindingsForTimeItemsFunc(_.item);a&p.Compound||_===t?c.forEach((function(e){e!==t&&(null!=_.item.barShape||r._options.getActualBarInteractionsFunc(e)&(h.DragHor|h.DragVer|h.DragHorOrVer|p.DragHorOrVerOverride)||L&&L.indexOf(e.item)>=0)&&r._doCreateSiblingBarPhantom(e,A,I,S,v)})):L&&L.forEach((function(e){e!==t.item&&r._doCreateSiblingBarPhantom(r._options.getTimeDataItemFunc(e),A,I,S,v)})),A.isInNonworkingTime&&(A.duration=A.siblings.reduce((function(e,t){return e+t.duration}),0)),A.siblings&&(A.siblings.sort((function(e,t){var i=e.start instanceof Date,a=t.start instanceof Date;return i||a?i?a?e.start.getTime()-t.start.getTime():-1:1:A.siblings.indexOf(e)-A.siblings.indexOf(t)})),A.siblings.forEach((function(e,t){var i=e.timeDataItem.item.start;if(i&&i instanceof Date)for(var a=t-1;a>=0;a--){var n=A.siblings[a];if(r._options.getActualBarTypeFunc(n.timeDataItem)&T.End){var o=n.timeDataItem.item.end;o&&o instanceof Date&&(o.getTime()===i.getTime()||i>o&&!A.isInNonworkingTime&&!m.calculateWorkingTime(v,i,o))&&(n.siblingSynchronizedOnEnd=e)}}}))),A.backgroundElem&&(E.remove(),I.append((function(){return E.node()}))),i||(r._options.onEventFunc&&r._options.onEventFunc.call(r,{sender:A.timeDataItem.item,eventType:"tooltip",event:e.srcEvent,hammerEvent:e,elem:A.elem,elemType:g.Bar,phantom:{start:A.start,end:A.end,newRowItem:A.rowDataItem.item,interaction:a}}),r._options.setBarInteractionCursorFunc(a),r._options.positionDragDateLinesFunc(A,R),r._isInitiated=!0,r._isAutomaticRowExpansionEnabled=a&h.DragVer&&!(a&h.DragHorOrVer),r._timeDataItem=t,r._elemType=g.Bar,r._interaction=a,r._offsetY=(R.bottom-R.top)/2-l.y,r._dropAllowed=!0,r._cachedSnapTargetsForRowDataItemIDs={})}},_doCreateSiblingBarPhantom:function(e,t,i,a,r){"use strict";var o=this;if(e.elem){var s=o._options.determineTimeRangeFunc(e),l=n.select(e.elem),c={phantomType:g.Bar,parentPhantomDataItem:t,timeDataItem:e,start:s.start,end:s.end,duration:m.calculateWorkingTime(t.isInNonworkingTime?void 0:r,s.end,s.start),timeDistanceFromParent:m.calculateWorkingTime(t.isInNonworkingTime?void 0:r,s.start,t.start),isInNonworkingTime:t.isInNonworkingTime,rowDataItem:e.rowDataItem,distanceFromStartToMouseX:0,newY:e.newY,oldVerticalScrollOffset:o._options.getBodyViewScrollTopFunc(e.rowDataItem.item.atTheTop),dropAllowed:!0,version:1};e.phantomDataItem=c,t.siblings||(t.siblings=[]),t.siblings.push(c),l.style("opacity",null!=t.timeDataItem.item.opacity?t.timeDataItem.item.opacity*u._DefaultBarOpacity:u._DefaultBarOpacity),o._options.createBarFunc(i,c).attr("transform","translate("+o._ganttWidget.convertXToLimitedX(c.newX)+","+c.newY+")").style("opacity",t.timeDataItem.item.opacity)}},handleDrag:function(e,t){"use strict";var i=this,a=i._timeDataItem;if(!t){if(i.isAutomaticRowExpansionEnabled()){var n=e||i._dragBarPhantomHammerEvent;n&&i._options.checkForAutomaticRowExpansionFunc(n.center.x,n.center.y,a.rowDataItem.visibleRowDataItem)}e&&i.checkForAutoscrollOnBarDragging(e)}if(e)i._dragBarPhantomHammerEvent=e;else if(!(e=i._dragBarPhantomHammerEvent))return;var r=a.phantomDataItem,o=!(i._interaction&h.DragHorOrVer);e.srcEvent.shiftKey&&i._options.getActualBarInteractionsFunc(a)&h.DragHorOrVer&&i._interaction&(h.DragHor|h.DragVer)?i._interaction|=p.DragHorOrVerOverride:!e.srcEvent.shiftKey&&i._interaction&p.DragHorOrVerOverride&&(i._interaction&=~p.DragHorOrVerOverride),o&&i._options.setBarInteractionCursorFunc(i._interaction),i._interaction&h.DragHorOrVer&&(Math.abs(e.deltaX)>5||Math.abs(e.deltaY)>5)&&(i._interaction&=p.DragHorOrVerOverride|p.Compound,Math.abs(e.deltaX)>Math.abs(e.deltaY)?i._interaction|=h.DragHor:(i._interaction|=h.DragVer,i._isAutomaticRowExpansionEnabled=!0),i._options.setBarInteractionCursorFunc(i._interaction)),i._options.setDragDateLinesTextVisibilityFunc(i._interaction===h.DragVer?"hidden":null);var s=!i._options.isBindingActiveFunc()&&r.siblings&&i._interaction&(h.DragHor|h.DragVer|p.DragHorOrVerOverride)?[]:void 0;i._dragBarPhantomWithSiblings(e,r,s),i._coupledTimeDataItems&&i._coupledTimeDataItems.forEach((function(t){t.phantomDataItem&&i._dragBarPhantomWithSiblings(e,t.phantomDataItem,s,!0)}))},_dragBarPhantomWithSiblings:function(e,t,i,a){var n=this,r=t.timeDataItem,o=n._doDragSingleBarPhantom(e,t,n._interaction,i,a,!1);if(n._isInitiated){for(var l=t.dropAllowed,d=r.item.calendar||r.rowDataItem&&r.rowDataItem.item.calendar||n._options.defaultCalendar,u=[r.item],_=[],f={};u.length>0;)u.forEach((function(e){var i;n._interaction&(h.DragHor|p.DragHorOrVerOverride|h.DragLeftSide)&&((i=n._options.getBindingPropertyInfosAndValueFunc(e,"start","date").propertyInfos)&&(r.item===e&&(i.value=t.start),i.itemInfos.forEach((function(e){var i=e.item[n._OBJECT_ID_PROPERTY]+e.itemPropertyName;f[i]||(f[i]=!0,_.indexOf(e.item)<0&&_.push(e.item),"start"===e.itemPropertyName&&e.item.end instanceof Date?e.item.end=m.addWorkingTime(d,t.start,n._options.getBindingPropertyInfosAndValueFunc(e.item,"duration","number").value):"end"===e.itemPropertyName&&e.item.start instanceof Date&&(e.item.start=m.addWorkingTime(d,t.start,-n._options.getBindingPropertyInfosAndValueFunc(e.item,"duration","number").value)))}))));n._interaction&(h.DragLeftSide|h.DragRightSide)&&((i=n._options.getBindingPropertyInfosAndValueFunc(e,"duration","number").propertyInfos)&&(r.item===e&&(i.value=t.duration),i.itemInfos.forEach((function(e){var t=e.item[n._OBJECT_ID_PROPERTY]+e.itemPropertyName;f[t]||(f[t]=!0,_.indexOf(e.item)<0&&_.push(e.item))}))));n._interaction&(h.DragHor|p.DragHorOrVerOverride|h.DragRightSide)&&((i=n._options.getBindingPropertyInfosAndValueFunc(e,"end","date").propertyInfos)&&(r.item===e&&(i.value=t.end),i.itemInfos.forEach((function(e){var i=e.item[n._ganttWidget._OBJECT_ID_PROPERTY]+e.itemPropertyName;f[i]||(f[i]=!0,_.indexOf(e.item)<0&&_.push(e.item),"start"===e.itemPropertyName&&e.item.end instanceof Date?e.item.end=m.addWorkingTime(d,t.end,n._options.getBindingPropertyInfosAndValueFunc(e.item,"duration","number").value):"end"===e.itemPropertyName&&e.item.start instanceof Date&&(e.item.start=m.addWorkingTime(d,t.end,-n._options.getBindingPropertyInfosAndValueFunc(e.item,"duration","number").value)))}))))})),u=_,_=[];var D=n._options.determineSuperTimeDataItemFunc(r),v=n._options.determineTimeDataItemExtentFunc(D,void 0,void 0,!0);v.start=t.start,v.end=t.end,!t.siblings||r.item.barShape&&!i||(t.siblings.forEach((function(o,s){if(n._doDragSingleBarPhantom(e,o,n._interaction,i,a,!0),i){var c=n._options.getActualBarTypeFunc(o.timeDataItem)&T.End;r.item.start.getTime()===o.timeDataItem.item.start.getTime()&&(t.start=new Date(o.start)),c&&r.item.end.getTime()===o.timeDataItem.item.end.getTime()&&(t.end=new Date(o.end));for(var d=s-1;d>=0;d--){var m=t.siblings[d];m.siblingSynchronizedOnEnd===o&&(m.end=new Date(o.start))}}l&&(l=o.dropAllowed)})),v.start=t.start,v.end=t.end,t.siblings.forEach((function(e){var t=e.start,i=e.end,a=n._options.handleOffsetsOnStartAndEndFunc(e.timeDataItem,t,i);a.outerStart&&(t=a.outerStart),a.outerEnd&&(i=a.outerEnd),v.start>t&&(v.start=t),v.end<i&&(v.end=i)})),i&&i.forEach((function(e){e()}))),v.left=n._options.timeAxis.convertDateToX(v.start),v.right=n._options.timeAxis.convertDateToX(v.end);var w=n._ganttWidget.determineActualRowMargins(),S=r.rowDataItem.visibleRowDataItem.subRowDataItems[r.subRowIndex];if(t.frameStart=new Date(v.start),t.frameEnd=new Date(v.end),t.frameD3.attr("transform","translate("+n._ganttWidget.convertXToLimitedX(v.left)+","+(w.top+S.offsetY+v.top-S.minimumY+o-r.newY)+")").select("."+y).attr("width",Math.max(n._ganttWidget.convertXToLimitedX(v.right)-n._ganttWidget.convertXToLimitedX(v.left),0)+2*n._options.phantomFrameDistance),!a){n._options.positionDragAreasAndDateLinesFunc(t,v,o,w,S),n._dropAllowed=l;var b=l?n._options.interactionCursor:"no-drop";s.setCursor(n._ganttWidget.element[0],b),n._options.onEventFunc&&n._options.onEventFunc.call(n,{sender:r.item,event:e.srcEvent,hammerEvent:e,eventType:"tooltip",elem:t.frameD3.node(),elemType:g.Bar,phantom:{start:new Date(t.start),end:new Date(t.end),newRowItem:t.rowDataItem.item,interaction:n._interaction&~p.Compound}})}}else e[c.CANCEL_PROPERTY]=!0},__checkSnapSourceDate:function(e,t,i,a,n,r){"use strict";var o=this;if(r&&"function"==typeof o._options.checkSnapSourceDateFunc){var s={sender:e.item,actualCalendar:e.item.calendar||e.rowDataItem.item.calendar||o._options.defaultCalendar,dates:t,sourceDate:i,sourceDateIsStart:a,resultSnapDistanceInMilliseconds:void 0};if(o._options.checkSnapSourceDateFunc(s),"number"==typeof s.resultSnapDistanceInMilliseconds)return void((null==n.snapDistance||Math.abs(n.snapDistance)>Math.abs(s.resultSnapDistanceInMilliseconds))&&(n.snapDistance=s.resultSnapDistanceInMilliseconds,n.targetDateIsStart=a))}var c=t.length?l.findDateWithinSortedArray(t,i,!1,void 0):-1;if(c>=0){var d=t[c],m=d.getTime()-i.getTime();Math.abs(n.snapDistance)>Math.abs(m)&&(n.snapDistance=m,n.targetDateIsStart=a),d<i&&null!=(d=t[c+1])&&(m=d.getTime()-i.getTime(),Math.abs(n.snapDistance)>Math.abs(m)&&(n.snapDistance=m,n.targetDateIsStart=a))}},_doDragSingleBarPhantom:function(e,t,i,a,r,s){"use strict";var c,d,u=this,v=t.timeDataItem,y=!1,w=r?null:u._ganttWidget.pageXToTimeAxisX(e.center.x)+t.distanceFromStartToMouseX,S=n.select(t.elem),b=!1,I=!1;if(i!==h.None){if(d=t.newY,!(u._interaction&h.DragHorOrVer)&&u._interaction&(h.DragVer|p.DragHorOrVerOverride)){d+=e.deltaY/u._options.visualZoomFactor+(u._options.getBodyViewScrollTopFunc(v.rowDataItem.item.atTheTop)-t.oldVerticalScrollOffset);var A=o(S.attr("transform")).translate[1];d!==A&&(y=!0),r||s?c=u._timeDataItem.phantomDataItem.rowDataItem!==u._timeDataItem.rowDataItem.visibleRowDataItem?u._timeDataItem.phantomDataItem.rowDataItem:v.rowDataItem:(c=u._options.findRowDataItemAtYFunc(e.center.y))===v.rowDataItem.visibleRowDataItem&&(c=v.rowDataItem)}c&&u._createCachedRowDependentSnapTargets(c.visibleRowDataItem);var E,R,x,C=t.isInNonworkingTime&&c===v.rowDataItem?null:v.item.calendar||(c||v.rowDataItem).item.calendar||u._options.defaultCalendar,L=u._ganttWidget.determineActualTimeResolutionInSeconds();if(r||(E=u._options.timeAxis.convertXToDate(w),(R=u._options.timeAxis.convertXToDate(w+1)).setSeconds(R.getSeconds()-1)),i===h.DragLeftSide)(x=C&&C.determineTimeType(E)!==f.WorkingTime?C.findStartOfNextTimeTypeChange(E):E)&&L>1&&t.start.getTime()!==x.getTime()&&(x=u._options.findRoundedTargetDateTimeFunc(C,t.start,x,!0)),x&&t.end.getTime()>x.getTime()&&(1===L&&x.getTime()===E.getTime()&&(x=l.determineBestDateBetween(x,R)),t.start.getTime()!==x.getTime()?(delete t.startIsNull,t.start=x,y=!0):w!==u._pointerX&&(y=!0));else if(i===h.DragRightSide)x=C&&C.determineTimeType(E)!==f.WorkingTime?C.findStartOfCurrentTimeTypeInterval(E):E,L>1&&t.end.getTime()!==x.getTime()&&(x=u._options.findRoundedTargetDateTimeFunc(C,t.end,x,!1)),x&&t.start.getTime()<x.getTime()&&(1===L&&x.getTime()===E.getTime()&&(x=l.determineBestDateBetween(x,R)),t.end.getTime()!==x.getTime()?(delete t.endIsNull,t.end=x,y=!0):w!==u._pointerX&&(y=!0));else if(u._timeDataItem.rowDataItem!==u._timeDataItem.phantomDataItem.rowDataItem||i&(h.DragHor|p.DragHorOrVerOverride)){if(s?t.timeDistanceFromParent?(x=m.addWorkingTime(C,t.parentPhantomDataItem.start,t.timeDistanceFromParent))&&(x=m.addWorkingTime(C,x,0)):x=new Date(t.parentPhantomDataItem.start):!(i&(h.DragHor|p.DragHorOrVerOverride))||Math.abs(e.deltaX)<=5?x=new Date(v.item.start):r&&(t.isStartingBeforeMaster?(x=m.addWorkingTime(C,u._timeDataItem.phantomDataItem.start,t.workingTimeSpanBetweenBars),I=!0):x=m.addWorkingTime(C,u._timeDataItem.phantomDataItem.end,t.workingTimeSpanBetweenBars)),!x){var B=m.addWorkingTime(C,E,-t.workingTimeSpanFromStartToMouseX),O=m.addWorkingTime(C,R,-t.workingTimeSpanFromStartToMouseX);if(x=B&&O?l.determineBestDateBetween(B,O):B||O,v.item.end&&C&&x&&!m.addWorkingTime(C,x,t.duration)){var M=m.addWorkingTime(C,new Date(864e13),-t.duration);M&&(x=M,B=null)}x||(B=O=x=m.addWorkingTime(C,new Date(-864e13),0)),C&&B&&O&&O.getTime()-B.getTime()>R.getTime()-E.getTime()&&(x=C.findStartOfCurrentTimeTypeInterval(O))}if(!s&&x&&L>1&&(I?t.end:t.start).getTime()!==x.getTime())if(I)x=new Date(x.valueOf()+1e3*L/2*(x<v.item.end?-1:1)),x=u._options.findRoundedTargetDateTimeFunc(C,v.item.end,x,!1);else x=new Date(x.valueOf()+1e3*L/2*(x<v.item.start?-1:1)),u._options.getActualBarTypeFunc(v)===D.EndDuration?(x=u._options.findRoundedTargetDateTimeFunc(C,v.item.end,m.addWorkingTime(C,x,t.duration),!1),x=m.addWorkingTime(C,x,-t.duration)):x=u._options.findRoundedTargetDateTimeFunc(C,v.item.start,x,!0);var V=t.start,k=t.end;if(I)x&&C&&C.determineTimeType(x)===f.WorkingTime&&(x=m.addWorkingTime(C,x,"-0")),x&&(delete t.endIsNull,t.end=x,delete t.startIsNull,t.start=m.addWorkingTime(C,x,-t.duration),t.start||(t.start=new Date(u._ganttWidget.timeAxis().actualStart()),t.startIsNull=!0));else if(x&&C&&C.determineTimeType(x)===f.NonWorkingTime&&(x=m.addWorkingTime(C,x,0)),x){var F=!(i&(h.DragHor|p.DragHorOrVerOverride));F&&!s&&(x=t.timeDataItem.item.start||x),delete t.startIsNull,t.start=x,delete t.endIsNull,t.end=(!F||s||m.calculateWorkingTime(C,t.timeDataItem.item.end,x)?void 0:t.timeDataItem.item.end)||(t.duration?m.addWorkingTime(C,x,t.duration):void 0)||t.start,t.end||(t.end=new Date(u._ganttWidget.timeAxis().actualEnd()),t.endIsNull=!0),y=!0}else u._interaction&h.DragLeftSide&&w!==u._pointerX&&(y=!0);!y&&(V.getTime()!==t.start.getTime()||t.end&&k.getTime()!==t.end.getTime())&&(y=!0)}else b=!0}else b=!0,d=t.newY;if(b){var N=u._options.getBindingPropertyInfosAndValueFunc(v.item,"start","date").value,W=u._options.getBindingPropertyInfosAndValueFunc(v.item,"duration","number").value,P=u._options.getBindingPropertyInfosAndValueFunc(v.item,"end","date").value;P instanceof Date?N instanceof Date||(N=m.addWorkingTime(C,P,-W)):P=m.addWorkingTime(C,N,W),t.start.getTime()===N.getTime()&&t.end.getTime()===N.getTime()||(delete t.startIsNull,t.start=N,delete t.endIsNull,t.end=P,y=!0)}if(!e.srcEvent.altKey&&!r&&!s&&y&&i&(h.DragHor|p.DragHorOrVerOverride)&&(u._snapTargetsForStart||u._snapTargetsForEnd)){var H={targetDateIsStart:void 0,snapDistance:Number.MAX_VALUE},X=u._determineRowDependentSnapTargets((c||v.rowDataItem).visibleRowDataItem),U=function(e){var i=e?u._snapTargetsForStart:u._snapTargetsForEnd,a=e?t.start:t.end;if(i&_.Start&&(X&&X._snapRowDependentTargetStartDates&&u.__checkSnapSourceDate(v,X._snapRowDependentTargetStartDates,a,e,H,!0),u._snapTargetStartDates&&u.__checkSnapSourceDate(v,u._snapTargetStartDates,a,e,H,!0),e&&v.start instanceof Date&&u.__checkSnapSourceDate(v,[v.start],a,e,H,!0)),i&_.End&&(X&&X._snapRowDependentTargetEndDates&&u.__checkSnapSourceDate(v,X._snapRowDependentTargetEndDates,a,e,H,!0),u._snapTargetEndDates&&u.__checkSnapSourceDate(v,u._snapTargetEndDates,a,e,H,!0)),i&_.CalendarGrids){var n=e?u._snapTargetStartWorkingTimeDates:u._snapTargetEndWorkingTimeDates;n&&u.__checkSnapSourceDate(v,n,a,e,H)}i&_.DateLines&&u._snapTargetDateLineDates&&u.__checkSnapSourceDate(v,u._snapTargetDateLineDates,a,e,H),i&_.DateLineGrids&&u._snapTargetDateLineGridDates&&u.__checkSnapSourceDate(v,u._snapTargetDateLineGridDates,a,e,H)};if(i!==h.DragRightSide&&U.call(this,!0),i!==h.DragLeftSide&&U.call(this,!1),null!=H.snapDistance&&(i!==h.DragRightSide?!t.startIsNull:!t.endIsNull)){var G=i!==h.DragRightSide?t.start:t.end,Y=new Date(G.getTime()+H.snapDistance),z=u._options.timeAxis.convertDateToX(Y),j=u._options.timeAxis.convertDateToX(G);if(Math.abs(z-j)<=u._options.maximumSnapDistance)if(i&(h.DragHor|p.DragHorOrVerOverride)&&u._options.getActualBarTypeFunc(v)&T.End){var Z=m.addWorkingTime(C,Y,t.duration);Z&&(t.start=Y,t.end=Z)}else i!==h.DragRightSide?t.start=Y:t.end=Y,e.center.x+=z+H.snapDistance}}if(y&&u._options.draggedFunc){(i=u._interaction&~p.Compound)&p.DragHorOrVerOverride&&(i=h.DragHor|h.DragVer);var K={sender:v.item,elemType:g.Bar,interaction:i,start:t.start,end:t.end,newY:d,newRowItem:(c||v.rowDataItem).item,actualCalendar:C,dropAllowed:!0,cancel:!1};if(r||s||u._options.draggedFunc.call(u,K),K.cancel)return void u.terminate(e,!0);t.start===K.start&&t.end===K.end||(t.start=K.start,t.end=K.end,null!=w&&(w=u._options.timeAxis.convertDateToX(m.addWorkingTime(null,K.start,t.timeSpanFromStartToMouseX)),e.center.x=u._ganttWidget.timeAxisXToPageX(w))),(c||v.rowDataItem).item!==K.newRowItem&&(c=u._options.getRowDataItem(K.newRowItem)),t.dropAllowed=K.dropAllowed}if(c&&c!==t.rowDataItem&&(t.rowDataItem=c,y=!0),y){s||r||(u._isActive=!0,u._pointerX=w,u._pointerDateTime=u._options.timeAxis.convertXToDate(w),u._dragDistanceInMilliseconds=m.calculateWorkingTime(C,t.start,t.timeDataItem.item.start));var q=function(){u._options.positionBarFullyFunc(S,void 0,t,!1,i,void 0,d)};a?a.push(q):q()}return d},_deleteBarPhantom:function(e){"use strict";var t=e.phantomDataItem;(t&&(delete e.oldX,delete e.oldEndX,delete e.oldY,delete e.oldRowY,delete e.oldRowAtTheTop,t.siblings&&t.siblings.forEach((function(e){var t=e.timeDataItem;delete t.oldX,delete t.oldEndX,delete t.oldY,delete t.oldRowY,delete t.oldRowAtTheTop})),t.siblings&&t.siblings.forEach((function(e){var t=e.timeDataItem;n.select(t.elem).style("opacity",t.item.opacity),delete e.oldVisibleRowDataItem,delete t.phantomDataItem})),this._options.removeSpecialRowElemFunc(t.oldVisibleRowDataItem,0),delete t.oldVisibleRowDataItem,delete e.phantomDataItem),e.elem)&&n.select(e.elem).style("opacity",e.item.opacity)},_dropBarPhantoms:function(e){"use strict";var t=this,i=t._timeDataItem;if(t._options.unregisterAllItemsFunc(),t._isInitiated){t._isDropped=!0;var a,n,r=i.phantomDataItem;if(t._options.setDragDateLinesTextVisibilityFunc("hidden"),!e&&t._options.droppedFunc&&t._isActive){t._setTimeDataItemPropsForAnimation(i),t._coupledTimeDataItems&&t._coupledTimeDataItems.forEach((function(e){e.phantomDataItem&&t._setTimeDataItemPropsForAnimation(e)}));var o=t._interaction&~p.Compound;o&p.DragHorOrVerOverride&&(o=h.DragHor|h.DragVer),r.rowDataItem===i.rowDataItem?o&=~h.DragVer:r.start.getTime()===i.item.start.getTime()&&(o&=~h.DragHor),n={sender:i.item,start:r.start,end:r.end,newRowItem:r.rowDataItem.item,elemType:g.Bar,interaction:o,workingTimeDistance:t._dragDistanceInMilliseconds,promise:void 0,cancel:!1},t._coupledTimeDataItems&&(n.startsAndEndsOfCoupledItems=t._coupledTimeDataItems.map((function(e){var t=e.phantomDataItem;return{item:e.item,start:t&&!t.startIsNull?t.start:null,end:t&&!t.endIsNull?t.end:null}}))),t._options.droppedFunc.call(t,n),a=n.promise,e=n.cancel}var l=function(e){t._deleteBarPhantom(i),t._coupledTimeDataItems&&t._coupledTimeDataItems.forEach((function(e){e.phantomDataItem&&t._deleteBarPhantom(e)})),s.setCursor(t._ganttWidget.element[0],null);var a=t._interaction&~p.Compound;if(a&p.DragHorOrVerOverride&&(a=h.DragHor|h.DragVer),t._reset(),t._options.resetFunc(),t._options.dragLeaveFunc||t._options.dragEndFunc){var n={sender:i.item,elemType:g.Bar,interaction:a,canceled:e};t._options.dragLeaveFunc&&t._options.dragLeaveFunc.call(t,n),t._options.dragEndFunc&&t._options.dragEndFunc.call(t,n)}};a?a.then((function(e){l.call(t,!!e)}),(function(){l.call(t,!0)})):l.call(t,e)}},_setTimeDataItemPropsForAnimation:function(e){var t=e.phantomDataItem;e.oldX=t.newX,e.oldEndX=t.newEndX,e.oldY=o(n.select(t.elem).attr("transform")).translate[1],e.oldRowY=t.oldVisibleRowDataItem.oldY,e.oldRowAtTheTop=!!t.oldVisibleRowDataItem.item.atTheTop,t.siblings&&t.siblings.forEach((function(i){var a=i.timeDataItem;a.oldX=i.newX,a.oldEndX=i.newEndX,a.oldY=o(n.select(i.elem).attr("transform")).translate[1],a.oldRowY=i.oldVisibleRowDataItem.oldY,e.oldRowAtTheTop=!!t.oldVisibleRowDataItem.item.atTheTop}))},_reset:function(){"use strict";var e=this;e._isInitiated=!1,delete e._isActive,delete e._isDropped,delete e._isAutomaticRowExpansionEnabled,delete e._timeDataItem,delete e._elemType,delete e._interaction,delete e._offsetY,delete e._dropAllowed,delete e._dragBarPhantomHammerEvent,delete e._pointerX,delete e._pointerDateTime,delete e._snapTargetsForStart,delete e._snapTargetsForEnd,delete e._snapTargetStartDates,delete e._snapTargetEndDates,delete e._cachedSnapTargetsForRowDataItemIDs,delete e._snapTargetStartWorkingTimeDates,delete e._snapTargetEndWorkingTimeDates,delete e._snapTargetDateLineDates,delete e._snapTargetDateLineGridDates,delete e._dragDistanceInMilliseconds,delete e._coupledTimeDataItems},modifyStartEndForCoupledTimeItems:function(e,t,i){"use strict";var a=this;a._isInitiated&&a._dragDistanceInMilliseconds&&(t&&(t=m.addWorkingTime(e,t,a._dragDistanceInMilliseconds)),i&&(i=m.addWorkingTime(e,i,a._dragDistanceInMilliseconds)))},isRowOfCoupledTimeItems:function(e){"use strict";var t=this;return t._isInitiated&&t._rowDataItemIDsOfCoupledTimeDataItemsMap&&t._rowDataItemIDsOfCoupledTimeDataItemsMap[e.id]}}),e.exports=S},2299:function(e,t,i){var a=function(){this._barShapes={}};i(3755).extend(a.prototype,{registerBarShape:function(e,t){var i=t.prototype;i.createBar&&i.positionBar&&(this._barShapes[e]=new t)},createBar:function(e){var t=this._barShapes[e.barShapeId];t&&t.createBar(e)},positionBar:function(e){var t=this._barShapes[e.barShapeId];t&&t.positionBar(e)},checkBarShapeForBarType:function(e,t){var i=this._barShapes[e];return!i||!i.checkForBarType||i.checkForBarType(t)},getBarOffsets:function(e){var t=this._barShapes[e.barShapeId];if(t&&t.getBarOffsets)return t.getBarOffsets(e)}}),e.exports=a},6640:function(e,t,i){var a=i(3755),n=i(7930),r=2200,o=i(9748).TimeType,s={Default:0,WorkingTime:1,NonWorkingTime:2},l=function(){},c=function t(i){"use strict";return this instanceof t==!1?new t(i):i instanceof e.exports?(this._defaultTimeType=i._defaultTimeType,this._start=i._start,this._end=i._end,this._timeTypeChangeTimes=new n.nSortedDatesWithValuesList(i._timeTypeChangeTimes),this._actualStart=i._actualStart,this._actualEnd=i._actualEnd,this._actualStartUTC=i._actualStartUTC,this._actualEndUTC=i._actualEndUTC,this._startOfValidTimeSegmentsUTC=i._startOfValidTimeSegmentsUTC,this._endOfValidTimeSegmentsUTC=i._endOfValidTimeSegmentsUTC,this._defaultValidationTimeSpan=i._defaultValidationTimeSpan,this._timeOutOfBoundsExceptionsEnabled=i._timeOutOfBoundsExceptionsEnabled,void(this._actualDefaultTimeType=i._actualDefaultTimeType)):(this._defaultTimeType=i||o.NonWorkingTime,this._start=null,this._end=null,this._timeTypeChangeTimes=null,this._yearCache={},this._monthCache={},this._dayCache={},this._actualStart=new Date(0),this._actualEnd=new Date(r,0,1),this._actualStartUTC=this._actualStart.getTime(),this._actualEndUTC=this._actualEnd.getTime(),this._startOfValidTimeSegmentsUTC=null,this._endOfValidTimeSegmentsUTC,this._defaultValidationTimeSpan=15552e6,this._timeOutOfBoundsExceptionsEnabled=!1,void(this._actualDefaultTimeType=this._defaultTimeType))};a.extend(c.prototype,{defaultTimeType:function(){"use strict";return 0===arguments.length?this._defaultTimeType:this},timeOutOfBoundsExceptionsEnabled:function(){"use strict";return 0===arguments.length?this._timeOutOfBoundsExceptionsEnabled:(this._timeOutOfBoundsExceptionsEnabled!==arguments[0]&&(this._timeOutOfBoundsExceptionsEnabled=arguments[0]),this)},allocateTimeSpan:function(e,t,i){"use strict";e&&t&&e<t&&(this._timeTypeChangeTimes||(this._timeTypeChangeTimes=new n.nSortedDatesWithValuesList(this._defaultTimeType),this._start||(this._actualStart=new Date(864e10)),this._end||(this._actualEnd=new Date(-864e10))),this._timeTypeChangeTimes.allocateTimeSpan(e,t,i),this._yearCache={},this._monthCache={},this._dayCache={},this._actualStart>e&&(this._actualStart=e,this._actualStartRTC=e.getTime()),this._actualEnd<t&&(this._actualEnd=t,this._actualEndRTC=t.getTime()))},timeTypeChangeTimes:function(){"use strict";return this._timeTypeChangeTimes||(this._timeTypeChangeTimes=new n.nSortedDatesWithValuesList(this._defaultTimeType)),this._timeTypeChangeTimes.dates()},timeTypeChangeTimesList:function(){"use strict";return this._timeTypeChangeTimes},start:function(){"use strict";if(0===arguments.length)return this._start;if((this._start instanceof Date?this._start.getTime():this._start)!==arguments[0]){var e=arguments[0];(!e||e instanceof Date)&&(this._start=e,e||(e=new Date(0)),this._actualStart=this._start,this._actualStartUTC=this._actualStart.getTime(),this._actualStartUTC>this._actualEndUTC&&(this._actualEnd=this._actualStart,this._actualEndUTC=this._actualStartUTC))}return this},end:function(){"use strict";if(0===arguments.length)return this._end;if((this._end instanceof Date?this._end.getTime():this._end)!==arguments[0]){var e=arguments[0];(!e||e instanceof Date)&&(this._end=e,e||(e=new Date(r,0,1)),this._actualEnd=this._end,this._actualEndUTC=this._end.getTime(),this._actualEndUTC<this._actualStartUTC&&(this._actualStart=this._actualEnd,this._actualStartUTC=this._actualEndUTC))}return this},actualStart:function(){"use strict";return this._actualStart},actualEnd:function(){"use strict";return this._actualEnd},_validateTimeRange:function(){},_getPreviousOrSameDateTime:function(e){"use strict";var t=this._timeTypeChangeTimes?this._timeTypeChangeTimes.determinePreviousOrSameDateWithValue(new Date(e)):void 0;return{UTC:t?t.date.getTime():null,TimeType:t?t.value:void 0}},_getPreviousDateTime:function(e){"use strict";var t=this._timeTypeChangeTimes?this._timeTypeChangeTimes.determinePreviousDateWithValue(new Date(e)):void 0;return{UTC:t?t.date.getTime():null,TimeType:t?t.value:void 0}},_getNextDateTime:function(e){"use strict";if(e>=this._actualEndUTC)return{UTC:null};var t=this._timeTypeChangeTimes?this._timeTypeChangeTimes.determineNextDateWithValue(new Date(e+1)):void 0;return{UTC:t?t.date.getTime():null,TimeType:t?t.value:void 0}},_checkDateTimeBounds:function(e,t){"use strict";if(this._timeOutOfBoundsExceptionsEnabled){if(e.getTime()<this._actualStartUTC)throw new RangeError(t,t+" < actualStart");if(e.getTime()>this._actualEndUTC)throw new RangeError(t,t+" > actualEnd")}},_setActualDefaultTimeType:function(e){"use strict";this._actualDefaultTimeType!==e&&(this._actualDefaultTimeType=e)},_internalActualDefaultTimeType:function(){"use strict";return this._defaultTimeType},addWorkingTime:function(e,t){"use strict";this._checkDateTimeBounds(e,"reference");var i=function(e){return 1/e==-1/0||"-0"===e},a=i(t),n=e.getTime(),r=this._actualDefaultTimeType;t>0?this._validateTimeRange(n-this._defaultValidationTimeSpan,n+this._defaultValidationTimeSpan):this._validateTimeRange(n-this._defaultValidationTimeSpan,n);for(var c=this._getPreviousOrSameDateTime(n),d=c.UTC,m=c.TimeType;(null===d||d<this._startOfValidTimeSegmentsUTC)&&this._startOfValidTimeSegmentsUTC>this._actualStartUTC;)this._validateTimeRange(this._startOfValidTimeSegmentsUTC-this._defaultValidationTimeSpan,this._startOfValidTimeSegmentsUTC),d=(c=this._getPreviousOrSameDateTime(n)).UTC,m=c.TimeType;if(null===d&&r===o.WorkingTime)n+=t;else if(t>=0&&!a){if(!this._timeOutOfBoundsExceptionsEnabled)if(n<this._actualStartUTC)r===o.NonWorkingTime?n=this._actualStartUTC:this._actualStartUTC-n<=t?(n+=t,t=0):(n=this._actualStartUTC,t-=this._actualStartUTC-n);else if(n>=this._actualEndUTC){if(r===o.NonWorkingTime)throw new l;n+=t,t=0}for(var u=!0;u||t>0;){u=!1;var h=this._getNextDateTime(n),p=h.UTC,_=h.TimeType;if((null===p||p>this._endOfValidTimeSegmentsUTC)&&this._endOfValidTimeSegmentsUTC<this._actualEndUTC)this._validateTimeRange(this._endOfValidTimeSegmentsUTC,this._endOfValidTimeSegmentsUTC+this._defaultValidationTimeSpan);else if(null===p){if(m!==s.WorkingTime&&(m!==s.Default||r!==o.WorkingTime))throw new l;n+=t,t=0}else{if(m===s.WorkingTime||m===s.Default&&r===o.WorkingTime)t<=(D=p-n)?(n+=t,t=0):(n=p,t-=D);else n=p;m=_}}}else{var f=a?0:t;if(!this._timeOutOfBoundsExceptionsEnabled)if(n<this._actualStartUTC){if(r===o.NonWorkingTime)throw new l;n+=f,t=0}else n>this._actualEndUTC&&(r===o.NonWorkingTime?n=this._actualEndUTC:n-this._actualEndUTC<=-f?(n+=f,t=0):n=this._actualEndUTC);for(;t<0||i(t);){f=i(t)?0:t;var g=this._getPreviousDateTime(n),T=g.UTC;if(m=g.TimeType,(null===T||T<this._startOfValidTimeSegmentsUTC)&&this._startOfValidTimeSegmentsUTC>this._actualStartUTC)this._validateTimeRange(this._startOfValidTimeSegmentsUTC-this._defaultValidationTimeSpan,this._startOfValidTimeSegmentsUTC);else if(null===T){if(!(a||m===s.WorkingTime||m===s.Default&&r===o.WorkingTime))throw new l;n=a?e.getTime():n+f,t=0}else{var D;if(m===s.WorkingTime||m===s.Default&&r===o.WorkingTime)f>=(D=T-n)?(n+=f,t=0):(n=T,i(t)&&(t=0),t-=D);else n=T}}}return new Date(n)},hasWorkingTime:function(e,t){return!!this._doCalculateWorkingTime(e,t,!0)},calculateWorkingTime:function(e,t){return this._doCalculateWorkingTime(e,t,!1)},_doCalculateWorkingTime:function(e,t,i){"use strict";this._checkDateTimeBounds(e,"end"),this._checkDateTimeBounds(t,"start");var a=t.getTime(),n=e.getTime();this._validateTimeRange(a,n);var r=this._actualDefaultTimeType,l=n<a;if(l){var c=a;a=n,n=c}var d=0,m=!1;if(this._timeOutOfBoundsExceptionsEnabled||(a<this._actualStartUTC&&(n<this._actualStartUTC?(r===o.WorkingTime&&(d=n-a),m=!0):(r===o.WorkingTime&&(d=this._actualStartUTC-a),a=this._actualStartUTC)),n>this._actualEndUTC&&(a>this._actualEndUTC?(r===o.WorkingTime&&(d=n-a),m=!0):(r===o.WorkingTime&&(d+=n-this._actualEndUTC),n=this._actualEndUTC))),!m){for(var u=this._getPreviousOrSameDateTime(a),h=u.UTC,p=u.TimeType;(null===h||h<this._startOfValidTimeSegmentsUTC)&&this._startOfValidTimeSegmentsUTC>this._actualStartUTC;)this._validateTimeRange(this._startOfValidTimeSegmentsUTC-this._defaultValidationTimeSpan,this._startOfValidTimeSegmentsUTC),h=(u=this._getPreviousOrSameDateTime(a)).UTC,p=u.TimeType;if(null===h&&r===o.WorkingTime)return l?a-n:n-a;p===s.Default&&(p=r);var _=a;do{var f=this._getNextDateTime(_),g=f.UTC,T=f.TimeType;if((null===g||g>this._endOfValidTimeSegmentsUTC)&&this._endOfValidTimeSegmentsUTC<this._actualEndUTC)this._validateTimeRange(this._endOfValidTimeSegmentsUTC,this._endOfValidTimeSegmentsUTC+this._defaultValidationTimeSpan);else{if(null===g||g>n)p===s.WorkingTime&&(d+=n-_),g=null;else if(p===s.WorkingTime){d+=g-_,T===s.Default&&(T=r)}_=g,p=T}}while(!(null===_||i&&d))}return l?-d:d},determineTimeType:function(e){"use strict";this._checkDateTimeBounds(e,"reference");var t=e.getTime();if(!this._timeOutOfBoundsExceptionsEnabled&&(t<this._actualStartUTC||t>=this._actualEndUTC))return this._actualDefaultTimeType;this._validateTimeRange(t-1,t+1);var i=this._getPreviousOrSameDateTime(t);return null===i.UTC||i.timeType===s.Default?this._actualDefaultTimeType:i.TimeType},findStartOfNextTimeTypeChange:function(e){"use strict";this._checkDateTimeBounds(e,"reference");var t=e.getTime();if(!this._timeOutOfBoundsExceptionsEnabled){if(t>this._actualEndUTC)return null;t<this._actualStartUTC&&(t=this._actualStartUTC)}this._validateTimeRange(t,t+this._defaultValidationTimeSpan);for(var i,a=this._actualDefaultTimeType,n=this._getPreviousOrSameDateTime(t),r=n.UTC,o=n.TimeType;(null===r||r<this._startOfValidTimeSegmentsUTC)&&this._startOfValidTimeSegmentsUTC>this._actualStartUTC;)this._validateTimeRange(this._startOfValidTimeSegmentsUTC-this._defaultValidationTimeSpan,this._startOfValidTimeSegmentsUTC),r=(n=this._getPreviousOrSameDateTime(t)).UTC,o=n.TimeType;o===s.Default&&(o=a);do{r=(n=this._getNextDateTime(t)).UTC,i=n.TimeType,(null===r||r>this._endOfValidTimeSegmentsUTC)&&this._endOfValidTimeSegmentsUTC<this._actualEndUTC?(this._validateTimeRange(this._endOfValidTimeSegmentsUTC,this._endOfValidTimeSegmentsUTC+this._defaultValidationTimeSpan),i=o):null!==r&&(i===s.Default&&(i=a),t=r)}while(i===o&&null!==r);return null===r?null:new Date(r)},findStartOfPreviousTimeTypeChange:function(e){"use strict";this._checkDateTimeBounds(e,"reference");var t=e.getTime();if(!this._timeOutOfBoundsExceptionsEnabled){if(t<=this._actualStartUTC)return null;t>this._actualEndUTC&&(t=this._actualEndUTC)}this._validateTimeRange(t-this._defaultValidationTimeSpan,t);for(var i=this._actualDefaultTimeType,a=this._getPreviousOrSameDateTime(t),n=a.UTC,r=a.TimeType;(null===n||n<this._startOfValidTimeSegmentsUTC)&&this._startOfValidTimeSegmentsUTC>this._actualStartUTC;)this._validateTimeRange(this._startOfValidTimeSegmentsUTC-this._defaultValidationTimeSpan,this._startOfValidTimeSegmentsUTC),n=(a=this._getPreviousOrSameDateTime(t)).UTC,r=a.TimeType;if(r===s.Default&&(r=i),null!==n){var o;t=n;do{n=(a=this._getPreviousDateTime(t)).UTC,o=a.TimeType,(null===n||n>this._endOfValidTimeSegmentsUTC)&&this._endOfValidTimeSegmentsUTC<this._actualEndUTC?(this._validateTimeRange(this._endOfValidTimeSegmentsUTC,this._endOfValidTimeSegmentsUTC+this._defaultValidationTimeSpan),o=r):null!==n&&(o===s.Default&&(o=i),t=n)}while(o===r)}return null===t?null:new Date(t)},findStartOfCurrentTimeTypeInterval:function(e){"use strict";this._checkDateTimeBounds(e,"reference");var t=e.getTime(),i=!1;if(!this._timeOutOfBoundsExceptionsEnabled){if(t<this._actualStartUTC)return null;t>this._actualEndUTC&&(t=this._actualEndUTC,i=!0)}this._validateTimeRange(t-this._defaultValidationTimeSpan,t);var a=this._actualDefaultTimeType;t++;var n,r,o,l=i?a:s.Default;do{r=(n=this._getPreviousDateTime(t)).UTC,o=n.TimeType,(null===r||r<this._startOfValidTimeSegmentsUTC)&&this._startOfValidTimeSegmentsUTC>this._actualStartUTC?(this._validateTimeRange(this._startOfValidTimeSegmentsUTC-this._defaultValidationTimeSpan,this._startOfValidTimeSegmentsUTC),o=s.Default):null===r?l=o===s.WorkingTime?s.NonWorkingTime:s.WorkingTime:(o===s.Default&&(o=a),l===s.Default&&(l=o),o===l&&(t=r))}while(l===s.Default||o===l);return null===t?null:new Date(t)}}),c.TimeType=o,c.InternalTimeType=s,c.OutOfWorkingTimeException=l,e.exports=c},7857:function(e,t,i){var a=i(9748),n=i(6640),r=a.TimeType,o={findNearestWorkingTime:function(e,t,i){var a=new Date(t.getTime());if(null!=e)if(a.getTime()>e.actualEnd().getTime())a.setTime(e.actualEnd().getTime());else if(a.getTime()<e.actualStart().getTime()&&a.setTime(e.actualStart().getTime()),e.determineTimeType(a)===r.NonWorkingTime)if(i){var n=e.findStartOfNextTimeTypeChange(a);null!==n&&(a=n)}else{var o=e.findStartOfCurrentTimeTypeInterval(a);null!==o&&(a=o)}return a},hasWorkingTime:function(e,t,i){return t>i&&(null==e||e.hasWorkingTime(t,i))},calculateWorkingTime:function(e,t,i){if(null!=e){var a=e.timeOutOfBoundsExceptionsEnabled();e.timeOutOfBoundsExceptionsEnabled(!1);var n=null;try{n=e.calculateWorkingTime(t,i)}catch(e){}return e.timeOutOfBoundsExceptionsEnabled(a),n}return t.getTime()-i.getTime()},addWorkingTime:function(e,t,i){if(null!=e){var a=e.timeOutOfBoundsExceptionsEnabled();e.timeOutOfBoundsExceptionsEnabled(!1);var n=null;try{n=e.addWorkingTime(t,i)}catch(e){}return e.timeOutOfBoundsExceptionsEnabled(a),n}return new Date(t.getTime()+("-0"===i?0:i))},createWeekendCalendar:function(e,t,i,a){var o=new n(r.WorkingTime);if(o.start(e),o.end(t),(i%=7)===(a=(a+1)%7))return null;var s,l,c=i<a?a-i:a+7-i,d=7-c,m=(a<i||e.getDay()>i)&&e.getDay()<(a>0?a:7)?-1:1;for(s=e;s.getDay()!=i;)s=new Date(s.getFullYear(),s.getMonth(),s.getDate()+m);for(l=new Date(s.getFullYear(),s.getMonth(),s.getDate()+c),s.getTime()<e.getTime()&&(s=e);s.getTime()<t.getTime();)o.allocateTimeSpan(s,l,r.NonWorkingTime),s=new Date(l.getFullYear(),l.getMonth(),l.getDate()+d),(l=new Date(s.getFullYear(),s.getMonth(),s.getDate()+c)).getTime()>t.getTime()&&(l=t);return o}};e.exports=o},9748:function(e){var t={Start:1,End:2,Duration:4,Summary:8,RespectedByOptimization:16},i={TimeType:{WorkingTime:1,NonWorkingTime:2},PortDirections:{Up:1,Down:2,Left:3,Right:4},RoutingType:{Curved:1,Orthogonal:2},TimeUnit:{Seconds:0,Minutes:1,Hours:2,Days:3},NGANTT_BAR_CLASS:"ngantt-bar",NGANTT_BAR_LAYER_CLASS:"ngantt-bar-layer",NGANTT_BAR_OUTLINE_CLASS:"ngantt-outline",NGANTT_BAR_PATH_CAL_CLASS:"ngantt-pcal",NGANTT_BAR_RECT_CLASS:"ngantt-bar-rect",NGANTT_BAR_RECT_CAL_CLASS:"ngantt-rcal",NGANTT_BAR_TEXT_CLASS:"ngantt-bar-text",NGANTT_BAR_WIDTH_DEPENDENT_PROP_CLASS:"ngantt-bar-width-dep",NGANTT_CONSTRAINT_SYMBOL_CLASS:"ngantt-constraint-symbol",NGANTT_CONSTRAINT_LINE_CLASS:"ngantt-constraint-line",NGANTT_COMPOUND_BAR_BACKGROUND_CLASS:"ngantt-compound-bar-background",NGANTT_COMPOUND_BAR_FOREGROUND_CLASS:"ngantt-compound-bar-foreground",NGANTT_BAR_PHANTOM_CLASS:"ngantt-bar-phantom",NGANTT_BAR_PHANTOM_NONWORK_CLASS:"ngantt-bar-phantom-nonwork",NGANTT_DATE_LINE_TEXT_CLASS:"ngantt-date-line-text",NGANTT_DRAG_DATE_LINE_TEXT_RECT_CLASS:"ngantt-drag-date-line-text-rect",NGANTT_TIMEAREA_ROW_CONTENTS_CLASS:"ngantt-timearea-row-contents",DateLineGridRecurrence:{Hourly:"h",Daily:"d",Weekly:"w",Monthly:"M",Quarterly:"Q",Yearly:"Y"},ElemType:{Row:1,GroupCell:2,TableCell:3,Link:4,Bar:5,BarRectangle:6,TableCellText:7,TableRow:8,LinkPath:9,LinkTargetMarker:10,DateLine:11,ConstraintDateSymbol:12,ConstraintDateLine:13,DateArea:14,LinkDanglingSourceBar:15,LinkDanglingTargetBar:16,LeavesIndicator:17},ConstraintType:{None:0,StartNoEarlierThan:1,EndNoEarlierThan:2,StartNoLaterThan:3,EndNoLaterThan:4,MustStartOn:5,MustEndOn:6},DisplayedElements:{Bars:1,Optimized:2,BarsOfCollapsedChildRows:4,CalendarGrid:8,BarsOfCollapsedLeafRows:16},_BarTypeFlags:t,BarType:{None:0,Single:t.Start,SingleRespectedByOptimization:t.Start|t.RespectedByOptimization,StartEnd:t.Start|t.End,StartDuration:t.Start|t.Duration,EndDuration:t.End|t.Duration,Summary:t.Summary|t.Start|t.End},BarShape:{None:"",Custom:"nCustomBarShape",Rectangle:"nRectangleBarShape",RectangleWithLeftTopBevel:"nRectangleWithLeftTopBevelBarShape",UpwardRamp:"nUpwardRamp",DownwardRamp:"nDownwardRamp",Summary:"nSummaryBarShape",Arrow:"nArrowBarShape",Diamond:"nDiamond",ArrowLeft:"nArrowLeftShape",ArrowRight:"nArrowRightShape"},BarInteractions:{None:0,DragLeftSide:1,DragRightSide:2,DragHor:4,DragVer:8,DragHorOrVer:16},_AllBarInteractions:31,_BarInteractions:{Compound:1024,DragHorOrVerOverride:2048},BarSnapTargets:{None:0,Start:1,End:2,DateLines:4,CalendarGrids:8,DateLineGrids:16},LinkType:{EndStart:0,EndEnd:1,StartStart:2,StartEnd:3},LinkMarker:{None:0,FilledArrow:1},TimeAxisZoom:{Stretch:0,Shrink:1},DateLineLabelOrientation:{Horizontal:1,Vertical:2},TableRowDefinitionType:{BaseLevel:1,GroupingLevel:2,FixedColumnsPreceding:4,FixedColumnsSucceeding:8,FromCallback:16,Map:32,LeafDefault:64},HorizontalAlignment:{Left:0,Center:1,Right:2},TableCellType:{Text:1,Number:2,Date:3,ImageList:4},ProgressBarWidthCalculationMode:{ConsiderWorkingTimesOnly:0,ConsiderWorkingAndNonWorkingTimes:1},PanningMode:{None:0,HorizontallyOnly:1,VerticallyOnly:2,HorAndVer:3,AutoHorOrVer:4},DateLineLabelPosition:{Left:1,Center:2,Right:4,TopLeft:9,TopCenter:10,TopRight:12},_DefaultBarOpacity:.3};e.exports=i},3462:function(e,t,i){var a=i(3755),n=i(9748),r=n.NGANTT_BAR_RECT_CLASS,o=n.NGANTT_BAR_TEXT_CLASS,s=n.NGANTT_COMPOUND_BAR_BACKGROUND_CLASS,l=n.BarType,c=n.DisplayedElements,d=n.ElemType,m=i(5645),u=function(){};a.extend(u.prototype,{createBar:function(e){var t=e.barD3.classed(s);t||m.createPredictedEndBar(e),e.barD3.append("path").attr("class",e.enrichClassFunc(r+" ngantt-diamond-path",{elemType:d.BarRectangle,shape:e.barShapeId})).attr("transform","translate(0,"+e.barHeight/2+")").attr("d","M-6,0 L0,-10 L6,0 L0,10 L-6,0"),t||m.createConstraintSymbols(e)},positionBar:function(e){e.barD3&&(e.rowDataItem.isHidden||(e.rowDataItem.isLeaf?e.rowDataItem.areLeavesCollapsed&&e.ganttWidget._getCurrentlyDisplayedElementsInRow(e.rowDataItem)&c.BarsOfCollapsedLeafRows:e.rowDataItem.isCollapsed&&e.ganttWidget._getCurrentlyDisplayedElementsInRow(e.rowDataItem)&c.BarsOfCollapsedChildRows)?e.barD3.select("."+o).remove():(e.barD3.select("."+o).attr("x",8),e.barD3.selectAll(".ntexthelper-wrapping-line").attr("x",8)),e.barD3.classed(s)||(m.positionProgressBar(e),m.positionConstraintSymbols(e),m.positionPredictedEndBar(e)))},checkForBarType:function(e){return e===l.Single||e===l.SingleRespectedByOptimization}}),e.exports=u},5618:function(e,t,i){var a=i(3755),n=i(9748),r=n.NGANTT_BAR_RECT_CLASS,o=n.NGANTT_BAR_RECT_CAL_CLASS,s=n.NGANTT_BAR_PATH_CAL_CLASS,l=n.NGANTT_BAR_OUTLINE_CLASS,c=n.BarType,d=n.ElemType,m=n.TimeType,u=i(7857),h=i(5645),p=function(){};a.extend(p.prototype,{createBar:function(e){e.respectingCalendar?(e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+o,{elemType:d.BarRectangle,shape:e.barShapeId})),e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+s,{elemType:d.BarRectangle,shape:e.barShapeId})),h.separateBarShapeOutlinesEnabled&&(e.barD3.selectAll("path."+r).style("stroke-width",0),e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+l,{elemType:d.BarRectangle,shape:e.barShapeId})).style("fill","transparent"))):e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+s,{elemType:d.BarRectangle,shape:e.barShapeId}))},positionBar:function(e){if(e.barD3){var t=!e.calendar||e.calendar.determineTimeType(e.timeRange.start)===m.WorkingTime,i=e.convertXToLimitedX;if(e.calendar){for(var a="M0,"+e.barHeight+"V0",n="M0,"+e.barHeight+(t?"V0":""),r=u.calculateWorkingTime(e.calendar,e.timeRange.end,e.timeRange.start),c=e.timeRange.start;null!==(c=e.calendar.findStartOfNextTimeTypeChange(c))&&c.getTime()<e.timeRange.end.getTime();){t=!t;var d=Math.max(i(e.timeAxis.convertDateToX(c))-i(e.timeAxis.convertDateToX(e.timeRange.start))-1,0),p=u.calculateWorkingTime(e.calendar,c,e.timeRange.start)/r*e.barHeight;a=a+"L"+d+","+p,n=n+"L"+d+","+(t?e.barHeight:p)+"V"+(t?p:e.barHeight)}a+="L"+e.width+","+e.barHeight+"H0",e.barD3.select("."+o).attr("d",a),e.barD3.select("."+s).attr("d",n+"L"+e.width+","+e.barHeight+"H0"),h.separateBarShapeOutlinesEnabled&&e.barD3.select("path."+l).attr("d",a)}else e.barD3.select("."+s).attr("d","M0,0L"+e.width+","+e.barHeight+"V"+e.barHeight+"H0")}e.worldViewVisible&&(e.worldViewPathData=[{x:0,y:0},{x:e.worldViewBarWidth,y:e.barHeight},{x:0,y:e.barHeight},{x:0,y:0}])},checkForBarType:function(e){return e===c.StartEnd}}),e.exports=p},4505:function(e,t,i){var a=i(7930),n={_isActive:!1,active:function(){return arguments.length&&(n._isActive=!!arguments[0]),n._isActive},_assert:function(t,i,n,r){if(e.exports._isActive){var o=a.nDebugHelper.active();a.nDebugHelper.active(!0);try{a.nDebugHelper[t](i,n,r)}finally{a.nDebugHelper.active(o)}}},assert:function(e,t,i){n._assert("assert",e,t,i)},assertNotNull:function(e,t,i){n._assert("assertNotNull",e,t,i)},assertStringOrNull:function(e,t,i){n._assert("assertStringOrNull",e,t,i)},assertString:function(e,t,i){n._assert("assertString",e,t,i)},assertArrayOrNull:function(e,t,i){n._assert("assertArrayOrNull",e,t,i)},assertArray:function(e,t,i){n._assert("assertArray",e,t,i)},assertFunctionOrNull:function(e,t,i){n._assert("assertFunctionOrNull",e,t,i)},assertFunction:function(e,t,i){n._assert("assertFunction",e,t,i)},assertNumberOrNull:function(e,t,i){n._assert("assertNumberOrNull",e,t,i)},assertNumber:function(e,t,i){n._assert("assertNumber",e,t,i)},assertDateOrNull:function(e,t,i){n._assert("assertDateOrNull",e,t,i)},assertDate:function(e,t,i){n._assert("assertDate",e,t,i)},trace:function(e){if(n._isActive){var t=a.nDebugHelper.active();a.nDebugHelper.active(!0);try{a.nDebugHelper.trace(e)}finally{a.nDebugHelper.active(t)}}}};e.exports=n},5027:function(e,t,i){var a=i(3755);i(2228);var n=i(7930),r=i(8054),o=".ngsynchronizer";a.widget("netronic.nGanttSynchronizerWidget",a.netronic.nSynchronizerWidget,{options:{horizontalTableScrollOffsetsSynchronized:!1},_ignoreNextTimeAxisChangedEvents:{},_ignoreNextTableScrollOffsetsChangedEvents:{},_create:function(){"use strict";var e=this;this._super();var t=o+this._uniqueID;e.element.children("."+r.WIDGET_CLASS).each((function(i,r){var o=a(r),s=window.getComputedStyle(r);"none"!==s.display&&"hidden"!==s.visibility&&"collapse"!==s.visibility&&(o.on("nganttwidgettimeaxischanged"+t,(function(){e._onGanttTimeAxisChanged(a(this).data(n.nSynchronizerWidget.INDEX_DATA))})).on("nganttwidgettablescrolloffsetchanged"+t,(function(){e._onGanttTableScrollOffsetChanged(a(this).data(n.nSynchronizerWidget.INDEX_DATA))})).on("nganttwidgetsplitterchanged"+t,(function(){e._onGanttSplitterChanged(a(this).data(n.nSynchronizerWidget.INDEX_DATA))})).on("nganttwidgettablewidthchanged"+t,(function(t,i){e._onGanttTableWidthChanged(a(this).data(n.nSynchronizerWidget.INDEX_DATA),i)})),o.nGanttWidget("instance").verticalSplitterWidget().element.on("nsplitterwidgetstartdrag"+t,(function(){e._onGanttSplitterStartDrag(a(this).parent("."+n.nSynchronizerWidget.PANE_CLASS).data(n.nSynchronizerWidget.INDEX_DATA))})).on("nsplitterwidgetdragged"+t,(function(t,i){e._onGanttSplitterDragged(a(this).parent("."+n.nSynchronizerWidget.PANE_CLASS).data(n.nSynchronizerWidget.INDEX_DATA),i.newValue)})).on("nsplitterwidgetenddrag"+t,(function(){e._onGanttSplitterEndDrag(a(this).parent("."+n.nSynchronizerWidget.PANE_CLASS).data(n.nSynchronizerWidget.INDEX_DATA))})))})),e._onGanttTableWidthChanged()},_destroy:function(){"use strict";var e=o+this._uniqueID;this.element.children("."+r.WIDGET_CLASS).each((function(t,i){var n=a(i);n.off(e),n.nGanttWidget("instance").verticalSplitterWidget().element.off(e)})),this._super()},_onGanttTimeAxisChanged:function(e){"use strict";var t=this;if(t._ignoreNextTimeAxisChangedEvents[e])t._ignoreNextTimeAxisChangedEvents[e]=!1;else{var i=t.element.children("."+n.nSynchronizerWidget.PANE_CLASS+e).nGanttWidget("instance").timeAxis();t.element.children("."+r.WIDGET_CLASS).each((function(n,r){var o=n!==e?a(r).nGanttWidget("instance").timeAxis():null,s=!!o&&o.synchronizationNeeded(i);t._ignoreNextTimeAxisChangedEvents[n]=s,s&&o.synchronizeWith(i)}))}},_onGanttTableScrollOffsetChanged:function(e){"use strict";var t=this;if(this.options.horizontalTableScrollOffsetsSynchronized)if(t._ignoreNextTableScrollOffsetsChangedEvents[e])t._ignoreNextTableScrollOffsetsChangedEvents[e]=!1;else{var i=this.element.children("."+n.nSynchronizerWidget.PANE_CLASS+e).nGanttWidget("instance").horizontalTableViewScrollOffset();this.element.children("."+r.WIDGET_CLASS).each((function(n,r){var o=n!==e?a(r).nGanttWidget("instance"):null,s=!!o&&o.horizontalTableViewScrollOffset()!==i;t._ignoreNextTableScrollOffsetsChangedEvents[n]=s,s&&o.scrollTo(i,void 0,void 0)}))}},_onGanttSplitterStartDrag:function(e){this.element.children("."+r.WIDGET_CLASS).each((function(t,i){t!==e&&a(i).nGanttWidget("instance").verticalSplitterWidget().manualStartDrag()}))},_onGanttSplitterDragged:function(e,t){this.element.children("."+r.WIDGET_CLASS).each((function(i,n){i!==e&&a(n).nGanttWidget("instance").verticalSplitterWidget().manualDrag(t)}))},_onGanttSplitterEndDrag:function(e){this.element.children("."+r.WIDGET_CLASS).each((function(t,i){t!==e&&a(i).nGanttWidget("instance").verticalSplitterWidget().manualEndDrag()}))},_onGanttSplitterChanged:function(e){var t=this.element.children("."+n.nSynchronizerWidget.PANE_CLASS+e).nGanttWidget("instance").actualTableViewWidth();this.element.children("."+r.WIDGET_CLASS).each((function(i,n){i!==e&&a(n).nGanttWidget("instance").modifyTableViewWidth(t)}))},_onGanttTableWidthChanged:function(e,t){var i,n=1/0;this.element.children("."+r.WIDGET_CLASS).each((function(r,o){if("none"!==a(o).css("display")){var s=a(o).nGanttWidget("instance"),l=s.actualTableWidth();l&&(n=Math.min(n,l),r===e&&t&&t.inColumnWidthInteraction?i=s.actualTableViewWidth()||0:void 0===e&&(i=Math.max(i||0,s.actualTableViewWidth()||0)))}})),this.element.children("."+r.WIDGET_CLASS).each((function(t,r){var o=a(r).nGanttWidget("option","tableViewWidthMaximum",n);void 0!==i&&t!==e&&o.nGanttWidget("instance").modifyTableViewWidth(i)}))}}),e.exports=a.netronic.nGanttSynchronizerWidget},8054:function(e,t,i){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}i(2526),i(1817),i(2165),i(2222),i(6541),i(3290),i(7327),i(9554),i(2772),i(6992),i(9600),i(1249),i(7042),i(5212),i(561),i(9653),i(7941),i(1539),i(8674),i(4916),i(9714),i(8783),i(5306),i(3123),i(4747),i(3948);var n=i(3755);i(2228);var r=i(5680),o=i(7930),s=o.nD3MigrationHelper.transform,l=o.nCoordinateLimiter,c=o.nCursorHelper,d=o.nDateHelper,m=o.nEventDispatcher,u=o.nLocale,h=o.nLocales,p=o.nOSDetector,_=o.nOverlayArea,f=o.nPopup,g=o.nSortedDatesWithValuesList,T=o.nSplitterWidget,D=o.nTextHelper,v=o.nWorldViewCanvasWidget.CanvasIdentifier,y=i(9748),w=i(4505),S=i(6640).TimeType,b=i(2354),I=b.PortDirections,A=b.RoutingType,E=i(5645),R=i(3670),x=R.TimeUnit,C=i(7857),L=i(2299),B=i(797),O=i(978),M=i(474),V=i(189),k=i(5618),F=i(9873),N=i(3922),W=i(3462),P=i(7913),H=i(1150),X=0,U=1,G=2,Y=0,z=1,j=2,Z=3,K=4,q=[Y,z],Q="Columns",J=0,$=1,ee=y.NGANTT_BAR_CLASS,te=y.NGANTT_BAR_LAYER_CLASS,ie=y.NGANTT_BAR_OUTLINE_CLASS,ae=y.NGANTT_BAR_PHANTOM_CLASS,ne=y.NGANTT_BAR_PHANTOM_NONWORK_CLASS,re=y.NGANTT_BAR_RECT_CLASS,oe="ngantt-bar-selection",se=y.NGANTT_BAR_TEXT_CLASS,le=y.NGANTT_BAR_WIDTH_DEPENDENT_PROP_CLASS,ce="ngantt-calgrid",de="ngantt-compound-bar",me=y.NGANTT_COMPOUND_BAR_BACKGROUND_CLASS,ue=y.NGANTT_COMPOUND_BAR_FOREGROUND_CLASS,he=y.NGANTT_CONSTRAINT_SYMBOL_CLASS,pe=y.NGANTT_CONSTRAINT_LINE_CLASS,_e="ngantt-cursor-date-line",fe="ngantt-cursor-row-rect",ge="ngantt-date-area",Te="ngantt-date-area-text",De="ngantt-date-line",ve="ngantt-date-line-line",ye="ngantt-date-line-text",we="_ngantt_time_type",Se="_ngantt_definition",be="ngantt-drag-date-line-text-rect",Ie="ngantt-drag-date-line-phantom-rect",Ae="ngantt-drag-end-date-line",Ee="ngantt-drag-start-date-line",Re=[];Re[Y]="ngantt-top-hlt-body",Re[z]="ngantt-hlt-body";var xe=[];xe[Y]="ngantt-top-hlt-body-parent",xe[z]="ngantt-hlt-body-parent";var Ce="ngantt-hlt-row",Le="ngantt-link",Be="ngantt-link-path",Oe="ngantt-link-target-marker",Me="ngantt-marked-bar",Ve=[];Ve[Y]="ngantt-top-phantoms-body",Ve[z]="ngantt-phantoms-body";var ke=[];ke[Y]="ngantt-top-phantoms-body-parent",ke[z]="ngantt-phantoms-body-parent";var Fe="ngantt-row-clippath",Ne="ngantt-row-date-area",We="ngantt-row-date-line-group",Pe="ngantt-row-date-line",He="ngantt-row-height-dep",Xe="ngantt-selected-bar-mask-",Ue=["ngantt-top-timearea-overlay","ngantt-timearea-overlay"],Ge=["ngantt-top-timearea-overlay-scp","ngantt-timearea-overlay-scroll-parent"],Ye="ngantt-timearea-row",ze="ngantt-timearea-row-contents",je="ngantt-timescale-dep-stripes-scp",Ze=["ngantt-timescale-overlay","ngantt-timescale-overlay"],Ke=["ngantt-timescale-overlay-scroll-parent","ngantt-bottom-timescale-overlay-scp"],qe=".ngantt",Qe="ngantt-zsel-bar",Je=y.DateLineGridRecurrence,$e=y.ElemType,et=y.ConstraintType,tt=y.DisplayedElements,it=y._BarTypeFlags,at=y.BarType,nt=y.BarShape,rt=y.BarInteractions,ot=y._BarInteractions,st=y.BarSnapTargets,lt=y.LinkType,ct=y.LinkMarker,dt=y.TimeAxisZoom,mt=y.DateLineLabelOrientation,ut=y.DateLineLabelPosition,ht=y.TableRowDefinitionType,pt={Other:0,RowItemsChanged:1,LinkItemsChanged:2,TimeItemsChanged:4,RowCollapsed:102,RowExpanded:103,TimeAxisChanged:7,Virtualization:101,ScrollToRow:9,BeforeRowCollapse:10,WorldView:104,RowLeavesCollapsed:105,RowLeavesExpanded:106},_t=(pt.RowCollapsed,pt.RowExpanded,pt.RowLeavesCollapsed,pt.RowLeavesExpanded,12),ft=0,gt=1,Tt={date:Date,string:String,number:Number},Dt=y.HorizontalAlignment,vt=y.ProgressBarWidthCalculationMode,yt=y.PanningMode,wt="scale(1,1e-6)",St=100,bt=p.isIEWebBrowserControl?0:p.isIE||p.isEdge?.5:-.5,It=p.isIEWebBrowserControl?0:p.isIE||p.isEdge?.5:-.5,At=p.isIEWebBrowserControl?0:p.isIE||p.isEdge?1:-1,Et=p.isIEWebBrowserControl?0:p.isIE?-1:p.isEdge?.5:-.5,Rt=p.isIEWebBrowserControl?0:p.isIE||p.isEdge?.5:0,xt=p.isIEWebBrowserControl?0:p.isIE||p.isEdge?.5:0,Ct=p.isIEWebBrowserControl?0:p.isIE||p.isEdge?.5:0,Lt=p.isIEWebBrowserControl?-.5:0,Bt=p.isIEWebBrowserControl?-.5:0,Ot=p.isIEWebBrowserControl?-1:0,Mt=p.isIEWebBrowserControl?-.5:0,Vt={options:{tableTreeLinesVisible:!1,tableTreeLineOffset:14,tableTreeLevelIndent:14,tableColumnSplitterWidth:1,tableCellContentTopOffset:21,tableRowSeparationLinesVisible:!0,splitterWidth:8,rowItemsDraggable:!1,linkItems:null,dateLineGrids:null,dateLines:null,defaultCalendar:null,defaultBarType:at.StartEnd,defaultBarShape:nt.Rectangle,defaultLeafBarShape:nt.Rectangle,defaultTimeItemSelectable:!0,defaultLeafTimeItemSelectable:!0,defaultRespectingCalendar:!1,defaultBarInteractions:rt.None,defaultLeafBarInteractions:rt.None,forcedBarInteractions:void 0,forcedLeafBarInteractions:void 0,defaultBarSnapTargetsForStart:st.None,defaultBarSnapTargetsForEnd:st.None,alwaysDragCompoundBar:!1,tableViewWidthMaximum:1/0,timeItemsEditableInCollapsedRows:!1,timeItemsHaveSameReferenceAsRowItems:!1,timescaleSmartNavigationEnabled:!0,timescaleSmartNavigationVersion:1,timescaleInteractionsEnabled:!0,timescaleSingleRibbonMode:!1,collapseCalendar:null,timeResolutionUnit:x.Seconds,timeResolutionUnitsPerStep:1,linksVisible:!0,linkMarkersVisible:!0,linksWithDanglingBarsVisible:!1,linkRoutingType:A.Curved,defaultLinkType:lt.EndStart,linkItemsSelectable:!1,defaultLinkItemSelectable:!0,defaultLinkTargetMarker:ct.FilledArrow,verticalLinkDistance:4,subRowDistance:5,defaultMaximumSubRowHeight:null,constraintSymbolHeight:8,constraintSymbolsInMargin:!1,barHeight:22,defaultLeafBarHeight:22,barCornerWidth:5,progressBarHeight:4,progressBarWidthCalculationMode:vt.ConsiderWorkingTimesOnly,predictedEndBarHeight:4,barDragAreaExtent:10,maximumSnapDistance:8,dragDateLinesVisible:!0,horizontalMousePositionHighlightingEnabled:!1,verticalMousePositionHighlightingEnabled:!1,contextMenuEventOnRowItemInTimeArea:!1,timeItemsSelectable:!1,timeItemsSelectableByRectangle:!1,canSelectTimeItemFuncResultsCacheable:!1,barSelectionWithFrames:!0,barSelectionFramesShownWithHigherZOrder:!1,detailedConstraintSymbolsEnabled:!1,constraintViolationsVisible:!1,automaticDraggingOfSelectedTimeItems:!1,defaultLeafRowDisplayedElements:tt.Bars|tt.CalendarGrid,defaultRowCollapsedDisplayedElements:tt.Bars|tt.Optimized|tt.BarsOfCollapsedChildRows|tt.BarsOfCollapsedLeafRows|tt.CalendarGrid,defaultRowExpandedDisplayedElements:tt.Bars|tt.Optimized|tt.BarsOfCollapsedLeafRows|tt.CalendarGrid,timeAreaRowFillFunc:null,timeAreaRowUpdateFunc:null,createBarFunc:null,positionBarFunc:null,positionLinkFunc:null,canSelectTimeItemFunc:null,selectTimeItemFunc:null,canSelectLinkItemFunc:null,selectLinkItemFunc:null,checkVisualZoomFactorFunc:null,timeAreaViewParametersChangedFunc:null,checkSnapSourceDateFunc:null,formatDateFunc:null,delayedScrolling:!1,detachingOfDOMOnUpdateEnabled:!1,minimumLinearCoordinateExtent:void 0,maximumLinearCoordinateExtent:void 0,linearCoordinateReserve:void 0,barVisibilityCheckEnabled:!0,scrollToViewOffsetPercentage:10,timeAreaRowSeparationLinesVisible:!0,calendarGridVisible:!0,alternatingTimeStripesVisible:!1,timescaleRibbonDateLinesVisible:!1,timescaleRibbonsWideningFactor:1,differentiationBetweenEmptyArrayAndUndefined:!1,separateBarShapeOutlinesEnabled:!1,automaticCalculationOfSubRowIndexesOfBarsInRow:!0,rescalingByMouseWheelEnabled:!0,zoomingByPinchInTimeAreaEnabled:!1,minimumVisualZoomFactorOnInteraction:.5,maximumVisualZoomFactorOnInteraction:1.5,editable:!0,relativeDateModeEnabled:!1,recordingSymbolVisible:!1,timeAreaPanningMode:yt.HorAndVer,selectedItemsShownHighlighted:!1,locale:null,timeZone:null,formattingByMoment:!1,watermarkOpacity:.2},_create:function(){"use strict";var e=this;this._super(),this._timeDataItemsMap={},this._unusedTimeDataItemsMap={},this._linkDataItemsMap={},this._unusedLinkDataItemsMap={},this._invalidRowDataItemIDsForSubRowIndexesMap={},this._localeListenerFunc=function(){e._localeChanged()},this.options.locale instanceof u&&this.options.locale.addListener(this._localeListenerFunc),this._nextBindingItemID=1,this._boundTargetInfosMap={},this._selectedLinkDataItemsMap={},this._rowDateLineElemsByRowDataItemIds={},this._barFactory=new L,this._barFactory.registerBarShape(nt.Rectangle,O),this._barFactory.registerBarShape(nt.RectangleWithLeftTopBevel,M),this._barFactory.registerBarShape(nt.UpwardRamp,V),this._barFactory.registerBarShape(nt.DownwardRamp,k),this._barFactory.registerBarShape(nt.Summary,F),this._barFactory.registerBarShape(nt.Arrow,N),this._barFactory.registerBarShape(nt.Diamond,W),this._barFactory.registerBarShape(nt.ArrowLeft,P),this._barFactory.registerBarShape(nt.ArrowRight,H),E.separateBarShapeOutlinesEnabled=this.options.separateBarShapeOutlinesEnabled,this._timeAreaTransitionDuration=500,this._phantomTransitionDuration=500,this._phantomFrameDistance=3,this._phantomFrameRounding=3,this._barFrameDistance=3,this._barFrameRounding=3,this._automaticTimeExpansionParams=void 0,this._currentTimeAreaWidth=void 0,this._currentTimeAreaViewScrollOffset=void 0,this._currentActualBaseTimeUnitWidth=void 0,this._currentStart=void 0,this._currentEnd=void 0,this._selectedTimeItems=[],this._nextCalendarCacheID=0,this._calendarGridDataCache={},this._currentCursorDateLineVisible=this.options.horizontalMousePositionHighlightingEnabled;var t=e.options.timeResolutionUnit||x.Seconds;this._timeAxis=new R,this._timeAxis.baseTimeUnit(t),this._timeAxis.baseTimeUnitWidth(40/R.timeUnitToSeconds(x.Days)*R.timeUnitToSeconds(t)),this.options.updateSuspended&&this._timeAxis.cacheEvents(),this._timeAxis.anythingChangedCallback((function(t){return e._onTimeAxisAnythingChanged(t)})),this._barDragging=new B(this,{visualZoomFactor:e.options.visualZoomFactor,timeAxis:e._timeAxis,dateLines:e.options.dateLines,dateLineGrids:e.options.dateLineGrids,defaultCalendar:e.options.defaultCalendar,maximumSnapDistance:e.options.maximumSnapDistance,defaultBarSnapTargetsForStart:e.options.defaultBarSnapTargetsForStart,defaultBarSnapTargetsForEnd:e.options.defaultBarSnapTargetsForEnd,checkSnapSourceDateFunc:function(t){return e.options.checkSnapSourceDateFunc&&e.options.checkSnapSourceDateFunc(e._extendCallbackArgs(t))},dragStartFunc:function(t){return e._triggerBarDragStartCallback(t)},dragEnterFunc:function(t){return e.options.dragEnterFunc&&e.options.dragEnterFunc(e._extendCallbackArgs(t))},draggedFunc:function(t){return e.options.draggedFunc&&e.options.draggedFunc(e._extendCallbackArgs(t))},dragLeaveFunc:function(t){return e.options.dragLeaveFunc&&e.options.dragLeaveFunc(e._extendCallbackArgs(t))},dragEndFunc:function(t){return e.options.dragEndFunc&&e.options.dragEndFunc(e._extendCallbackArgs(t))},droppedFunc:function(t){return e.options.droppedFunc&&e.options.droppedFunc(e._extendCallbackArgs(t))},onEventFunc:function(t){return e._triggerEvent(e._extendCallbackArgs(t))},phantomFrameDistance:e._phantomFrameDistance,phantomFrameRounding:e._phantomFrameRounding,phantomTransitionDuration:e._phantomTransitionDuration,getRowDataItemFunc:function(t){return e._getDataItem.call(e,t,e._rowDataItemsMap)},getTimeDataItemFunc:function(t){return e._getDataItem.call(e,t,e._timeDataItemsMap)},sortBarsInRowFunc:function(){return e._sortBarsInRow.apply(e,arguments)},registerBindingsForTimeItemsFunc:function(){return e._registerBindingsForTimeItems.apply(e,arguments)},isBindingActiveFunc:function(){return e._isBindingActive.apply(e,arguments)},getBindingPropertyInfosAndValueFunc:function(){return e._getBindingPropertyInfosAndValue.apply(e,arguments)},unregisterAllItemsFunc:function(){return e._unregisterAllItems.apply(e,arguments)},checkForAutomaticRowExpansionFunc:function(){return e._checkForAutomaticRowExpansion.apply(e,arguments)},checkForAutoscrollFunc:function(t,i,a,n){return e._checkForAutoscroll(t.center.x,t.center.y,a,n,(function(){"press"!==t.type&&e._onBarDragMove(t,!0)}))},stopAutoscrollFunc:function(){return e._stopAutomaticRowExpansionTimer(),e._stopAutoscroll.apply(e,arguments)},pointToSVGRelativeFunc:function(){return e._pointToSVGRelative.apply(e,arguments)},getBodyViewScrollTopFunc:function(t){return e._layoutRows[t?0:1].scrollStart()},determineSuperTimeDataItemFunc:function(){return e._determineSuperTimeDataItem.apply(e,arguments)},determineTimeDataItemsFunc:function(){return e._determineTimeDataItems.apply(e,arguments)},determineLeafTimeDataItemsFunc:function(){return e._determineLeafTimeDataItems.apply(e,arguments)},determineTimeRangeFunc:function(){return e._determineTimeRange.apply(e,arguments)},determineTimeDataItemExtentFunc:function(){return e._determineTimeDataItemExtent.apply(e,arguments)},determineBarInteractionFunc:function(){return e._determineBarInteraction.apply(e,arguments)},getActualBarInteractionsFunc:function(){return e._getActualBarInteractions.apply(e,arguments)},setBarInteractionCursorFunc:function(t){return e._setVisibilityForRowCovers(t&(rt.DragVer|rt.DragHorOrVer|ot.DragHorOrVerOverride)?null:"hidden"),e._setBarInteractionCursor.apply(e,arguments)},getActualBarTypeFunc:function(){return e._getActualBarType.apply(e,arguments)},getCurrentlyDisplayedElementsInRowFunc:function(){return e._getCurrentlyDisplayedElementsInRow.apply(e,arguments)},getOrCreateSpecialRowElemFunc:function(){return e._getOrCreateSpecialRowElem.apply(e,arguments)},removeSpecialRowElemFunc:function(){return e._removeSpecialRowElem.apply(e,arguments)},createBarFunc:function(){return e._createBar.apply(e,arguments)},positionBarFullyFunc:function(){return e._positionBarFully.apply(e,arguments)},handleOffsetsOnStartAndEndFunc:function(){return e._handleOffsetsOnStartAndEnd.apply(e,arguments)},positionDragDateLinesFunc:function(t,i){if(e.option("dragDateLinesVisible")){e._currentCursorDateLineVisible=!1,e._positionVerticalDragArea(t.start,t.end),e._verticalDragAreaD3.style("visibility",null),e._positionHorizontalDragArea(t.rowDataItem),e._horizontalDragAreaD3.style("visibility",null),e._dragDateLineTextBaseY=t.rowDataItem.visibleRowDataItem.newY;var a=e._dragDateLineTextBaseY+t.newY-e._layoutRows[e._getBodyAreaIndex(t.rowDataItem.item)].scrollStart()+(e._isItemAtTheTop(t.rowDataItem.item)?0:e._layoutRows[Y].innerViewExtent()+e._actualBodyAreaSeparatorHeight());e._positionDateLine(e._dragStartDateLineD3,t.start,{y:a-6,text:e._formatDate(t.start)}),e._dragStartDateLineD3.selectAll(".ngantt-date-line-text, .ngantt-drag-date-line-text-rect").attr("visibility","hidden"),e._dragStartDateLineD3.style("visibility",null),t.start!==t.end&&(e._positionDateLine(e._dragEndDateLineD3,t.end,{y:a+18+i.bottom-i.top,text:e._formatDate(t.end)}),e._dragEndDateLineD3.selectAll(".ngantt-date-line-text, .ngantt-drag-date-line-text-rect").attr("visibility","hidden"),e._dragEndDateLineD3.style("visibility",null))}},setDragDateLinesTextVisibilityFunc:function(t){e._dragStartDateLineD3.selectAll(".ngantt-date-line-text,.ngantt-drag-date-line-text-rect").attr("visibility",t),e._dragEndDateLineD3.selectAll(".ngantt-date-line-text,.ngantt-drag-date-line-text-rect").attr("visibility",t)},positionDragAreasAndDateLinesFunc:function(t,i,a,n,r){e._positionVerticalDragArea(t.start,t.end),e._positionHorizontalDragArea(t.rowDataItem);var o=t.timeDataItem,s=e._dragDateLineTextBaseY-e._layoutRows[e._getBodyAreaIndex(o.rowDataItem.item)].scrollStart()+(e._isItemAtTheTop(o.rowDataItem.item)?0:e._layoutRows[Y].innerViewExtent()+e._actualBodyAreaSeparatorHeight())+n.top+r.offsetY+i.top-r.minimumY+a-o.newY;e._positionDateLine(e._dragStartDateLineD3,t.start,{y:s-6,text:e._formatDate(t.start)}),e._positionDateLine(e._dragEndDateLineD3,t.end,{y:s+18+i.bottom-i.top,text:e._formatDate(t.end)})},callFunctionForAllDatesInDateLineGridFunc:function(){return e._callFunctionForAllDatesInDateLineGrid.apply(e,arguments)},findRoundedTargetDateTimeFunc:function(){return e._findRoundedTargetDateTime.apply(e,arguments)},findRowDataItemAtYFunc:function(){return e._findRowDataItemAtY.apply(e,arguments)},resetFunc:function(){e._touchScrollingEnabled=!0,e._setBarInteractionCursor(rt.None),e._setVisibilityForRowCovers("hidden"),e._lastBarInteractionValues&&(e._lastBarInteractionValues.outOfBar=!0),e._verticalDragAreaD3.style("visibility","hidden"),e._dragStartDateLineD3.style("visibility","hidden"),e._dragEndDateLineD3.style("visibility","hidden"),e._horizontalDragAreaD3.style("visibility","hidden"),e._currentCursorDateLineVisible=e.options.horizontalMousePositionHighlightingEnabled}}),this.options.isForExport||(this._createVerticalDragArea(),this._createHorizontalDragArea(),this._dragStartDateLineD3=this._createDateLine(e._foregroundDateLinesD3,{className:"ngantt-drag-date-line ngantt-drag-start-date-line",label:"start"}),this._dragStartDateLineD3.style("visibility","hidden"),this._dragEndDateLineD3=this._createDateLine(e._foregroundDateLinesD3,{className:"ngantt-drag-date-line ngantt-drag-end-date-line",label:"end"}),this._dragEndDateLineD3.style("visibility","hidden"),this._cursorDateLineD3=this._createDateLine(e._foregroundDateLinesD3,{className:_e,label:"cursor date",phantom:"phantom"}),this._cursorDateLineD3.style("visibility","hidden"),this._cursorRowD3=this._createCursorRow(),this._cursorRowD3.style("visibility","hidden"),this._createXCoordinateLimiter()),this._timescaleWidgets=[];for(var i=0;i<=1;i++)if(this._titleVisible(i)&&this._timescaleD3s[i]){var a=void 0;if(this._overlayAreas){var r=i+2;a=this._overlayAreas[U][r]._PE_ContentOverlays()[0][0]}this._timescaleWidgets[i]=n(this._timescaleD3s[i].node()).nTimescaleWidget({timescaleElementForInput:a,height:e._actualTitleHeight(i),reversedRibbonOrder:i===$,locale:e.options.locale,timeZone:e.options.timeZone,formattingByMoment:e.options.formattingByMoment,timeAxis:e._timeAxis,delayedScrolling:e.options.delayedScrolling,ribbonsWideningFactor:e.options.timescaleRibbonsWideningFactor,smartNavigationVersion:e.options.timescaleSmartNavigationVersion,singleRibbonMode:e.options.timescaleSingleRibbonMode,rescalingByMouseWheelEnabled:e.options.rescalingByMouseWheelEnabled,smartNavigationEnabled:!e.options.isForExport&&e.options.timescaleSmartNavigationEnabled,relativeDateModeEnabled:e.options.relativeDateModeEnabled}).nTimescaleWidget("instance")}if(this._linkRouter=new b({routingType:this.options.linkRoutingType,timeAxis:this._timeAxis,xCoordinateLimiter:this._xCoordinateLimiter}),Array.isArray(this.options.dateLineGrids)&&this.options.dateLineGrids.forEach((function(t){e._dateLineGridsD3.append("g").attr("class","ngantt-date-line-grid "+t.className).property(we,t.timeType)})),!this.options.isForExport){this._svgSplitterRootD3=this._divScaleD3.append("svg").attr("class","ngantt-svg-splitter-root"),p.isIE||p.isEdge||this._svgSplitterRootD3.style("transform","translate("+this._currentOffsetCorrection.x+"px,"+(this._currentOffsetCorrection.y-Lt)+"px)");var o=this._PE_ActualTableViewWidth();this._verticalSplitterWidget=n(this._svgSplitterRootD3.node()).nSplitterWidget({classes:"ngantt-ver-splitter",min:0,max:this.options.splitterEnabled?e.options.tableViewWidthMaximum||o:0,position:{x:o,y:0},width:this._actualSplitterWidth(),orientation:T.Orientation.Vertical,startDrag:function(){e._tableViewWidthAtStartDrag=e._layoutColumns[X].innerViewExtent(),e._tableScrollStartAtStartDrag=e._layoutColumns[X].scrollStart()},changed:function(t,i){e._onSplitterChanged(i.newValue,!0)},dragged:function(t,i){e.options.virtualized&&e._onSplitterChanged(i.newValue)},endDrag:function(){e._tableViewWidthAtStartDrag=void 0,e._tableScrollStartAtStartDrag=void 0}}).nSplitterWidget("instance")}this.options.collapseCalendar&&this._collapseCalendarChanged(),this._dateLineIDsToSVGElementsMap={},this.options.dateLines&&this._dateLinesChanged(),this.options.locale instanceof u||n(window).on("netronic_nLocales_localeChanged"+e.NXXXXX.WIDGET_NAMESPACE+this._uniqueID,(function(){e._localeChanged()})),this.options.timeZone||n(window).on("netronic_nDateHelper_timeZoneChanged"+e.NXXXXX.WIDGET_NAMESPACE+this._uniqueID,(function(){e._localeChanged()})),this._tableDefinitionChanged()},_destroy:function(){"use strict";try{this._super(),n(window).off(qe+this._uniqueID+"-rectselect"),n(window).off(qe+this._uniqueID+"-tooltip"),n(window).off(qe+this._uniqueID+"-cursor"),this._dateLineIDsToSVGElementsMap=null,this.options.locale instanceof u&&this.options.locale.removeListener(this._localeListenerFunc),this._timeAreaViewParametersChangedTimerID&&window.clearTimeout(this._timeAreaViewParametersChangedTimerID),delete this._barFactory,delete this._linkRouter,delete this._timeAxis}catch(e){this._handleException(e,"_destroy")}},_setOption:function(t,i){"use strict";try{var a=this,n=a.options[t];switch(t){case"tableTreeLinesVisible":this._super(t,i),this._super("treeLinesVisible",i);break;case"treeLinesVisible":this._super("tableTreeLinesVisible",i),this._super(t,i);break;case"tableTreeLineOffset":this._super(t,i),this._super("treeLineOffset",i);break;case"treeLineOffset":this._super("tableTreeLineOffset",i),this._super(t,i);break;case"tableTreeLevelIndent":this._super(t,i),this._super("treeLevelIndent",i);break;case"treeLevelIndent":this._super("tableTreeLevelIndent",i),this._super(t,i);break;case"tableColumnSplitterWidth":this._super(t,i),this._super("columnSplitterWidth",i);break;case"columnSplitterWidth":this._super("tableColumnSplitterWidth",i),this._super(t,i);break;case"tableCellContentTopOffset":this._super(t,i),this._super("cellContentTopOffset",i);break;case"cellContentTopOffset":this._super("tableCellContentTopOffset",i),this._super(t,i);break;case"tableRowSeparationLinesVisible":this._super(t,i),this._super("rowSeparationLinesVisible",i);break;case"rowSeparationLinesVisible":this._super("tableRowSeparationLinesVisible",i),this._super(t,i);break;case"locale":n!==i&&(this.options.locale instanceof u&&this.options.locale.removeListener(this._localeListenerFunc),this._super(t,i),this.options.locale instanceof u&&this.options.locale.addListener(this._localeListenerFunc),this._localeChanged(),this._timescaleWidgets.forEach((function(e){e.option(t,i)})));break;case"timeZone":n!==i&&(this._super(t,i),this._localeChanged(),this._timescaleWidgets.forEach((function(e){e.option(t,i)})));break;case"formattingByMoment":n!==i&&(this._super(t,i),this._timescaleWidgets.forEach((function(e){e.option(t,i)})));break;case"linkItems":this._super(t,i),null!=this.options.rowItemsRoot&&(this._linkItemsChanged(),this._bodyChanged(pt.LinkItemsChanged));break;case"linksVisible":n!==i&&(this._super(t,i),null!=this.options.rowItemsRoot&&this._bodyChanged(pt.LinkItemsChanged));break;case"linkRoutingType":n!==i&&(this._super(t,i),this._linkRouter=new b({routingType:this.options.linkRoutingType,timeAxis:this._timeAxis,xCoordinateLimiter:this._xCoordinateLimiter}));case"linkMarkersVisible":case"defaultLinkTargetMarker":case"defaultLinkType":n!==i&&(this._super(t,i),null!=this.options.rowItemsRoot&&this.options.linksVisible&&(this._linkHotRegionsD3.selectAll(".ngantt-link-hot-region").remove(),this._linksD3.selectAll(".ngantt-link").remove(),this._selectedLinksD3.selectAll(".ngantt-selected-link").remove(),this._bodyChanged(pt.LinkItemsChanged)));break;case"splitterWidth":n!==(i=!isNaN(+i)&&i>=0?i:e.exports.prototype.options[t])&&(this._layoutColumns[G].extent(this.options.isForExport?i:0),this._layoutColumns[G].innerViewExtent(i),this._layoutColumns[G].outerViewExtent(i),this._verticalSplitterWidget&&this._verticalSplitterWidget.option("width",i),this._super(t,i));break;case"timescaleInteractionsEnabled":n!==i&&(this._super(t,i),this._super("timescaleSmartNavigationEnabled",i),this._timescaleWidgets.forEach((function(e){e.option("smartNavigationEnabled",i)})),this._super("rescalingByMouseWheelEnabled",i),this._timescaleWidgets.forEach((function(e){e.option("rescalingByMouseWheelEnabled",i)})));break;case"timescaleSmartNavigationEnabled":n!==i&&(this._super(t,i),this._timescaleWidgets.forEach((function(e){e.option("smartNavigationEnabled",i)})));break;case"timescaleSmartNavigationVersion":n!==i&&(this._super(t,i),this._timescaleWidgets.forEach((function(e){e.option("smartNavigationVersion",i)})));break;case"timescaleSingleRibbonMode":n!==i&&(this._super(t,i),this._timescaleWidgets.forEach((function(e){e.option("singleRibbonMode",i)})));break;case"rescalingByMouseWheelEnabled":case"relativeDateModeEnabled":n!==i&&(this._super(t,i),this._timescaleWidgets.forEach((function(e){e.option(t,i)})));break;case"timescaleRibbonsWideningFactor":n!==i&&i>=1&&(this._super(t,i),this._timescaleWidgets.forEach((function(e){e.option("ribbonsWideningFactor",i)})));break;case"collapseCalendar":n!==i&&(this._super(t,i),this._collapseCalendarChanged());break;case"dateLines":this._super(t,i),this._barDragging.setOption(t,i),this._dateLinesChanged();break;case"dateLineGrids":this._super(t,i),this._barDragging.setOption(t,i),this._dateLineGridsD3.selectAll(".ngantt-date-line-grid").remove(),Array.isArray(i)&&i.forEach((function(e){a._dateLineGridsD3.append("g").attr("class","ngantt-date-line-grid "+e.className).property(we,e.timeType)})),this._updateDateLineGrids();break;case"defaultCalendar":case"maximumSnapDistance":case"defaultBarSnapTargetsForStart":case"defaultBarSnapTargetsForEnd":this._barDragging.setOption(t,i);break;case"horizontalMousePositionHighlightingEnabled":n!==i&&(this._super(t,i),this._currentCursorDateLineVisible=i);break;case"dateAreas":this._super(t,i),this._dateAreasChanged();break;case"visualZoomFactor":n!==(i=+i||0)&&i>0&&i!==this.options.visualZoomFactor&&(this._timeAxis.visualZoomFactor(i),this._barDragging.setOption(t,i),this._super(t,i));break;case"timeItemsSelectable":n!==i&&(i||a.selectedTimeItems([]),a._super(t,i));break;case"timeItemsSelectableByRectangle":n!==i&&(a._super(t,i),a._registerBackgroundPanningEvents());break;case"timeAreaRowSeparationLinesVisible":n!==i&&(a._super(t,i),null!=this.options.rowItemsRoot&&a._backgroundBodyD3s.forEach((function(e){e.selectAll(".ngantt-timearea-row .ngantt-separation-line").style("visibility",i?null:"hidden")})));break;case"editable":n!==i&&(a._super(t,i),null!=this.options.rowItemsRoot&&(a.invalidateAllRows(),a.update()));break;case"defaultRowExpandedDisplayedElements":case"defaultRowCollapsedDisplayedElements":case"defaultLeafRowDisplayedElements":case"progressBarWidthCalculationMode":n!==i&&(a._super(t,+i||0),null!=this.options.rowItemsRoot&&(a.invalidateAllRows(),a.update()));break;case"barHeight":case"defaultLeafBarHeight":case"subRowDistance":case"defaultMaximumSubRowHeight":n!==(i=!isNaN(+i)&&i>0?i:e.exports.prototype.options[t])&&(a._super(t,i),null!=this.options.rowItemsRoot&&(a.invalidateAllRows(!1,!0),a._actualBodyAreaSeparatorHeight()&&(a.options.updateSuspended?a._doResizeNeededWhileUpdateSuspended=!0:a._doResize(pt.Other,null,!0)),a.update()));break;case"calendarGridVisible":n!==i&&(a._super(t,i),i?null!=this.options.rowItemsRoot&&(a._foregroundBodyD3s.forEach((function(e){e.selectAll(".ngantt-row").each((function(e){var t=r.select(this).select(".ngantt-timearea-row-contents");a._createCalendarGridInRow(e,t)}))})),a.invalidateAllRows(),a.update()):a._backgroundBodyD3s.forEach((function(e){e.selectAll(".ngantt-calgrid").remove()})));break;case"delayedScrolling":n!==i&&(a._super(t,i),this._timescaleWidgets.forEach((function(e){e.option(t,i)})));break;case"tableViewWidthMaximum":n!==(i=!isNaN(+i)&&i>=0?i:e.exports.prototype.options[t])&&(a._super(t,i),a._tableViewChanged());break;case"timeResolutionUnit":n!==i&&(a._super(t,i),a._timeAxis.baseTimeUnit(i||x.Seconds),this._timescaleWidgets.forEach((function(e){e.render()})));break;case"alternatingTimeStripesVisible":case"timescaleRibbonDateLinesVisible":n!==(i=!!i)&&(a._super(t,i),a._updateTimescaleDependentStripesOrDateLines());break;case"separateBarShapeOutlinesEnabled":n!==(i=!!i)&&(a._super(t,i),E.separateBarShapeOutlinesEnabled=i);break;case"zoomingByPinchInTimeAreaEnabled":n!==(i=!!i)&&(a._super(t,i),a._backgroundBodyRectD3s.slice().concat(a._backgroundBodyD3s).forEach((function(e){e.classed(m.PINCH_EVENT_CLASS_NAME,i)})));break;case"automaticCalculationOfSubRowIndexesOfBarsInRow":n!==i&&(null!=this.options.rowItemsRoot&&i&&a.calculateInvalidSubRowIndexesOfBarsInRows(),a._super(t,i));break;case"recordingSymbolVisible":n!==i&&(a._super(t,i),a._recordingSymbolD3.attr("visibility",i?null:"hidden"));break;case"updateSuspended":n!==i&&(a._super(t,i),i?a._timeAxis.cacheEvents():(a._timeAxis.triggerCachedEvents(),a._timeAreaViewUpdateNeeded&&(delete a._timeAreaViewUpdateNeeded,a._timeAreaViewChanged())));break;case"forcedBarInteractions":case"forcedLeafBarInteractions":a._super(t,i),a._lastMouseEnterElem&&a._onmousemove_cursor(a._lastMouseMoveEvent,a._lastMouseEnterElem,ee);break;case"watermarkURL":a._super(t,i),a._updateWatermarks();break;case"watermarkOpacity":a._super(t,i),a._backgroundWatermarkParentD3.style("opacity",i);break;default:a._super(t,i)}}catch(e){this._handleException(e,"option")}},_initConstants:function(){"use strict";var e=this._getOrCreateNXXXXX({WIDGET_ABBREVIATION:"ngantt",WIDGET_PREFIX:"ngantt-",WIDGET_NAMESPACE:".ngantt",WIDGET_NAME_IN_ERROR_MESSAGES:"nGanttWidget",WIDGET_PROPERTYNAME_IN_CALLBACKS:"ganttWidget",WIDGET_TABLE_PREFIX:"ngantt-table-",WIDGET_TABLE_INSERTION:"table-"});return this._super(),e.BAR_SELECTION_FRAMES_PARENT_CLASS=[e.WIDGET_PREFIX+"top-bar-selection-frames-parent",e.WIDGET_PREFIX+"bar-selection-frames-parent"],e.SELECTED_ROW_GRADIENT_START_CLASS=e.WIDGET_PREFIX+"table-row-selected-gradient-start",e.SELECTED_ROW_GRADIENT_END_CLASS=e.WIDGET_PREFIX+"table-row-selected-gradient-end",e.WIDTH_CLIPPATH_ID[X]=e.WIDGET_PREFIX+"table-width-clippath",e.WIDTH_CLIPPATH_ID[U]=e.WIDGET_PREFIX+"timearea-width-clippath",e},_onSplitterChanged:function(e,t){"use strict";try{this._setViewWidth(X,e),this._tableViewChanged(!0,!0),this._trigger("splitterChanged",null,{newValue:e,isDropped:t})}catch(e){this._handleException(e,"onSplitterChanged_verticalSplitter")}},_doResize:function(e,t,i){"use strict";var a=this;if(a.options.updateSuspended&&a._doResizeNeededWhileUpdateSuspended&&(delete a._doResizeNeededWhileUpdateSuspended,i=!0),a._mainWidth>0&&a._mainHeight>0){if(void 0===a._layoutRows[z].extent()&&!i)return void window.setTimeout((function(){a._layoutRows[z].innerViewExtent()||a._doResize(e,t,!0)}),100);a._setOption("updateSuspended",!1);var n=a._actualScaledMainWidth(),o=a._actualScaledMainHeight();a._tableViewChanged();var s=a._calcBodyViewAndSeparatorHeights(o),l=a._calcInnerBodyViewAndSeparatorHeights(s),c=[];c[Y]=l[Y]-a._layoutRows[Y].innerViewExtent(),c[z]=l[z]-a._layoutRows[z].innerViewExtent();var d=a._shouldHeightChange(e,c);if(d){a._layoutRows[Y].outerViewExtent(s[Y]),(a._layoutRows[z].outerViewExtent()||s[z]>=0)&&a._layoutRows[z].outerViewExtent(s[z]),a._layoutRows[Y].innerViewExtent(l[Y]),(a._layoutRows[z].innerViewExtent()||l[z]>=0)&&a._layoutRows[z].innerViewExtent(l[z]),a._layoutRows[K].extent(0),a._layoutRows[K].outerViewExtent(s[K]),a._layoutRows[K].innerViewExtent(l[K]);var m=0;if(a._layoutRows[j].start(m),m+=a._layoutRows[j].outerViewExtent(),a._layoutRows[Y].start(m),m+=a._layoutRows[Y].outerViewExtent(),a._layoutRows[K].start(m),m+=a._layoutRows[K].outerViewExtent(),a._layoutRows[z].start(m),m+=a._layoutRows[z].outerViewExtent(),a._layoutRows[Z].start(m),s[Y]>=0||s[z]>=0){var u=!a.options.isForExport&&a._elementHeightOnLastCallOf_doResize===a._elementHeight,h=u?function(e){return r.select(e[0]).transition().duration(a.options.transitionDuration)}:function(e){return r.select(e[0])},p=u?function(e){return e.transition().duration(a.options.transitionDuration)}:function(e){return e};a._doResizeOverlaysHeightWithAnimation(h),a._PE_DoResizeUpdateBodyHeight(p),a._PE_DoResizeHeight_222(p);var _=[];q.forEach((function(e){c[e]>0&&(_[e]=Math.max(0,a._layoutRows[e].extent()-l[e]),a._layoutRows[e].scrollStart()<=_[e]&&(_[e]=void 0))})),null==_[Y]&&null==_[z]||a._scrollOffsetsChanged([void 0,void 0],_),a.options.virtualized&&a._updateVirtualization(_t,t)}}var f=a._calcWidthDifference(n),g=a._shouldWidthChange(e,f);if(d||g){this._currentScaledMainWidth=n;var T=a._specifyNewViewWidth(n);a._layoutColumns[X].outerViewExtent(T[X]),a._layoutColumns[U].outerViewExtent(T[U]);var D=a._calcInnerViewWidths(T);a._layoutColumns[X].innerViewExtent(D[X]),a._layoutColumns[U].innerViewExtent(D[U]);var v=0;a._layoutColumns[X].start(v),v+=a._layoutColumns[X].outerViewExtent(),a._layoutColumns[G].start(v),v+=a._layoutColumns[G].outerViewExtent(),a._layoutColumns[U].start(v)}(d||g)&&(a._layoutGrid.update(),a._updateWatermarks(),a._provideChartSizeToWorldView(),a._provideViewRectsToWorldView()),a._executeCachedTransitionFunctions(),a._elementHeightOnLastCallOf_doResize=a._elementHeight}},_svgRootWheelVer:function(e,t){"use strict";return this._barDragging.isActive()&&this._barDragging.handleDrag(),this._super(e,t)},_svgRootWheelHor:function(e,t){"use strict";return this._innerClientXToLayoutColumn(e[0])===U?(this._doRelativeScroll("timearea",t>0?.1:-.1),!1):this._super(e,t)},_doRelativeScroll:function(e,t){"use strict";switch(e){case"timearea":this._doRelativeScrollHor(U,t);break;default:this._super(e,t)}},_onSwipe_OpacityOff:function(){"use strict";this._super();for(var e=0;e<=1;e++)this._overlayAreas[U][e].showIOSScrollBars(!1)},_onSwipe_RecurrentCalculations:function(e){"use strict";var t=this;if("timeArea"===t._bodySwipeScrollPos.view)switch(t._currentPanParams||(t._currentPanParams={}),t._currentPanParams.timeAreaPanningMode!==yt.HorizontallyOnly&&t._currentPanParams.timeAreaPanningMode!==yt.VerticallyOnly&&(t._currentPanParams.timeAreaPanningMode=t.options.timeAreaPanningMode),void 0===t._currentPanParams.timeAreaCachedPanningMode&&t._currentPanParams.timeAreaPanningMode===yt.AutoHorOrVer&&(Math.abs(e.deltaX)>5||Math.abs(e.deltaY)>5)&&(Math.abs(e.deltaX)>Math.abs(e.deltaY)?t._currentPanParams.timeAreaPanningMode=yt.HorizontallyOnly:t._currentPanParams.timeAreaPanningMode=yt.VerticallyOnly),t._currentPanParams.timeAreaPanningMode){case yt.VerticallyOnly:"mouse"===e.pointerType&&c.setCursor(t.element[0],"ns-resize"),e.deltaX=0;break;case yt.HorizontallyOnly:"mouse"===e.pointerType&&c.setCursor(t.element[0],"ew-resize"),e.deltaY=0;break;case yt.None:"mouse"===e.pointerType&&c.setCursor(t.element[0],null),e.deltaX=0,e.deltaY=0;break;case yt.HorAndVer:"mouse"===e.pointerType&&c.setCursor(t.element[0],"move")}else"mouse"===e.pointerType&&c.setCursor(t.element[0],"move")},_onSwipe_DetectView:function(e){"use strict";if(this._super(e),e&&e.row){var t=e.row.getIndex();switch(t){case Y:case z:var i=!1;e.column&&e.column.getIndex()===U&&(this._bodySwipeScrollPos.view="timeArea",i=!0),this._overlayAreas[U][t].showIOSScrollBars(!0,i,!0)}}},_onSwipe_ScrollTo:function(e,t,i){"use strict";"timeArea"===this._bodySwipeScrollPos.view?(e[U]=Math.min(Math.max(0,this._timeAxis.actualTimeAreaWidth()-this._timeAxis.timeAreaViewWidth()),this._bodySwipeScrollPos.lefts[U]-i.deltaX),this._scrollTo(e,t)):this._super(e,t,i)},_scrollLeftsChanged:function(e,t,i,a,n){"use strict";var r=this;if(n.timeAxisChangedEventNeeded=!1,null!=e&&null!=e[U]){var o=Math.abs(r._currentTimeAreaViewScrollOffset-e[U])>.1;if(r._layoutColumns[U].cachedScrollStart(e[U]/r._layoutColumns[U].scrollFactorExceeding()),o){if(i&&r._overlayAreas)for(var s=0;s<=1;s++)r._overlayAreas[U][s].scrollLeft(r._layoutColumns[U].cachedScrollStart());i||(r._PE_SetTimeAreaViewScrollOffset(e[U],!0),n.timeAxisChangedEventNeeded=!0,n.viewChangedFlags[U]=!0,n.changedFlag=!0,r._callTimeAreaViewParametersChangedFunc())}}if(n.viewChangedFlags[U]){void 0===e&&(e=[]),void 0===e[U]&&(e[U]=r._getHorViewScrollOffset(U)),void 0===t&&(t=[]),void 0===t[Y]&&(t[Y]=r._layoutRows[Y].scrollStart()),void 0===t[z]&&(t[z]=r._layoutRows[z].scrollStart());var l=[];if(l[Y]="translate("+-r.convertXToLimitedX(e[U])+","+-t[Y]+")",l[z]="translate("+-r.convertXToLimitedX(e[U])+","+-t[z]+")",r._linkHotRegionsD3&&r._linkHotRegionsD3.attr("transform",l[z]),r._linksD3&&r._linksD3.attr("transform",l[z]),r._selectedLinksD3&&r._selectedLinksD3.attr("transform",l[z]),q.forEach((function(e){r._barSelectionFramesD3&&r._barSelectionFramesD3[e].attr("transform",l[e]),r._rowDateLinesD3s&&r._rowDateLinesD3s[e].attr("transform",l[e])})),r._timeAreaViewChanged(),a&&void 0!==e[U]&&r._overlayAreas)for(s=0;s<=1;s++)r._overlayAreas[U][s].scrollLeft(r._layoutColumns[U].cachedScrollStart())}r._super(e,t,i,a,n)},_triggerChangedEventAfterScrollOffsetsChanged:function(e){"use strict";this._super(e),e.timeAxisChangedEventNeeded&&this._trigger("timeAxisChanged")},_onTimeAxisAnythingChanged:function(e){"use strict";var t=this;(!t._temporaryMarkMinimumDate||(new Date).getTime()>t._temporaryMarkMinimumDate)&&(t._temporaryMarkVisible=void 0),null!=e.centerCoordinateOnRescaling&&t._saveXStretchCenterCoordinate(e.centerCoordinateOnRescaling);var i=!0;if(!t._changeTimeAreaWidthScrollFactor()){var a=t._calculateTimeAreaOverlayWidth(t._layoutColumns[U].scrollFactorExceeding());t._layoutColumns[U].extent(a),t._layoutGrid.update(),t._updateWatermarks()}var n=[];n[U]=t._timeAxis.timeAreaViewScrollOffset(),t._currentTimeAreaViewScrollOffset!==n[U]&&(t._scrollTo(n,[void 0,void 0]),i=!1),i&&t._timeAreaViewChanged(),t._callTimeAreaViewParametersChangedFunc(),t._worldViewDivJQ&&(t._provideChartSizeToWorldView(),t._provideViewRectsToWorldView(),t._createRows(t._currentlyVisibleRowDataItems?t._currentlyVisibleRowDataItems[0].slice().concat(t._currentlyVisibleRowDataItems[1]):[],void 0,pt.WorldView)),t._trigger("timeAxisChanged")},_callTimeAreaViewParametersChangedFunc:function(){"use strict";var e=this;if(e.options.timeAreaViewParametersChangedFunc){void 0!==e._timeAreaViewParametersChangedTimerID&&window.clearTimeout(e._timeAreaViewParametersChangedTimerID);var t=function(){try{if(delete e._timeAreaViewParametersChangedTimerID,e.options.timeAreaViewParametersChangedFunc){var t=e._extendCallbackArgs({scrollOffset:e._timeAxis.timeAreaViewScrollOffset(),width:e._timeAxis.timeAreaViewWidth(),start:e._timeAxis.actualStart(),end:e._timeAxis.actualEnd()});t.scrollOffset&&(t.start=C.addWorkingTime(e.options.collapseCalendar,e._timeAxis.convertXToDate(t.scrollOffset,!1,!0),0)),t.scrollOffset+t.width<e._timeAxis.actualTimeAreaWidth()&&(t.end=C.addWorkingTime(e.options.collapseCalendar,e._timeAxis.convertXToDate(t.scrollOffset+t.width,!1,!0),"-0")),e.options.timeAreaViewParametersChangedFunc.call(e,t)}}catch(t){e._handleException(t,"_callTimeAreaViewParametersChangedFunc")}};e.options.scrollOffsetsChangedFuncTimeDelay?e._timeAreaViewParametersChangedTimerID=window.setTimeout(t,e.options.scrollOffsetsChangedFuncTimeDelay):t()}},verticalSplitterWidget:function(){return this._verticalSplitterWidget},scrollTo:function(e,t,i,a){"use strict";try{w.assertNumberOrNull(e,"",0),w.assertNumberOrNull(t,"",1),w.assertNumberOrNull(i,"",2),w.assertNumberOrNull(a,"",3);var n=[];n[X]=e,n[U]=t;var r=[];r[Y]=a,r[z]=i,this._scrollTo(n,r)}catch(e){this._handleException(e,"scrollTo")}},_setLayoutColumnsScrollLefts:function(e){"use strict";this._super(e),null!=e&&null!=e[U]&&(e[U]=Math.max(0,Math.min(e[U],Math.ceil(this._timeAxis.actualTimeAreaWidth()-this._timeAxis.timeAreaViewWidth()))))},horizontalTimeAreaViewScrollOffset:function(){return this._getHorViewScrollOffset(U)},_determineCurrentTableViewWidthMaximum:function(){"use strict";if(this.options.tableDefinition||null!=this.options.tableWidth){var e=this._actualScaledMainWidth()||1/0;return Math.min(this.actualTableWidth(),Math.min(Math.max(0,e-this._actualSplitterWidth()-this._actualScrollBarWidth()),this.options.tableViewWidthMaximum))}},timeAreaBodyClientRect:function(){"use strict";return this._PE_BodyClientRect()},_tableViewChanged_DetectTableViewWidth:function(){"use strict";var e=this._layoutColumns[X].innerViewExtent(),t=this._determineCurrentTableViewWidthMaximum();return void 0===e?e=t:void 0!==t&&e>(t||0)&&(e=Math.max(0,t||0)),e},_adaptVerticalSplitter:function(){"use strict";if(this._verticalSplitterWidget){var e=this._determineCurrentTableViewWidthMaximum();void 0!==this._layoutColumns[X].innerViewExtent()&&void 0!==e&&(this._verticalSplitterWidget.option({min:this._fixedTableColumnsWidthPreceding+this._fixedTableColumnsWidthSucceeding,max:this.options.splitterEnabled&&e||0}),this._verticalSplitterWidget.isCurrentlyDragged()||this._verticalSplitterWidget.option({position:{x:this._layoutColumns[X].innerViewExtent(),y:0}}))}},_tableViewChanged_RecalcDependentColumns:function(e,t){"use strict";this._layoutColumns[G].start(t);var i=t+this._actualSplitterWidth(),a=Math.max(0,e-t-this._actualSplitterWidth()),n=a-this._actualScrollBarWidth();this._layoutColumns[U].start(i),this._layoutColumns[U].outerViewExtent(a),this._layoutColumns[U].innerViewExtent(n),this._adaptVerticalSplitter()},_calculateTimeAreaOverlayWidth:function(e){"use strict";var t=this._timeAxis.actualTimeAreaWidth(),i=t;if(e>1){var a=this._timeAxis.timeAreaViewWidth();i=Math.ceil((t-a)/e+a)}return i},_changeTimeAreaWidthScrollFactor:function(){"use strict";var e=this,t=e._timeAxis.actualTimeAreaWidth(),i=Math.max(t/1e5,1);if(e._layoutColumns[U].scrollFactorExceeding()!==i){var a=e._timeAxis.timeAreaViewScrollOffset();e._layoutColumns[U].cachedScrollStart(a/i);var n=e._calculateTimeAreaOverlayWidth(i);return e._layoutColumns[U].extent(n),e._ignoreNextScrollEvents(!0,U),e._layoutColumns[U].scrollFactorExceeding()>i?(e._callJQsScrollLeft(e._PE_ContentOverlays(U),e._layoutColumns[U].cachedScrollStart()),e._setJQsWidth(e._PE_ContentOverlays(U),n)):(e._setJQsWidth(e._PE_ContentOverlays(U),n),e._callJQsScrollLeft(e._PE_ContentOverlays(U),e._layoutColumns[U].cachedScrollStart())),e._layoutColumns[U].scrollFactorExceeding(i),!0}return!1},updateExportWatermarks:function(){return this._updateWatermarks()},_updateWatermarks:function(){"use strict";var e=this;return new Promise((function(t){e._backgroundWatermarkParentD3.selectAll("*").remove();var i=[e.options.watermarkURL,e.options.isForExport?e.options.exportWatermarkURL:void 0],a=i.length,n=function(){--a||t()};i.forEach((function(t){if(t)if("///"===t.substring(0,3)){var i=r.select("#"+t.substring(3)),a=e._backgroundWatermarkParentD3.append("g");if(!i.size())return!1;var s=i.attr("href");if(0===s.indexOf("data:image/svg")){var l=atob(s.slice(s.indexOf(",")+1));a.node().insertAdjacentHTML("afterbegin",l)}else a.append("image").attr("href",s);o.nImageHelper.calculateOriginalImageSize(i.node()).then((function(t){var i=t.imageNode.getAttribute("data-originalwidth"),r=t.imageNode.getAttribute("data-originalheight"),o=e._currentTimeAreaViewWidth/i||1,s=e._actualInnerBodyViewHeightsSumWithSeparator()/r,l=e.options.watermarkScale||Math.min(o,s),c=(e._currentTimeAreaViewWidth-i*l)/2||0,d=(e._actualInnerBodyViewHeightsSumWithSeparator()-r*l)/2;a.attr("transform","translate(".concat(c,",").concat(d,") scale(").concat(l,")")),n()}))}else n();else n();return!0}))}))},_timeAreaViewChanged:function(){"use strict";var e=this;if(e.options.updateSuspended)e._timeAreaViewUpdateNeeded=!0;else{var t=e._timeAxis.actualTimeAreaWidth(),i=e._timeAxis.timeAreaViewWidth(),a=e._timeAxis.timeAreaViewScrollOffset(),n=e._timeAxis.actualBaseTimeUnitWidth(),o=[];o[Y]=e._currentBodyViewScrollTops[Y]!==e._layoutRows[Y].scrollStart(),o[z]=e._currentBodyViewScrollTops[z]!==e._layoutRows[z].scrollStart();var l=e._currentTimeAreaWidth!==t,c=e._currentTimeAreaViewWidth!==i,d=a-e._currentTimeAreaViewScrollOffset,m=e._currentActualBaseTimeUnitWidth!==n,u=e._currentStart&&e._currentStart.getTime()!==e._timeAxis.actualStart().getTime()||e._currentEnd&&e._currentEnd.getTime()!==e._timeAxis.actualEnd().getTime();if(e._currentBodyViewScrollTops[Y]=e._layoutRows[Y].scrollStart(),e._currentBodyViewScrollTops[z]=e._layoutRows[z].scrollStart(),e._currentTimeAreaWidth=t,e._currentTimeAreaViewWidth=i,e._currentTimeAreaViewScrollOffset=a,e._currentActualBaseTimeUnitWidth=n,e._currentStart=e._timeAxis.actualStart(),e._currentEnd=e._timeAxis.actualEnd(),o[z]||l||c||d||m||u){if(e.options.virtualized&&!o[z]&&!o[Y]&&d&&m&&e._removeRealizedRowsIfTooMany(),l&&!e._changeTimeAreaWidthScrollFactor()){var h=e._calculateTimeAreaOverlayWidth(e._layoutColumns[U].scrollFactorExceeding());e._layoutColumns[U].extent(h),e._doResize()}c?e._provideChartSizeToWorldView():d&&e._provideViewRectsToWorldView();var p=e._backgroundBodyD3s[Y].selectAll(".ngantt-row"),_=e._backgroundBodyD3s[z].selectAll(".ngantt-row"),f=e._foregroundBodyD3s[Y].selectAll(".ngantt-row"),g=e._foregroundBodyD3s[z].selectAll(".ngantt-row"),T=e._highlightedBodyD3s[Y].selectAll(".ngantt-hlt-row"),D=e._highlightedBodyD3s[z].selectAll(".ngantt-hlt-row"),v=this._updateXCoordinateLimiterTransform(),y=e.getCurrentUpperXLimit()-e.getCurrentLowerXLimit(),w=e._extendCallbackArgs({isForeground:!1,width:e._actualLayoutColumnLeft(U)+y,timeAreaWidth:y,bodyViewScrollOffsetChanged:o[z],timeAreaWidthChanged:l,timeAreaViewWidthChanged:c,timeAreaViewScrollOffsetChanged:!!d,baseTimeUnitWidthChanged:m,startOrEndChanged:u,xCoordTransformChanged:v,rowHeightChanged:!1}),S=this.convertXToLimitedX(a),b="translate("+-S+")",I=[];if(I[Y]="translate("+-S+","+-e._layoutRows[Y].scrollStart()+")",I[z]="translate("+-S+","+-e._layoutRows[z].scrollStart()+")",[p,_].forEach((function(t){t&&t.each((function(t){var a=r.select(this).select(".ngantt-timearea-row"),n=a.select("g.ngantt-timearea-row-contents");c&&(a.select(".ngantt-row-background-rect").attr("width",i),a.select(".ngantt-separation-line").attr("x2",i)),(l||m||u||v)&&e._getCurrentlyDisplayedElementsInRow(t)&tt.CalendarGrid&&e._updateCalendarGridForRow(t,n,!1),Array.isArray(t.item.dateAreas)&&e._positionDateAreasInRow(t,a,!1),e.options.timeAreaRowUpdateFunc&&(w.rowItem=t.item,w.rowElem=a.node(),w.parentElem=n.node(),e.options.timeAreaRowUpdateFunc.call(e,w))}))})),w.isForeground=!0,[f,g,T,D].forEach((function(t){t&&t.each((function(t){var i=r.select(this).select(".ngantt-timearea-row"),a=i.select("g.ngantt-timearea-row-contents");((m||u||v)&&(a.selectAll("."+ee+",."+de).each((function(i){if(i){var a=r.select(this);void 0!==t.oldY?e._positionBarFully(a,t,i,void 0,void 0,!0):e._positionBar(a,i,void 0,void 0,!0)}})),Array.isArray(t.item.dateAreas)&&e._positionDateAreasInRow(t,i,!0),e.options.timeAreaRowUpdateFunc&&(w.rowItem=t.item,w.rowElem=i.node(),w.parentElem=a.node(),e.options.timeAreaRowUpdateFunc.call(e,w))),e.options.rowOmissionSymbolsVisible)&&r.select(this).selectAll("."+e.NXXXXX.ROW_OMISSION_SYMBOL_CLASS+" line").attr("x2",e._actualScaledMainWidth())}))})),(d||m||u||v)&&e._svgRootD3.selectAll(".ngantt-phantom-row").each((function(){var t=r.select(this).select(".ngantt-timearea-row").select("g.ngantt-timearea-row-contents");t.attr("transform","translate("+-S+")"),(m||u||v)&&t.selectAll("."+ee+",."+de).each((function(t){if(t){var i=r.select(this),a=s(i.attr("transform")).translate[1];e._positionBarFully(i,void 0,t,void 0,void 0,void 0,a),t.frameD3&&(m||v)&&t.frameD3.attr("transform","translate("+(e.convertXToLimitedX(e._timeAxis.convertDateToX(t.frameStart))+Rt)+","+(t.newY+xt)+")").select("."+ae).attr("width",e.convertXToLimitedX(e._timeAxis.convertDateToX(t.frameEnd))-e.convertXToLimitedX(e._timeAxis.convertDateToX(t.frameStart))+2*e._phantomFrameDistance)}}))})),m||u||v){var A={};e._linksD3&&e._linksD3.selectAll(".ngantt-link").each((function(t){var i=t.sourceTimeDataItem;if(i&&e._getDataItem(i.id,e._timeDataItemsMap)&&(A[i.id]||(A[i.id]=!0,i.elem&&i.elem.parentElement&&!i.isHiddenByLimits&&0!==i.rowDataItem.totalHeight&&e._isTimeDataItemVisible(i)||e._positionBar(null,i,2)),(i=t.targetTimeDataItem)&&e._getDataItem(i.id,e._timeDataItemsMap))){A[i.id]||(A[i.id]=!0,i.elem&&i.elem.parentElement&&!i.isHiddenByLimits&&0!==i.rowDataItem.totalHeight&&e._isTimeDataItemVisible(i)||e._positionBar(null,i,2));var a=r.select(this);e._positionLink(a,t,pt.LinkItemsChanged)}})),e._updateRowDateLinesX()}(d||u||v)&&([p,_,f,g,T,D].forEach((function(e){e&&e.selectAll(".ngantt-timearea-row-contents").attr("transform",b)})),[e._highlightedBodyD3s,e._phantomsBodyD3s].forEach((function(e){e&&e.forEach((function(e){e.selectAll(" .ngantt-timearea-row-contents").attr("transform",b)}))})),e._verticalDragAreaD3&&e._verticalDragAreaD3.attr("transform",b)),(u||isNaN(d))&&e._updateDateLineGrids(),(l||m||v)&&([e._backgroundDateLinesD3,e._foregroundDateLinesD3,e._dateLineGridsD3].forEach((function(t){t&&t.selectAll(".ngantt-date-line").each((function(){e._positionDateLine(r.select(this))}))})),[e._backgroundDateAreasD3,e._foregroundDateAreasD3].forEach((function(t){t&&t.selectAll(".ngantt-date-area").each((function(){e._positionDateArea(r.select(this))}))}))),(d||u||v)&&(e._backgroundDateLinesD3&&e._backgroundDateLinesD3.attr("transform",b),e._foregroundDateLinesD3&&e._foregroundDateLinesD3.attr("transform",b),e._backgroundDateAreasD3&&e._backgroundDateAreasD3.attr("transform",b),e._foregroundDateAreasD3&&e._foregroundDateAreasD3.attr("transform",b),e._dateLineGridsD3&&e._dateLineGridsD3.attr("transform",b),e._linkHotRegionsD3&&e._linkHotRegionsD3.attr("transform",I[z]),e._linksD3&&e._linksD3.attr("transform",I[z]),e._selectedLinksD3&&e._selectedLinksD3.attr("transform",I[z]),q.forEach((function(t){e._barSelectionFramesD3&&e._barSelectionFramesD3[t].attr("transform",I[t]),e._rowDateLinesD3s&&e._rowDateLinesD3s[t].attr("transform",I[t])}))),c&&e._foregroundBodyD3s.forEach((function(t){t&&t.select("line.ngantt-last-separation-line").attr("x2",e._actualLayoutColumnLeft(U)+i)})),(l||c||d||m||u)&&e._timescaleWidgets.forEach((function(e){e.render()})),(e.options.alternatingTimeStripesVisible||e.options.timescaleRibbonDateLinesVisible)&&(d||c||m||u||v)&&e._updateTimescaleDependentStripesOrDateLines()}}},_updateDateLineGrids:function(){"use strict";var e=this,t=e._timeAxis.actualStart().getTime(),i=e._timeAxis.actualEnd().getTime(),a=e._dateLineGridsD3.selectAll(".ngantt-date-line-grid");a.selectAll(".ngantt-date-line").remove(),a.each((function(){var a=r.select(this),n=a.property(we);e._callFunctionForAllDatesInDateLineGrid(t,i,n,(function(t){e._createDateLine(a,{date:t})}))}))},_callFunctionForAllDatesInDateLineGrid:function(e,t,i,a){"use strict";var n=this,r=this.options.locale instanceof u?n.options.locale.applyDateFormat:function(e){return e()};d.applyTimeZone(n.options.timeZone,(function(){for(var o=d.dateToMomentIfNecessary(new Date(e-1));!((o=r.call(n.options.locale,(function(){return d.addToDateOrMoment(d.normalizeDateOrMoment(o,i,1),i,1)}))).valueOf()>=t);)a.call(n,d.toDate(o))}))},timeRange:function(e,t){"use strict";try{var i=this;w.assertDate(e,"",0),w.assertDate(t,"",1),i.options.updateSuspended||i._timeAxis.cacheEvents(),i._timeAxis.start(e),i._timeAxis.end(t),i.options.updateSuspended||i._timeAxis.triggerCachedEvents(),i._timeAreaViewChanged()}catch(e){this._handleException(e,"timeRange")}return this},timeAxis:function(){return this._timeAxis},timescaleWidget:function(){return this._timescaleWidgets[J]},zoom:function(e){"use strict";try{var t=this;t._timeAxis.cacheEvents();var i=t._timeAxis.actualBaseTimeUnitWidth(),a=t._timeAxis.timeAreaViewScrollOffset();t._saveXStretchCenterCoordinate(a),e===dt.Stretch?t._timeAxis.baseTimeUnitWidth(1.25*i):t._timeAxis.baseTimeUnitWidth(.8*i);var n=t._timeAxis.actualBaseTimeUnitWidth();if(n!==i){var r=a*n/i;r<0&&(r=0),t._PE_SetTimeAreaViewScrollOffset(r)}t._timeAxis.triggerCachedEvents()}catch(e){this._handleException(e,"zoom")}},fitTimeAreaIntoView:function(e,t,i){"use strict";try{var a=this;w.assertDateOrNull(e,"",0),w.assertDateOrNull(t,"",1),(!a._temporaryMarkMinimumDate||(new Date).getTime()>a._temporaryMarkMinimumDate)&&(a._temporaryMarkVisible=void 0);var o=n.Deferred(),s=a._timeAxis.timeAreaViewWidth(),l=R.timeUnitToSeconds(a._timeAxis.baseTimeUnit());if((!e||e.getTime()<a._timeAxis.actualStart().getTime())&&(e=a._timeAxis.actualStart()),(!t||t.getTime()>a._timeAxis.actualEnd().getTime())&&(t=a._timeAxis.actualEnd()),e.getTime()<t.getTime()){var c=C.calculateWorkingTime(a._timeAxis.collapseCalendar(),t,e);if(!c)return;var d=s/(c/l/1e3),m=this._timeAxis.actualBaseTimeUnitWidth(),u=this._timeAxis.timeAreaViewScrollOffset();if(d===m)return void a.scrollTimeAreaViewToDate(e,!0);a._timeAxis.cacheEvents(),a._timeAxis.baseTimeUnitWidth(d);var h=a._timeAxis.convertDateToX(e);a._timeAxis.baseTimeUnitWidth(m),a._PE_SetTimeAreaViewScrollOffset(u);var p=function(){a._timeAxis.cacheEvents(),a._timeAxis.baseTimeUnitWidth(d),a._PE_SetTimeAreaViewScrollOffset(h),a._timeAxis.setFittedTimeAreaViewStartAndEnd(e,t),a._timeAxis.triggerCachedEvents(),o.resolve()};i?p():r.select(this).transition().duration(a._timeAreaTransitionDuration).ease(r.easeLinear?r.easeLinear:"linear").tween("fitTimeAreaIntoView",(function(){var e=r.interpolate(m,d);return function(t){var i=e(t);a._timeAxis.cacheEvents(),a._timeAxis.baseTimeUnitWidth(i);var n=Math.max(0,(m-i)/(m-d));a._PE_SetTimeAreaViewScrollOffset(u+(h-u)*n),a._timeAxis.triggerCachedEvents()}}))[r.timeFormat?"on":"each"]("end",p)}else o.reject()}catch(e){o.reject(),this._handleException(e,"fitTimeAreaIntoView")}return o.promise()},scrollTimeAreaViewToDate:function(e,t,i){"use strict";var a=n.Deferred();try{var o=this;w.assertDateOrNull(e,"",0),o._scrollingFinished=!1;var s=this._timeAxis.timeAreaViewScrollOffset(),l=this._timeAxis.convertDateToX(e)-(t?0:this._timeAxis.timeAreaViewWidth()*this.options.scrollToViewOffsetPercentage/100);l<0&&(l=0),i?(o._PE_SetTimeAreaViewScrollOffset(l),o._scrollingFinished=!0,a.resolve()):r.select(this).transition().duration(o._timeAreaTransitionDuration).tween("text",(function(){var e=r.interpolateRound(s,l);return function(t){o._PE_SetTimeAreaViewScrollOffset(e(t))}}))[r.timeFormat?"on":"each"]("end",(function(){o._scrollingFinished=!0,a.resolve()}))}catch(e){a.reject(),this._handleException(e,"scrollTimeAreaViewToDate")}return a.promise()},_collapseCalendarChanged:function(){"use strict";var e=this;null!=this.options.rowItemsRoot&&e.invalidateAllRows();var t=Math.floor(e._timeAxis.timeAreaViewWidth()/2),i=e._timeAxis.convertXToDate(Math.round(e._timeAxis.timeAreaViewScrollOffset())+t);e._timeAxis.collapseCalendar(e.options.collapseCalendar);var a=e._timeAxis.convertDateToX(i)-t;Math.abs(e._timeAxis.timeAreaViewScrollOffset()-a)>1&&e._PE_SetTimeAreaViewScrollOffset(a),e._updateDateLineGrids(),e._bodyChanged(pt.TimeAxisChanged)},eventPointToTimeArea:function(e){"use strict";var t,i=this;if(r.mouse){var a=r.event;e&&(r.event=e),t=r.mouse(i._svgRootD3.node()),r.event=a}else t=r.pointer(e,i._svgRootD3.node());if(t[1]>=i._actualBodyViewTop(Y)&&t[1]<i._actualInnerBodyViewBottom(z)&&t[0]>=i._actualLayoutColumnLeft(U)&&t[0]<i._actualInnerLayoutColumnRight(U)){var n=t[0]-i._actualLayoutColumnLeft(U)+i._timeAxis.timeAreaViewScrollOffset(),o=i._timeAxis.convertXToDate(n,!1,!0);return{pageX:t[0],x:n,date:o,y:t[1]-i._actualTitleHeight(J)}}return null},pageXToTimeAxisX:function(e){"use strict";return(e-this.element[0].getBoundingClientRect().left)/this.options.visualZoomFactor-this._actualLayoutColumnLeft(U)+this._timeAxis.timeAreaViewScrollOffset()},timeAxisXToPageX:function(e){"use strict";return e*this.options.visualZoomFactor+this._actualLayoutColumnLeft(U)-this._timeAxis.timeAreaViewScrollOffset()+this.element[0].getBoundingClientRect().left},pageXToDate:function(e){return this._timeAxis.convertXToDate(this.pageXToTimeAxisX(e),!1,!0)},dateToPageX:function(e){"use strict";return this._timeAxis.convertDateToX(e)+this._actualLayoutColumnLeft(U)-this._timeAxis.timeAreaViewScrollOffset()+this.element[0].getBoundingClientRect().left},isInInteraction:function(){"use strict";try{return this._super()||this._barDragging.isInitiated()||!!this._temporaryTimeAreaViewScrollOffsetForBarSelection}catch(e){return this._handleException(e,"isInInteraction"),!1}},isInPinchZoomInteraction:function(){"use strict";try{return!!this._pinchStartTime}catch(e){return this._handleException(e,"isInPinchZoomInteraction"),!1}},_PE_CancelInteraction:function(){"use strict";this._super(),this._barDragging.isInitiated()?this._barDragging.terminate(void 0,!0):this._temporaryTimeAreaViewScrollOffsetForBarSelection&&this._finishBarSelectionRectangle(void 0,!0)},getTimeItem:function(e){"use strict";try{w.assertNotNull(e,"",0);var t=r.select(e).datum();return t?t.item:void 0}catch(e){this._handleException(e,"getTimeItem")}},determineTimeItemExtent:function(e,t){"use strict";try{w.assertNotNull(e,"",0);var i=this,a=i._getDataItem(e,i._timeDataItemsMap);if(a)return a?i._determineTimeDataItemExtent(a,t):void 0}catch(e){this._handleException(e,"determineTimeItemExtent")}},getRowItem:function(e){"use strict";try{w.assertNotNull(e,"",0);var t=this;if(e instanceof Element)return void 0===(i=t._super(e))?(i=r.select(n(e).closest("."+ee+",."+Ye)[0]).data()[0])?i.item:void 0:i;var i,a=t._getDataItem(e,t._timeDataItemsMap,t._unusedTimeDataItemsMap);return(i=a?a.rowDataItem:void 0)?i.item:void 0}catch(e){this._handleException(e,"getRowItem")}},getVisibleRowItem:function(e){"use strict";try{w.assertNotNull(e,"",0);var t=this,i=t._getDataItem(e,t._timeDataItemsMap,t._unusedTimeDataItemsMap),a=i&&i.rowDataItem?i.rowDataItem.visibleRowDataItem:void 0;return a?a.item:void 0}catch(e){this._handleException(e,"getVisibleRowItem")}},disposeUnusedItems:function(){"use strict";try{var e=this;e._super(),e._unusedTimeDataItemsMap={},Object.keys(e._unusedLinkDataItemsMap).forEach((function(t){var i=e._unusedLinkDataItemsMap[t];i.sourceTimeDataItem&&"linkCounter"in i.sourceTimeDataItem&&i.sourceTimeDataItem.linkCounter--,i.targetTimeDataItem&&"linkCounter"in i.targetTimeDataItem&&i.targetTimeDataItem.linkCounter--})),e._unusedLinkDataItemsMap={}}catch(e){this._handleException(e,"disposeUnusedItems")}},scrollToItem:function(e,t,i,a,o){"use strict";try{w.assertNotNull(e,"",0);var s=this,l=s._super(e,t,i,a,o);if(!l){var c,d;"string"==typeof t&&(c=(t=t.split(",")).indexOf("left")>=0?"left":t.indexOf("hcenter")>=0?"center":t.indexOf("right")>=0?"right":void 0,d=t.indexOf("top")>=0?"top":t.indexOf("vcenter")>=0?"center":t.indexOf("bottom")>=0?"bottom":void 0,t=void 0);var m=s._getDataItem(e,s._timeDataItemsMap);if(!m)throw Error("Item not found");if(m.parentTimeDataItem&&(m=m.parentTimeDataItem),!s._isTimeDataItemVisible(m)&&s._canTimeDataItemBeVisible(m)){var u,h=[];for(u=m.rowDataItem;u;u=u.parentRowDataItem)h.unshift(u);h.shift(),h.every((function(e,t){var i=m.rowDataItem.isLeaf&&t===u.length-2;return!(i?e.areLeavesCollapsed:e.isCollapsed)||(s._expandOrCollapseRow(e,!1,!1,i),!s._isTimeDataItemVisible(m))}))}var p=m.rowDataItem.visibleRowDataItem;p.virtualizationStatus<=gt&&s._createRow(p,p,pt.ScrollToRow);var _=s._getBodyAreaIndex(p.item),f=[],g=[],T=s._determineTimeDataItemExtent(m);if(null==a||a){if(d||null!=t||(p.oldY+T.bottom<s._layoutRows[_].scrollStart()?d="top":p.oldY+T.constraintTop>s._layoutRows[_].scrollStart()+s._layoutRows[_].innerViewExtent()&&(d="bottom")),d){var D=T.bottom-T.constraintTop;t="top"===d?-s.determineActualRowMargins().top:"center"===d?(s.determineActualRowMargins().sum-(s._layoutRows[_].innerViewExtent()-D))/2:"bottom"===d?s.determineActualRowMargins().bottom-(s._layoutRows[_].innerViewExtent()-D):void 0}null!=t&&(f[_]=Math.max((p.newY||p.oldY)+(m.newY||m.oldY)+t+T.constraintTop,0))}if(null==i||i){t="left"===c?T.left-10:"right"===c?T.right-s._currentTimeAreaViewWidth+10:(T.right+T.left)/2-s._currentTimeAreaViewWidth/2;var v=s._currentTimeAreaViewScrollOffset>T.right,y=s._currentTimeAreaViewScrollOffset+s._currentTimeAreaViewWidth<T.left;(c||v||y)&&(g[U]=Math.max(t,0))}var S=n.Deferred();if(l=S.promise(),o){var b=s._getScrollOffsets(U,_);void 0===g[U]&&(g[U]=b.horScrollOffset),void 0===f[_]&&(f[_]=b.verScrollOffset);var I={horScrollOffset:g[U],verScrollOffset:f[_]},A=["horScrollOffset","verScrollOffset"],E=Math.abs(I.horScrollOffset-b.horScrollOffset)>Math.abs(I.verScrollOffset-b.verScrollOffset)?0:1,R=(I[A[1-E]]-b[A[1-E]])/(I[A[E]]-b[A[E]]);r.select(s.element[0]).transition().duration(s.options.transitionDuration).tween("scrollToItem",(function(){var e=r.interpolate(b[A[E]],I[A[E]]);return function(t){if(E){var i=f[_]=Math.floor(e(t));R&&isFinite(R)&&(g[U]=Math.floor(i-b[A[E]]*R+b[A[1-E]]))}else{var a=g[U]=Math.floor(e(t));R&&isFinite(R)&&(f[_]=Math.floor(a-b[A[E]]*R+b[A[1-E]]))}s._scrollTo(g,f)}}))[r.timeFormat?"on":"each"]("end",(function(){S.resolve()}))}else s._scrollTo(g,f),S.resolve()}return l}catch(e){this._handleException(e,"scrollToItem")}},getItemBoundingRect:function(e){"use strict";try{w.assertNotNull(e,"",0);var t=this,i=t._super(e);if(i)return i;var a=t._getDataItem(e,t._timeDataItemsMap);if(a&&t._isTimeDataItemVisible(a)){var n=t._determineTimeDataItemExtent(a);return{xOffset:0,yOffset:n.top,left:n.outerLeft,right:n.outerRight,width:n.outerRight-n.outerLeft,top:a.newY+a.rowDataItem.visibleRowDataItem.newY+n.top,bottom:a.newY+a.rowDataItem.visibleRowDataItem.newY+n.bottom,height:n.bottom-n.top}}}catch(e){this._handleException(e,"getItemBoundingRect")}return null},getElementOfItem:function(e,t){"use strict";try{w.assertNotNull(e,"",0);var i=this,a=!0===t||1===t,n=i._getDataItem(e,i._rowDataItemsMap);if(n)return 2===t?r.select(n.foregroundRowElem).select("."+i.NXXXXX.TABLE_ROW_CLASS).node():a?n.backgroundRowElem:n.foregroundRowElem;if(n=i._getDataItem(e,i._timeDataItemsMap))return a?n.backgroundElem:n.elem;if(n=i._getDataItem(e,i._linkDataItemsMap))return 2===t?n.hotRegionElem:n.elem}catch(e){this._handleException(e,"getElementOfItem")}},invalidateRow:function(e,t,i){"use strict";this._PE_InvalidateRow(e,{barsChangedFlag:t,childRowsChangedFlag:i})},calculateInvalidSubRowIndexesOfBarsInRows:function(){"use strict";try{var e=this;Object.keys(e._invalidRowDataItemIDsForSubRowIndexesMap).forEach((function(t){var i=e._rowDataItemsMap[t];i&&(e._calculateSubRowIndexesOfBarsInRow(i),delete i.totalHeight)})),e._invalidRowDataItemIDsForSubRowIndexesMap={}}catch(e){this._handleException(e,"calculateInvalidSubRowIndexesOfBarsInRows")}},_handleRowInvalidationAtLast:function(e,t,i,a){"use strict";this._super(e,t,i,a),this.options.automaticCalculationOfSubRowIndexesOfBarsInRow?this._calculateSubRowIndexesOfBarsInRow(e):this._invalidRowDataItemIDsForSubRowIndexesMap[e.id]=!0,(t||i)&&delete e.worldViewBarCacheMap},_PE_InvalidateRowsForTreeViewUpdate:function(){return{barsChangedFlag:!1,childRowsChangedFlag:!0}},update:function(){"use strict";try{this._super(),this.calculateInvalidSubRowIndexesOfBarsInRows(),this._bodyChanged(pt.TimeItemsChanged)}catch(e){this._handleException(e,"update")}},_getCurrentlyDisplayedElementsInRow:function(e){"use strict";return e.isCollapsed?this._getCollapsedDisplayedElementsForRowItem(e.item):this._getExpandedDisplayedElementsForRowItem(e.item)},_getCollapsedDisplayedElementsForRowItem:function(e){"use strict";var t=e.collapsedDisplayedElements;if(null==t){var i=this._getDataItem(e,this._rowDataItemsMap,this._unusedRowDataItemsMap);t=i&&i.isLeaf?this.options.defaultLeafRowDisplayedElements:this.options.defaultRowCollapsedDisplayedElements}return+t||0},_getExpandedDisplayedElementsForRowItem:function(e){"use strict";var t=e.expandedDisplayedElements;if(null==t){var i=this._getDataItem(e,this._rowDataItemsMap,this._unusedRowDataItemsMap);t=i&&i.isLeaf?this.options.defaultLeafRowDisplayedElements:this.options.defaultRowExpandedDisplayedElements}return(+t||0)&~tt.BarsOfCollapsedChildRows},_determineVisibleTimeDataItemsInRow:function(e){"use strict";var t=this,i=[];return function e(i,a,n,r){Array.isArray(i.item.timeItems)&&t._doDetermineTimeDataItems(i.item.timeItems,a,!0),i.isLeaf||["leafRowDataItems","childRowDataItems"].forEach((function(o,s){(s?n:r)&&t._getCurrentlyDisplayedElementsInRow(i)&(s?tt.BarsOfCollapsedChildRows:tt.BarsOfCollapsedLeafRows)&&Array.isArray(i[o])&&i[o].forEach((function(t){t&&e(t,a,n,r)}))}))}(e,i,e.isCollapsed,e.areLeavesCollapsed),i},_determineTimeDataItems:function(e,t){"use strict";var i=[];return this._doDetermineTimeDataItems(e,i,t),i},_doDetermineTimeDataItems:function(e,t,i){"use strict";var a=this;e.forEach((function(e){var n=a._getDataItem(e,a._timeDataItemsMap);if(n){var r="twice"===n.item.zOrder;r||t.push(n),i&&Array.isArray(e.childTimeItems)&&a._doDetermineTimeDataItems(e.childTimeItems,t,!1),r&&t.push(n)}}))},_determineSuperTimeDataItem:function(e){"use strict";for(var t=e;t.parentTimeDataItem;)t=t.parentTimeDataItem;return t},_determineLeafTimeDataItems:function(e){"use strict";var t=[];return this._doDetermineLeafTimeDataItems(e,t),t},_doDetermineLeafTimeDataItems:function(e,t){"use strict";var i=this;e.item&&Array.isArray(e.item.childTimeItems)?e.item.childTimeItems.forEach((function(e){var a=i._getDataItem(e,i._timeDataItemsMap);a&&i._doDetermineLeafTimeDataItems(a,t)})):t.push(e)},_determineTimeRange:function(e,t,i,a){"use strict";var n=!!t;return t?(t.constraintStart||(t.constraintStart=t.outerStart),t.constraintEnd||(t.constraintEnd=t.outerEnd)):t={start:void 0,outerStart:void 0,end:void 0,outerEnd:void 0},this._doDetermineTimeRangeRecursively(e,t,i,a),t.start||n?t:void 0},_doDetermineTimeRangeRecursively:function(e,t,i,a){"use strict";var n=this;if(!a||e.item&&!1!==e.item.markable)if(e.item&&!e.item.barShape&&Array.isArray(e.item.childTimeItems)&&e.item.childTimeItems.length)e.item.childTimeItems.forEach((function(e){var r=n._getDataItem(e,n._timeDataItemsMap);n._doDetermineTimeRangeRecursively(r,t,i,a)}));else if(!i||!i[e.id]){var r=n._timeAxis,o=n._getActualBarShape(e.timeDataItem||e),s=o===nt.None?at.None:n._getActualBarType(e,!e.item),l=e.item?e.item:e,c=s&it.Start&&n._getBindingPropertyInfosAndValue(l,"start","date").value||r.actualStart(),d=s&it.End&&n._getBindingPropertyInfosAndValue(l,"end","date").value||c;if(s&it.Duration){var m=n._getBindingPropertyInfosAndValue(l,"duration","number").value||0,u=e.item.calendar||e.rowDataItem&&e.rowDataItem.item.calendar||n.options.defaultCalendar;s&it.Start?d=C.addWorkingTime(u,c,m)||c||r.actualStart():c=C.addWorkingTime(u,d,-m)||r.actualStart()}if(n._barDragging.isInitiated()&&!n._barDragging.isDropped())if((e.parentTimeDataItem||e).isCurrentlyDraggedCoupled){u=e.item.calendar||e.rowDataItem&&e.rowDataItem.item.calendar||n.options.defaultCalendar;var h=n._barDragging.modifyStartEndForCoupledTimeItems(u,c,d);c=h.start,d=h.end}var p,_=c,f=d;if(c&&d)(p=n._barFactory.getBarOffsets(n._extendCallbackArgs({barShapeId:o,item:e.item,rowItem:e.rowDataItem&&e.rowDataItem.item})))&&(p.startOffset&&(_=r.convertXToDate(r.convertDateToX(c)-p.startOffset)),p.endOffset&&(f=r.convertXToDate(r.convertDateToX(d)+p.endOffset))),(p=n._handleOffsetsOnStartAndEnd(e.timeDataItem||e,c,d)).outerStart&&(_=p.outerStart),p.outerEnd&&(f=p.outerEnd);s!==at.None&&(_&&(!t.outerStart||t.outerStart.getTime()>_.getTime())&&(t.outerStart=_,(!t.constraintStart||t.constraintStart.getTime()>_.getTime())&&(t.constraintStart=_)),c&&(!t.start||t.start.getTime()>c.getTime())&&(t.start=c),f&&(!t.outerEnd||t.outerEnd.getTime()<f.getTime())&&(t.outerEnd=f,(!t.constraintEnd||t.constraintEnd.getTime()<f.getTime())&&(t.constraintEnd=f)),d&&(!t.end||t.end.getTime()<d.getTime())&&(t.end=d),!e.rowDataItem||e.rowDataItem.isHidden||e.timeDataItem||(Array.isArray(e.item.constraints)&&e.item.constraints.length&&e.item.constraints.forEach((function(e){if(e.date instanceof Date){var i=e.date.getTime();t.constraintStart.getTime()>i?t.constraintStart=e.date:t.constraintEnd.getTime()<i&&(t.constraintEnd=e.date)}})),e.item.predictedEnd instanceof Date&&t.constraintEnd.getTime()<e.item.predictedEnd.getTime()&&(t.constraintEnd=e.item.predictedEnd)))}},_handleOffsetsOnStartAndEnd:function(e,t,i){"use strict";var a,n,r=this._timeAxis,o=+e.item.startOffsetInPixels;return o&&(o>0?a=r.convertXToDate(r.convertDateToX(t)-o):n=r.convertXToDate(Math.max(r.convertDateToX(i),r.convertDateToX(t)-o))),(o=+e.item.endOffsetInPixels)&&(o>0?n=r.convertXToDate(r.convertDateToX(i)+o):a=r.convertXToDate(Math.min(r.convertDateToX(t),r.convertDateToX(i)+o))),{outerStart:a,outerEnd:n}},_determineTimeDataItemExtent:function(e,t,i,a){"use strict";var n=this;if(t=n._determineTimeRange(e,t,i,a)){t.left=n._timeAxis.convertDateToX(t.start),t.right=n._timeAxis.convertDateToX(t.end),t.outerLeft=n._timeAxis.convertDateToX(t.outerStart),t.outerRight=n._timeAxis.convertDateToX(t.outerEnd),t.top=Number.MAX_VALUE,t.bottom=Number.MIN_VALUE,t.constraintLeft=n._timeAxis.convertDateToX(t.constraintStart),t.constraintRight=n._timeAxis.convertDateToX(t.constraintEnd),t.constraintTop=Number.MAX_VALUE;var r=n.options.constraintSymbolsInMargin?0:n.options.detailedConstraintSymbolsEnabled?n.options.constraintSymbolHeight+6:n.options.constraintSymbolHeight;if(n._determineLeafTimeDataItems(e.timeDataItem||e).forEach((function(i){if((!a||!1!==i.item.markable)&&n._getActualBarType(i)!==at.None&&n._isTimeDataItemVisible(i)){var o=i.item.barTopOffset||0,s=n._getActualBarHeight(i);t.top>o&&(t.top=o),t.bottom<o+s&&(t.bottom=o+s),e.rowDataItem&&!e.rowDataItem.isHidden&&!e.timeDataItem&&Array.isArray(i.item.constraints)&&i.item.constraints.length&&(o-=r,t.constraintTop>o&&(t.constraintTop=o))}})),t.top!==Number.MAX_VALUE&&e.rowDataItem&&!e.rowDataItem.isHidden&&!e.timeDataItem&&Array.isArray(e.item.constraints)&&e.item.constraints.length&&(t.constraintTop=t.top-r),t.top===Number.MAX_VALUE||(e.timeDataItem||e).item.barShape){var o=(e.timeDataItem||e).item.barTopOffset||0,s=n._getActualBarHeight(e.timeDataItem||e);t.top=Math.min(o,t.top),t.bottom=Math.max(o+s,t.bottom)}t.constraintTop===Number.MAX_VALUE&&(t.constraintTop=t.top)}return t},_rowItemsRootChanged_ClearAllSelections:function(){"use strict";this._super(),this._changeTimeItemSelection([])},_rowItemsRootChanged_ClearAdditionalUsages:function(e){"use strict";var t=e.calendarCacheID;void 0!==t&&this._calendarGridDataCache[t]&&0==--this._calendarGridDataCache[t].usageCount&&delete this._calendarGridDataCache[t],delete e.calendarCacheID},_rowItemsRootChanged_prepareUpdate:function(e,t){"use strict";var i=this;t.oldTimeDataItemIDsSet={},Object.keys(i._timeDataItemsMap).forEach((function(e){t.oldTimeDataItemIDsSet[e]=!0})),e.forEach((function(e){var a=i._rowItemsRootChanged_getRowDataItemWithChildren(e,t);a.timeDataItems&&(a.timeDataItems.length=0),Array.isArray(e.timeItems)&&e.timeItems.forEach((function(e){i._createTimeDataItemAndChildrenRecursively(e,a,t.oldTimeDataItemIDsSet)}))}))},_rowItemsRootChanged_update:function(e){"use strict";var t=this;(e.rowDataItems.forEach((function(e){t._doCalculateSummaryTimeItemsInRow(e,!0,!1)})),Object.keys(e.oldTimeDataItemIDsSet).forEach((function(e){var i=t._timeDataItemsMap[e];delete i.parentTimeDataItem,delete i.rowDataItem,i&&!t.options.autoDisposeOfUnusedItems&&(t._unusedTimeDataItemsMap[e]=i),delete t._timeDataItemsMap[e]})),t.options.rowItemsRoot)&&t._determineRowDataItems(!0).forEach((function(e){t._calculateSubRowIndexesOfBarsInRow(e)}));t._removeAllRowDateLines(),t._super(e)},_linkItemsChanged:function(){"use strict";var e=this;e._temporaryMarkVisible=void 0;var t={},i={},a={};if(Object.keys(e._linkDataItemsMap).forEach((function(i){var n=e._linkDataItemsMap[i];t[i]=!0,n.sourceTimeDataItem&&(void 0===n.sourceTimeDataItem.oldLinkCounter&&(n.sourceTimeDataItem.oldLinkCounter=n.sourceTimeDataItem.linkCounter),n.sourceTimeDataItem.linkCounter--,a[n.sourceTimeDataItem.id]=!0),n.targetTimeDataItem&&(void 0===n.targetTimeDataItem.oldLinkCounter&&(n.targetTimeDataItem.oldLinkCounter=n.targetTimeDataItem.linkCounter),n.targetTimeDataItem.linkCounter--,a[n.targetTimeDataItem.id]=!0)})),e.options.linkItems){for(var r={},o=0;o<e.options.linkItems.length;o++){var s,l=e.options.linkItems[o],c=e._getOrCreateDataItem(l,e._linkDataItemsMap,e._unusedLinkDataItemsMap),d=c.dataItem,m=d.id;if(c.isCreated||d.version++,d.sourceTimeDataItem=l.sourceTimeItem?e._getDataItem(l.sourceTimeItem,e._timeDataItemsMap):void 0,d.targetTimeDataItem=l.targetTimeItem?e._getDataItem(l.targetTimeItem,e._timeDataItemsMap):void 0,d.sourceTimeDataItem)if(0!=d.sourceTimeDataItem.linkCounter++||a[d.sourceTimeDataItem.id]||(r[d.sourceTimeDataItem.id]=d.sourceTimeDataItem),d.sourceTimeDataItem.rowDataItem)i[(s=d.sourceTimeDataItem.rowDataItem.visibleRowDataItem).id]=s;if(d.targetTimeDataItem)if(0!=d.targetTimeDataItem.linkCounter++||a[d.targetTimeDataItem.id]||(r[d.targetTimeDataItem.id]=d.targetTimeDataItem),d.targetTimeDataItem.rowDataItem)i[(s=d.targetTimeDataItem.rowDataItem.visibleRowDataItem).id]=s;c.isCreated?e._linkDataItemsMap[m]=d:(delete e._unusedLinkDataItemsMap[m],e._linkDataItemsMap[m]=d,delete t[m])}e.calculateInvalidSubRowIndexesOfBarsInRows(),e.options.virtualized&&n.each(r,(function(t,i){i.elem||e._positionBar(null,i,!0)}))}Object.keys(t).forEach((function(t){var i=e._linkDataItemsMap[t];i&&!e.options.autoDisposeOfUnusedItems&&(e._unusedLinkDataItemsMap[t]=i),delete e._linkDataItemsMap[t]}))},_createTimeDataItemAndChildrenRecursively:function(e,t,i,a){"use strict";var n=this,r=n._getOrCreateDataItem(e,n._timeDataItemsMap,n._unusedTimeDataItemsMap),o=r.dataItem;if(o.parentTimeDataItem=a,r.isCreated)o.linkCounter=0;else{o.rowDataItem&&o.rowDataItem!==t&&o.rowDataItem.timeDataItems.splice(o.rowDataItem.timeDataItems.indexOf(o),1);var s=o.id;o.version++,delete n._unusedTimeDataItemsMap[s],n._timeDataItemsMap[s]=o,i&&delete i[s]}return t.timeDataItems||(t.timeDataItems=[]),t.timeDataItems.push(o),o.rowDataItem=t,Array.isArray(e.childTimeItems)&&e.childTimeItems.forEach((function(e){n._createTimeDataItemAndChildrenRecursively(e,t,i,o)})),o},_getActualBarType:function(e,t){"use strict";t&&(e=e.timeDataItem);var i=e.item.barType;return null==i&&(i=this.options.defaultBarType),null==i&&(i=at.Single),t&&i&it.Duration&&(i=at.StartEnd),i},_getActualBarShape:function(e){"use strict";var t=e.item.barShape;return null==t&&(t=e.rowDataItem.isLeaf?this.options.defaultLeafBarShape:this.options.defaultBarShape),null==t&&(t=nt.Rectangle),this._barFactory.checkBarShapeForBarType(t,this._getActualBarType(e)&~it.Summary)||(t=nt.None),t},_getActualBarHeight:function(e){"use strict";var t=e.item.barHeight;return null==t&&(t=e.rowDataItem.isLeaf?this.options.defaultLeafBarHeight:this.options.barHeight),null==t&&(t=0),t},_getActualBarInteractions:function(e){"use strict";var t=this,i=e.item.start?e.rowDataItem.isLeaf?t.options.forcedLeafBarInteractions:t.options.forcedBarInteractions:rt.None;return null==i&&(i=e.item.barInteractions),null==i&&(i=(e.rowDataItem.isLeaf?t.options.defaultLeafBarInteractions:t.options.defaultBarInteractions)||rt.None),i&y._AllBarInteractions},_registerBindingsForTimeItems:function(e){"use strict";var t=this,i=[];return Array.isArray(e.childTimeItems)&&function e(a){a.childTimeItems.forEach((function(a){t._doRegisterBindingsForTimeItem(a)&&i.push(a),Array.isArray(a.childTimeItems)&&e(a)}))}(e),i.length?i:void 0},_doRegisterBindingsForTimeItem:function(e){"use strict";var t=!1,i=this._getDataItem(e,this._timeDataItemsMap),a=this._getActualBarType(i);return a&it.Start&&(t|=this._registerBindingForItem(e,"start","date")),a&it.End&&(t|=this._registerBindingForItem(e,"end","date")),a&it.Duration&&(t|=this._registerBindingForItem(e,"duration","number")),t},_registerBindingForItem:function(e,t,i){"use strict";var a=this,n=e[t];if(n&&(n instanceof String||"string"==typeof n)){var r=this._determineBindingTargetAndPropertyName(e,n,i);if(r){var o=r.target[this._BINDING_ID_PROPERTY];o||(o=r.target[this._BINDING_ID_PROPERTY]=this._nextBindingItemID++);var s=this._boundTargetInfosMap[o];s||(s={target:r.target,propertyInfosMap:{}},this._boundTargetInfosMap[o]=s);var l=s.propertyInfosMap[r.propertyName];if(!l){var c=r.target[r.propertyName];if(a.options.convertFunc&&r.withConversion){var d=a._extendCallbackArgs({item:r.item,attr:r.itemAttr,value:c});void 0===(c=a.options.convertFunc.call(a,d))&&(c=d.value)}l={value:c,itemInfos:[]},s.propertyInfosMap[r.propertyName]=l}return l.itemInfos.push({item:e,itemPropertyName:t}),!0}}return!1},_determineBindingTargetAndPropertyName:function(e,t,i){"use strict";var n,r=!1;"convert:"===t.substring(0,8)&&(t=t.substring(8),r=!0),"."===t[0]&&(t=t.slice(1)),"_super."===t.substring(0,7)&&(t=t.substring(7),e=(n=this._getDataItem(e,this._timeDataItemsMap))?n.parentTimeDataItem.item:(n=this._getDataItem(e,this._rowDataItemsMap))?n.parentRowDataItem.item:void 0);var o=t.split("."),s=o.pop(),l=e;if(o.forEach((function(e){l&&(l=l[e])})),l&&s&&(r||a(l[s])===i||l[s]instanceof Tt[i]))return{target:l,propertyName:s,item:e,itemAttr:t,withConversion:r}},_getBindingPropertyInfosAndValue:function(e,t,i){"use strict";var n=e[t];if(n&&(n instanceof String||"string"==typeof n)){var r=this._determineBindingTargetAndPropertyName(e,n,i);if(r){var o=r.target[this._BINDING_ID_PROPERTY];if(o){var s=this._boundTargetInfosMap[o];if(s){var l=s.propertyInfosMap[r.propertyName];return{propertyInfos:l,value:l.value}}}if(this.options.convertFunc&&r.withConversion){var c=this._extendCallbackArgs({item:r.item,attr:r.itemAttr,value:r.target[r.propertyName]});void 0===(n=this.options.convertFunc.call(this,c))&&(n=c.value)}else n=r.target[r.propertyName]}}return{propertyInfos:null,value:a(n)===i||n instanceof Tt[i]?n:void 0}},_unregisterAllItems:function(){"use strict";this._boundTargetInfosMap={}},_isBindingActive:function(){"use strict";return!!Object.keys(this._boundTargetInfosMap).length},_onTimescaleContextMenu:function(e){"use strict";var t=this;t.options.onEventFunc&&(t._setBarInteractionCursor(rt.None),t._triggerEvent(t._extendCallbackArgs({sender:"Timescale",eventType:"contextmenu",elem:this,event:e}))),t.options.preventDefaultOnContextMenuEvents&&(e.stopPropagation(),e.preventDefault())},_createTimeAreaRow:function(e,t,i,a,n,r){"use strict";var o=this;if(r)i&&(n===pt.ScrollToRow||n===pt.BeforeRowCollapse||Array.isArray(o.options.linkItems)&&o.options.linkItems.length)&&o._createAllBarsInRow(e,null,a,n,r);else{var s,l=this.convertXToLimitedX(o._timeAxis.timeAreaViewScrollOffset());if(n!==pt.WorldView){var c=t.append("g").attr("class","ngantt-timearea-row ngantt-row-height-dep").attr("transform","translate("+(o._actualLayoutColumnLeft(U)+Ot)+")").attr("clip-path","url(#"+o.NXXXXX.WIDTH_CLIPPATH_ID[U]+this._uniqueID+")");i||c.append("rect").attr("class","ngantt-row-height-dep ngantt-row-background-rect").attr("width",o._timeAxis.timeAreaViewWidth()),s=c.append("g").attr("class",ze).attr("transform","translate("+-l+")"),o.options.timeAreaRowFillFunc&&o.options.timeAreaRowFillFunc.call(o,o._extendCallbackArgs({rowItem:e.item,parentElem:s.node(),isForeground:i,totalHeight:e.totalHeight,oldTotalHeight:null!=e.oldTotalHeight?e.oldTotalHeight:e.totalHeight,mainHeight:o._getRowMainHeight(e),width:o.getCurrentUpperXLimit()-o.getCurrentLowerXLimit()}))}i?(o._createAllBarsInRow(e,s,a,n),r||n===pt.WorldView||o._createDateAreasInRow(e,s,!0,n),o._determineDateAreasForRowInWorldView(e,!0)):(n!==pt.WorldView&&o._createCalendarGridInRow(e,s),n!==pt.Virtualization&&n!==pt.ScrollToRow||o._updateCalendarGridForRow(e,s,!1),o._determineCalendarGridForRowInWorldView(e),r||n===pt.WorldView||o._createDateAreasInRow(e,s,!1,n),o._determineDateAreasForRowInWorldView(e,!1),n!==pt.WorldView&&c.append("line").attr("class","ngantt-separation-line ngantt-level"+e.level).attr("x2",o._timeAxis.timeAreaViewWidth()).attr("y1",It).attr("y2",It).style("visibility",o.options.timeAreaRowSeparationLinesVisible?null:"hidden"))}},_createCalendarGridInRow:function(e,t){"use strict";this._getCurrentlyDisplayedElementsInRow(e)&tt.CalendarGrid&&this.options.calendarGridVisible&&t.append("path").attr("class",ce)},_updateCalendarGridForRow:function(e,t,i,a){"use strict";var n=this,r=t.select(".ngantt-calgrid");if(r.size()){r.attr("d",n._determineCalendarGridPathData(e));var o=e.totalHeight-n._getRowAdditionalHeight(e),s=Ct?"translate("+Ct+")":"";if(i&&(null!=e.oldTotalHeight||a)){var l=a?0:e.oldTotalHeight-(e.oldAdditionalHeight||0);r.attr("transform",s+"scale(1,"+Math.max(l||0,1e-6)+")"),n._cacheTransitionFunction((function(){r.transition().duration(n.options.transitionDuration).attr("transform",s+"scale(1,"+Math.max(o||0,1e-6)+")")}))}else r.attr("transform",s+"scale(1,"+o+")")}},_determineCalendarGridForRowInWorldView:function(){},_determineCalendarGridPathData:function(e){"use strict";var t=this,i=e.item.calendar||t.options.defaultCalendar;if(i){var a,o=t._timeAxis.collapseCalendar(),s=t._timeAxis.convertXToDate(t.getCurrentLowerXLimit()),l=t._timeAxis.convertXToDate(t.getCurrentUpperXLimit()),c=i.timeTypeChangeTimes(),m=i[t._OBJECT_ID_PROPERTY];void 0===m&&(m=i[t._OBJECT_ID_PROPERTY]=t._nextCalendarCacheID++);var u=t._calendarGridDataCache[m];if(u||(u=t._calendarGridDataCache[m]={usageCount:0}),e.calendarCacheID!==m&&(void 0!==e.calendarCacheID&&0==--t._calendarGridDataCache[e.calendarCacheID].usageCount&&delete t._calendarGridDataCache[e.calendarCacheID],e.calendarCacheID=m,u.usageCount++),u.dates===c&&u.collapseCalendar===o&&u.projectStartAsTime===s.getTime()&&u.projectEndAsTime===l.getTime())a=u.reducedDates;else{a=[];for(var h=c.length,p=d.findDateWithinSortedArray(c,s,!1);p<h;p++){var _=c[p];if(a.push(_),_.getTime()>=l)break}if(a.length||a.push(s),a[a.length-1]<l&&a.push(l),o&&a.length>2)for(var f=a.length-1;f>0;f--){_=new Date(a[f].getTime()-1);if(o.determineTimeType(_)===S.NonWorkingTime&&a[f-1]>=o.findStartOfCurrentTimeTypeInterval(_)&&(a.splice(--f,2),a.length<=2))break}delete(u=n.extend(t._calendarGridDataCache[m],{dates:c,collapseCalendar:o,projectStartAsTime:s.getTime(),projectEndAsTime:l.getTime(),reducedDates:a})).pathData}if(u.pathData&&u.baseTimeUnit===t._timeAxis.baseTimeUnit()&&u.baseTimeUnitWidth===t._timeAxis.actualBaseTimeUnitWidth())return u.pathData;var g=i.determineTimeType(a[0])!==S.WorkingTime,T=(r.line?r.line().curve(r.curveStepAfter):r.svg.line().interpolate("step-after")).x((function(e){return t.convertXToLimitedX(t._timeAxis.convertDateToX(e))})).y((function(){return(g=!g)?1:0}))(a);return T=[T,"V1"!==T.substring(T.length-2)?"V1H":"H",T.substring(1,T.indexOf(",")),"Z"].join(""),u.pathData=T,T}return""},_calculateSubRowIndexesOfBarsInRow:function(e,t){"use strict";var i=this;e.isHidden||(e.mainHeight=0,e.subRowCount=0,e.subRowDataItems=[],!1!==e.item.barsPaneVisible&&(i._doCalculateSubRowIndexesOfBarsInRow(e,i._getCurrentlyDisplayedElementsInRow(e)),t&&["leafRowDataItems","childRowDataItems"].forEach((function(a,n){Array.isArray(e[a])&&e[n?"isCollapsed":"areLeavesCollapsed"]&&e[a].forEach((function(e){i._calculateSubRowIndexesOfBarsInRow(e,t)}))}))))},_doCalculateSubRowIndexesOfBarsInRow:function(e,t){"use strict";var i=this,a=i._determineAndSortPositionableTimeDataItemsInRow(e,t);if(a.length){i._doCalculateSubRowIndexesOfBars(e.subRowDataItems,a,t);var n=e.item.maximumSubRowHeight;n>0||(n=i.options.defaultMaximumSubRowHeight),null==n&&(n=Number.POSITIVE_INFINITY),e.subRowCount=e.subRowDataItems.length;var r=0;e.subRowDataItems.forEach((function(t,a){a===e.subRowCount-1&&(n=Number.POSITIVE_INFINITY),t.offsetY=r;var o=(t.maximumY===Number.MIN_VALUE?0:t.maximumY)-(t.minimumY===Number.MAX_VALUE?0:t.minimumY);r+=Math.min(o,n)+i.options.subRowDistance}));var o=i.determineActualRowMargins(),s=e.isLeaf?i.options.defaultLeafRowMainHeight:i.options.defaultRowMainHeight;e.mainHeight=Math.max(e.subRowCount?o.sum+Math.ceil(r)-i.options.subRowDistance:0,s)}var l=e.item.maximumHeight;if(l>0||(l=i.options.defaultMaximumRowHeight),e.mainHeightLimited=l>0&&e.mainHeight>l){var c=(e.mainHeight-l)/2;e.mainHeight=l,e.subRowDataItems.forEach((function(e){e.offsetY-=c}))}},_doCalculateSubRowIndexesOfBars:function(e,t,i,a){"use strict";var n=this;t.forEach((function(t){if(a?n._isTimeDataItemVisible(t)&&0!==t.rowDataItem.item.totalHeight:n._isTimeDataItemVisible(t,!0)){var r=n._determineTimeRange(t);if(t.item.barType&at.SingleRespectedByOptimization&&r.constraintStart.getTime()===r.constraintEnd.getTime()&&(r.constraintEnd=new Date(r.constraintEnd.getTime()+1e3)),r){var o=null,s=-1;e.some((function(e){return s++,o=e,!(i&tt.Optimized&&e.timeSpans.isTimeSpanAllocated(r.constraintStart,r.constraintEnd))}))||(o={timeSpans:new g(!1),minimumY:Number.MAX_VALUE,maximumY:Number.MIN_VALUE,offsetY:0},e.push(o),s++),o.timeSpans.allocateTimeSpan(r.constraintStart,r.constraintEnd,!0),t.subRowIndex=s;var l=n._determineTimeDataItemExtent(t);l&&(o.minimumY>l.constraintTop&&(o.minimumY=l.constraintTop),o.maximumY<l.bottom&&(o.maximumY=l.bottom),n._determineLeafTimeDataItems(t).forEach((function(e){e.subRowIndex=s})))}}}))},_doCalculateSummaryTimeItemsInRow:function(e,t,i){"use strict";var a=this;(t||e.summariesExistent)&&(e.summariesExistent=!1,Array.isArray(e.item.timeItems)&&e.item.timeItems.forEach((function(t){var n=a._getDataItem(t,a._timeDataItemsMap);n&&a._getActualBarType(n)&it.Summary&&(a._calculateSummaryDates(n,i),e.summariesExistent=!0)})))},_calculateSummaryDates:function(e,t){"use strict";var i=e.item.start,a=e.item.end;e.item.start=e.item.end=void 0,this._doCalculateSummaryDatesRecursively(e),t&&e.rowDataItem&&(e.item.start!==i||e.item.end!==a)&&this._doInvalidateRow(e.rowDataItem,{barsChangedFlag:!1,childRowsChangedFlag:!1})},_doCalculateSummaryDatesRecursively:function(e,t){"use strict";var i=this,a=!1;if(t){if(Array.isArray(t.item.timeItems)){var n=t.item.calendar||i.options.defaultCalendar;t.item.timeItems.forEach((function(t){var r,o,s=i._getDataItem(t,i._timeDataItemsMap);if(s){var l=!1,c=i._getActualBarType(s);switch(c&it.Summary?(a=!0,c&=~it.Summary):(i._registerBindingsForTimeItems(t),l=!0),c){case at.StartEnd:r=i._getBindingPropertyInfosAndValue(t,"start","date").value,o=i._getBindingPropertyInfosAndValue(t,"end","date").value;break;case at.StartDuration:(r=i._getBindingPropertyInfosAndValue(t,"start","date").value)&&(o=C.addWorkingTime(n,r,i._getBindingPropertyInfosAndValue(t,"duration","number").value||0));break;case at.EndDuration:(o=i._getBindingPropertyInfosAndValue(t,"end","date").value)&&(r=C.addWorkingTime(n,o,-i._getBindingPropertyInfosAndValue(t,"duration","number").value||0))}if(r){var d=e.item;(!d.start||d.start>r)&&(d.start=r),(!d.end||d.end<o)&&(d.end=o)}l&&i._unregisterAllItems()}}))}}else if(!(t=e.rowDataItem))return;a||["leafRowDataItems","childRowDataItems"].forEach((function(a){Array.isArray(t[a])&&t[a].forEach((function(t){t&&i._doCalculateSummaryDatesRecursively(e,t)}))}))},_determinePositionableTimeDataItemsInRow:function(e,t,i){"use strict";var a=this,n=[];return t&tt.Bars&&Array.isArray(e.item.timeItems)&&a._determineTimeDataItems(e.item.timeItems,!1).forEach((function(e){a._isTimeDataItemVisible(e)&&n.push(e)})),["leafRowDataItems","childRowDataItems"].forEach((function(i,r){t&(r?tt.BarsOfCollapsedChildRows:tt.BarsOfCollapsedLeafRows)&&e[r?"isCollapsed":"areLeavesCollapsed"]&&Array.isArray(e[i])&&e[i].forEach((function(e){a._findTimeDataItemsForCollapsedChildRowsRecursively(e,n)}))})),i||(i={}),n.forEach((function(e,t){(i[e.id]=a._determineTimeRange(e)||{})._index=t})),n.filter((function(e){return i[e.id].start}))},_determineAndSortPositionableTimeDataItemsInRow:function(e,t){"use strict";var i={};return this._determinePositionableTimeDataItemsInRow(e,t,i).sort((function(e,t){var a=i[e.id],n=i[t.id],r=a.outerStart.getTime()-n.outerStart.getTime();return r||(r=a.outerEnd.getTime()-n.outerEnd.getTime()),r||a._index-n._index}))},_createAllBarsInRow:function(e,t,i,a,n){"use strict";var o=this,s=o._getCurrentlyDisplayedElementsInRow(e);!1===e.item.barsPaneVisible&&(s&=~(tt.Bars|tt.BarsOfCollapsedChildRows|tt.BarsOfCollapsedLeafRows));var l,c=o._determineAndSortPositionableTimeDataItemsInRow(e,s);if(o._worldViewDivJQ&&(e.worldViewBarCacheMap={}),o._determineTimeDataItems(c.map((function(e){return e.item})),!0).forEach((function(i){if(a!==pt.WorldView){var s=t;o.options.selectedItemsShownHighlighted&&o._isTimeDataItemSelected(i)&&(s=(l=r.select(o._getOrCreateSpecialRowElem(e,!0,1))).select(".ngantt-timearea-row-contents"),i.highlighted=!0)}o._createBar(s,i,a,n)})),a!==pt.WorldView&&s&(tt.Bars|tt.BarsOfCollapsedChildRows|tt.BarsOfCollapsedLeafRows)&&!n){var d=[t];l&&d.push(l),d.forEach((function(t){t.selectAll("."+ee+",."+de).each((function(t){var n=r.select(this),s=n.select("."+he),l=(a===pt.RowExpanded||a===pt.RowLeavesExpanded)&&e!==i&&!t.actuallyVisibleInCollapsedRow;if("newX"in t){var c,d="translate("+(o.convertXToLimitedX(t.newX)+Rt)+","+(t.newY+xt)+")",m=d;if(a!==pt.Virtualization&&a!==pt.TimeAxisChanged&&!o._barDragging.isDropped()&&!t.phantomDataItem){if(l||void 0!==t.oldY&&void 0!==e.oldY){var u=0;if(l||(u=t.oldY+t.oldRowY-e.oldY,o._isItemAtTheTop(e.item)||(u-=o._layoutRows[Y].innerViewExtent()),!1===t.oldRowAtTheTop&&(u+=o._layoutRows[Y].innerViewExtent())),(l||u||void 0!==t.oldX)&&(a!==pt.RowCollapsed&&a!==pt.RowLeavesCollapsed||u>0)){var h=o.convertXToLimitedX(void 0!==t.oldX?t.oldX:t.newX);m="translate("+(h+Rt)+","+(u+xt)+")",s.length&&(c="translate("+(o.convertXToLimitedX(t.newX)-o.convertXToLimitedX(h))+")")}}l&&(m+=wt)}n.attr("transform",m);var p=t.phantomDataItem;p&&d===m&&o._barDragging.isDropped()&&(p.newY=t.newY+t.rowDataItem.visibleRowDataItem.newY-p.rowDataItem.visibleRowDataItem.newY,o._cacheTransitionFunction((function(){r.selectAll(p.backgroundElem?[p.backgroundElem,p.elem]:[p.elem]).transition().duration(o.options.transitionDuration).attr("transform","translate("+(o.convertXToLimitedX(p.newX)+Rt)+","+(p.newY+xt)+")")}))),d!==m?o._cacheTransitionFunction((function(){if(n.transition().duration(o.options.transitionDuration).attr("transform",d)[r.timeFormat?"on":"each"]("end",(function(){delete t.actuallyVisibleInCollapsedRow})),!p&&!l&&o.options.barSelectionWithFrames&&o.options.barSelectionFramesShownWithHigherZOrder&&t.selectedFrameElem){var e=o._determineSelectionFrameExtent(t);if(e&&(r.select(t.selectedFrameElem).transition().duration(o.options.transitionDuration).attr("transform","translate("+e.xoffset+")").attr("x",e.xplus).attr("y",e.yplus).attr("width",e.wplus),t.selectedFrameMaskElem)){var i=r.select(t.selectedFrameMaskElem);(i=i.transition().duration(o.options.transitionDuration)).select("rect:nth-child(1)").attr("x",e.xplus-St).attr("y",e.yplus-St).attr("width",e.wplus+200),i.select("rect:nth-child(2)").attr("x",e.x).attr("y",e.y).attr("width",e.w)}}p&&o._barDragging.isDropped()&&(p.newY=t.newY+t.rowDataItem.visibleRowDataItem.newY-p.rowDataItem.visibleRowDataItem.newY,r.selectAll(p.backgroundElem?[p.backgroundElem,p.elem]:[p.elem]).transition().duration(o.options.transitionDuration).attr("transform","translate("+(o.convertXToLimitedX(p.newX)+Rt)+","+(p.newY+xt)+")")),c&&(s.attr("transform",c).transition().duration(o.options.transitionDuration).attr("transform",""),n.select("."+pe).each((function(){r.select(this).attr("opacity","0").transition().delay(o.options.transitionDuration).duration(0).attr("opacity","1")})))})):(t.oldX=t.newX,t.oldEndX=t.newEndX,t.oldY=t.newY,t.oldRowY=t.rowDataItem.visibleRowDataItem.newY,t.oldRowAtTheTop=!!o._isItemAtTheTop(t.rowDataItem.item))}}))}))}},_sortBarsInRow:function(e){"use strict";var t=this;if(t._barDragging.isInitiated()&&t._barDragging.isRowOfCoupledTimeItems(e)||!(t._getCurrentlyDisplayedElementsInRow(e)&tt.Optimized)){var i=r.select(e.foregroundRowElem).select(".ngantt-timearea-row-contents"),a=r.select(t._getOrCreateSpecialRowElem(e,!1,1)),n=[i];a&&n.push(a),n.forEach((function(e){var t={},i=-1,a=e.selectAll("."+ee+",."+de),n=a.size()+1;a.each((function(e){if(i++,e.parentTimeDataItem){(o=t[e.parentTimeDataItem.id])||(o=t[e.parentTimeDataItem.id]={rectLeft:Number.MAX_VALUE,rectRight:-Number.MAX_VALUE});var a=e.newX||e.oldX,r=e.newEndX||e.oldEndX||a;o.rectLeft>a&&(o.rectLeft=a),o.rectRight<r&&(o.rectRight=r),t[e.id]={barIndex:i,rectLeft:a,rectRight:r}}else{var o;(o=t[e.id])||(o=t[e.id]={rectLeft:Number.MAX_VALUE,rectRight:-Number.MAX_VALUE}),o.barIndex=n*i}})),e.selectAll("."+te).each((function(){var e=r.select(this).selectAll("."+ee+",."+de),i=e[0]||e.nodes();i.sort((function(e,i){var a=r.select(e),o=r.select(i),s=a.datum(),l=o.datum(),c=(s.parentTimeDataItem||s).isCurrentlyDraggedCoupled,d=(l.parentTimeDataItem||l).isCurrentlyDraggedCoupled;if(c!==d)return(c?1:0)-(d?1:0);var m=t[s.id],u=t[l.id],h=m.barIndex,p=u.barIndex;if(s.parentTimeDataItem?(m=t[s.parentTimeDataItem.id],"twice"!==s.parentTimeDataItem.item.zOrder&&(h+=m.barIndex+1)):"twice"===s.item.zOrder&&(h/=n),l.parentTimeDataItem?(u=t[l.parentTimeDataItem.id],"twice"!==l.parentTimeDataItem.item.zOrder&&(p+=u.barIndex+1)):"twice"===l.item.zOrder&&(p/=n),s.parentTimeDataItem!==l&&l.parentTimeDataItem!==s){var _=((s.parentTimeDataItem||s).item.barTopOffset||0)-((l.parentTimeDataItem||l).item.barTopOffset||0);if(_)return _;if(m.rectLeft!==u.rectLeft)return m.rectLeft-u.rectLeft;if(u.rectRight!==m.rectRight)return u.rectRight-m.rectRight}return h-p})),e[0]?e.order():r.selectAll(i).order()}))}))}},_findTimeDataItemsForCollapsedChildRowsRecursively:function(e,t){"use strict";var i=this;Array.isArray(e.item.timeItems)&&0!==e.item.totalHeight&&i._determineTimeDataItems(e.item.timeItems,!1).forEach((function(e){i._isTimeDataItemVisible(e)&&t.push(e)})),e.isLeaf||["leafRowDataItems","childRowDataItems"].forEach((function(a,n){i._getCurrentlyDisplayedElementsInRow(e)&(n?tt.BarsOfCollapsedChildRows:tt.BarsOfCollapsedLeafRows)&&Array.isArray(e[a])&&e[a].forEach((function(e){i._findTimeDataItemsForCollapsedChildRowsRecursively(e,t)}))}))},_isTimeDataItemEditable:function(e){"use strict";var t=e.rowDataItem&&e.rowDataItem.visibleRowDataItem;return t&&this.options.editable&&this._getActualBarInteractions(e)!==rt.None&&(!t.isCollapsed||this.options.timeItemsEditableInCollapsedRows||e.rowDataItem.isLeaf||(this.options.timeItemsHaveSameReferenceAsRowItems?t===e.rowDataItem.parentRowDataItem:!t.childRowDataItems||Array.isArray(t.childRowDataItems)&&!t.childRowDataItems.length||!(this._getCurrentlyDisplayedElementsInRow(t)&tt.BarsOfCollapsedChildRows)||!t.leafRowDataItems||Array.isArray(t.leafRowDataItems)&&!t.leafRowDataItems.length||!(this._getCurrentlyDisplayedElementsInRow(t)&tt.BarsOfCollapsedLeafRows)))},_isTimeDataItemVisible:function(e,t){"use strict";if(!e.rowDataItem||!this._getDataItem(e.id,this._timeDataItemsMap))return!1;if(e.item._isDisposed)return!1;var i=!0,a=e.rowDataItem.visibleRowDataItem,n=a.isCollapsed,r=e.item;if(r.hidden||r.hiddenInCollapsedRow&&n)i=!1;else for(var o=e.parentTimeDataItem;i&&o;)(r=o.item).hidden||r.hiddenInCollapsedRow&&n?i=!1:o=o.parentTimeDataItem;return i&&!t?e.rowDataItem.isHidden?e.rowDataItem.isLeaf?this._getCurrentlyDisplayedElementsInRow(a)&tt.BarsOfCollapsedLeafRows:this._getCollapsedDisplayedElementsForRowItem(a.item)&tt.BarsOfCollapsedChildRows:this._getCurrentlyDisplayedElementsInRow(e.rowDataItem)&tt.Bars:i},_canTimeDataItemBeVisible:function(e){"use strict";if(this._isTimeDataItemVisible(e))return!0;if(!e.rowDataItem)return!1;var t=!0,i=e.rowDataItem,a=e.item;if(a.hidden)t=!1;else for(var n=e.parentTimeDataItem;t&&n;)(a=n.item).hidden?t=!1:n=n.parentTimeDataItem;if(t&&!(this._getExpandedDisplayedElementsForRowItem(i.item)&tt.Bars)){t=!1;do{this._getCollapsedDisplayedElementsForRowItem(i.item)&tt.BarsOfCollapsedChildRows||(t=!0),i=i.parentRowDataItem}while(i)}return t},_determineBarLayerByZOrder:function(e,t,i){"use strict";t-=t%1;//!IE: Math.trunc(zOrder);
var a=e.datum();a.zOrdersToBarLayersD3Maps||(a.zOrdersToBarLayersD3Maps={}),a.zOrdersToBarLayersD3Maps[i]||(a.zOrdersToBarLayersD3Maps[i]={});var n=a.zOrdersToBarLayersD3Maps[i],r=n[t];if(!r){var o=Object.keys(n).map((function(e){return+e}));o.push(t),o.sort((function(e,t){return e-t}));var s=o.indexOf(t);if((r=s<o.length-1?e.insert("g",(function(){return n[o[s+1]].node()})):e.append("g")).attr("class",te+" ngantt-z-order-"+t),n[t]=r,a.mainHeightLimited){var l=this._getOrCreateClipPathForRow(0,a.mainHeight);r.attr("clip-path","url(#"+l+")")}}return r},_barEventDispatcherHandlerFunction:function(e,t){"use strict";var i=this,a=n(t.srcEvent?t[m.SUB_ELEM_PROPERTY]:t.target);if(!a.hasClass(he)&&!a.hasClass(pe))switch(t.type){case m.TAP_EVENT_NAME:if(i.options.timeItemsSelectable){var r=e.item.selectable;if(null==r?e.rowDataItem.isLeaf?i.options.defaultLeafTimeItemSelectable:i.options.defaultTimeItemSelectable:r){for(var o=e;o.parentTimeDataItem;)o=o.parentTimeDataItem;if(null==(r=o.item.selectable)?e.rowDataItem.isLeaf?i.options.defaultLeafTimeItemSelectable:i.options.defaultTimeItemSelectable:r){var s,l,c,d,u=i._isCtrlKeyPressed(t);if(u){if(Object.keys(i._selectedRowDataItemsMap).length)return;var h=(s=i._selectedTimeItems.slice()).indexOf(o.item);h>=0?s.splice(h,1):(c=s.slice(),s.push(o.item),l=!0)}else t.srcEvent.shiftKey||t.srcEvent.altKey?s=i._selectedTimeItems.slice():(i.options.canSelectTimeItemFunc&&i._selectedTimeItems.indexOf(o.item)<0&&(c=[],l=!0),s=[o.item]);if(i._suspendForSelect=!0,l&&i.options.canSelectTimeItemFunc){var p=i._extendCallbackArgs({timeItem:e.item,otherSelectedTimeItems:c,altKey:t.srcEvent.altKey,shiftKey:t.srcEvent.shiftKey,metaKey:u,ctrlKey:u,event:t.srcEvent,hammerEvent:t,canSelect:!0});i.options.canSelectTimeItemFunc.call(i,p),p.canSelect||(d=!0)}if(!d&&i.options.selectTimeItemFunc){p=i._extendCallbackArgs({timeItem:o.item,oldSelectedRowItems:i.selectedRowItems(),oldSelectedItems:i._selectedTimeItems.slice(),newSelectedItems:s,altKey:t.srcEvent.altKey,shiftKey:t.srcEvent.shiftKey,metaKey:u,ctrlKey:u,event:t.srcEvent,hammerEvent:t,cancel:!1});i.options.selectTimeItemFunc.call(i,p),p.cancel&&(d=!0)}d||((s=Array.isArray(p.newSelectedItems)?p.newSelectedItems:[]).length&&(i.options.timeItemsHaveSameReferenceAsRowItems||i._changeRowItemSelection([]),i._changeLinkItemSelection([])),s&&i._changeTimeItemSelection(s)),delete i._suspendForSelect,d||i.update()}}}i._triggerEvent(i._extendCallbackArgs({sender:e.item,eventType:"tap",elem:e.elem,elemType:$e.Bar,event:t.srcEvent,hammerEvent:t}));break;case m.DOUBLE_TAP_EVENT_NAME:i._triggerEvent(i._extendCallbackArgs({sender:e.item,eventType:"doubletap",elem:e.elem,elemType:$e.Bar,event:t.srcEvent,hammerEvent:t}));break;case m.CONTEXTMENU_EVENT_NAME:i.options.onEventFunc&&(i._setBarInteractionCursor(rt.None),i._triggerEvent(i._extendCallbackArgs({sender:e.item,eventType:"contextmenu",elem:e.elem,elemType:$e.Bar,event:t}))),i.options.preventDefaultOnContextMenuEvents&&(t.stopPropagation(),t.preventDefault());break;case m.PAN_EVENT_NAME+"start":i._onBarDragStart(t,e);break;case m.PAN_EVENT_NAME+"move":i._onBarDragMove(t);break;case m.PAN_EVENT_NAME+"end":case m.PAN_EVENT_NAME+"cancel":i._onBarDragEnd(t);break;case m.PRESS_EVENT_NAME:"touch"===t.pointerType&&i._onBarPress(t,e);break;case m.PRESS_EVENT_NAME+"up":"touch"===t.pointerType&&i._onBarPressUp(t,e)}},_createBar:function(e,t,i,a){"use strict";var o=this;if(i===pt.WorldView||!a){var s,l;if(t.phantomType?(l=(s=t).timeDataItem,s.oldVisibleRowDataItem=l.rowDataItem.visibleRowDataItem):l=t,i!==pt.WorldView){t.version++,t.elem&&o._detachTimeDataItem(t,!1);var c=Array.isArray(l.item.childTimeItems)&&l.item.childTimeItems.length;if(l){var d=c?de:ee;d+=" "+m.TAP_EVENT_CLASS_NAME+" "+m.DOUBLE_TAP_EVENT_CLASS_NAME,d+=" "+m.CONTEXTMENU_EVENT_CLASS_NAME,d=o._enrichClass(l,d,{elemType:$e.Bar});var u,h=c&&null==l.item.zOrder?-1e3:100*(parseFloat(l.item.zOrder)||0);"twice"===l.item.zOrder&&(c&&l.item.barShape?(h=-1e3,u=o._determineBarLayerByZOrder(e,-1e3,s?1:l.highlighted?2:0).append("g").attr("class","ngantt-compound-bar "+me).datum(t).property(o._ITEM_VERSION_PROPERTY,t.version),t.backgroundElem=u.node(),h=0,d+=" "+ue):h=0),h+=l.subRowIndex;var _=o._determineBarLayerByZOrder(e,h,s?1:l.highlighted?2:0).append("g").attr("class",d).datum(t).property(o._ITEM_VERSION_PROPERTY,t.version);if(t.elem=_.node(),s||(l.selected?o._prependBarSelectedRect(l,_):o._isTimeDataItemSelected(l)&&o._checkHighlightingForTimeDataItem(l,_)),!s&&l.item.marked){o._determineTimeDataItemExtent(l,void 0,void 0,!0);_.append("rect").attr("class",Me).attr("rx",o._barFrameRounding).attr("ry",o._barFrameRounding)}if(!c||l.item.barShape){o._isTimeDataItemEditable(l)?_.attr("class",_.attr("class")+" "+m.PRESS_PAN_EVENT_CLASS_NAME):_.attr("class",_.attr("class")+" "+m.PRESS_EVENT_CLASS_NAME),n(_.node()).data(m.HANDLER_FUNCTION_PROPERTY+qe+o._uniqueID,(function(e){try{o._barEventDispatcherHandlerFunction(l,e)}catch(e){o._handleException(e,"onEventDispatch_bar")}})),!s&&l.phantomDataItem&&!l.phantomDataItem.parentPhantomDataItem&&o._currentDragParams&&o._currentDragParams.elemType===$e.Bar&&("twice"!==l.item.zOrder||h>=0)&&o._eventDispatcher.replacePressOrPanTargetElem(_.node()),o.options.attachEventListenersFunc&&o.options.attachEventListenersFunc.call(o,o._extendCallbackArgs({isForeground:!0,item:_.datum().item,elem:this,elemType:$e.Bar}));var f=l.item.respectingCalendar;void 0===f&&(f=o.options.defaultRespectingCalendar),f&&(f=!!(l.item.calendar||l.rowDataItem&&l.rowDataItem.item.calendar||o.options.defaultCalendar));var g,T=o._getActualBarHeight(l),v=o._getActualBarShape(l);if(o._barFactory.createBar(o._extendCallbackArgs({barShapeId:v,barD3:_,barHeight:T,respectingCalendar:f,dataItem:l,rowDataItem:l.rowDataItem.visibleRowDataItem,enrichClassFunc:function(e,t){return o._enrichClass(l,e,t)}})),u&&o._barFactory.createBar(o._extendCallbackArgs({barShapeId:v,barD3:u,barHeight:T,respectingCalendar:f,dataItem:l,rowDataItem:l.rowDataItem.visibleRowDataItem,enrichClassFunc:function(e){return e}})),o.options.createBarFunc&&(E=o._extendCallbackArgs({timeItem:l.item,elem:_.node(),backgroundElem:t.backgroundElem,isPhantom:!!s,caption:void 0}),void 0===(g=o.options.createBarFunc.call(o,E))&&(g=E.caption),l.worldViewFillColor=E.worldViewFillColor,l.worldViewBorderColor=E.worldViewBorderColor),g){var w,S=2+((l.item.leftCaptionOffset||void 0)+2||0);if("string"==typeof g){var b=_.select("."+ie);(w=b.size()?_.insert("text",(function(){return b.node()})):_.append("text")).attr("class",se).attr("x",S).attr("y",T/2).attr("dy",".3em").text(g)}else g instanceof Element?g instanceof SVGTextElement&&(w=r.select(g).attr("class",se).attr("x",S).attr("dy",".3em")):void 0!==g.text&&((w=void 0!==g.elem?r.select(g.elem):_.append("text")).classed(se,!0).attr("x",S).attr("y",T/2).attr("dy",".3em"),g.width?(w.attr("data-text",g.text).attr("data-inline-width",g.width),null!=g.wrapMode&&w.attr("y",".7em").attr("data-wrap-mode",g.wrapMode),D.wrapSVGText(w),w.attr("data-text",null)):w.text(g.text));w&&E&&E.finalizeFunc&&E.finalizeFunc.call(o,o._extendCallbackArgs({elem:w.node()}))}if(!s&&!p.isIOS&&!o.options.isForExport&&(c?l.item.barShape:!l.parentTimeDataItem||l.item.isOutsideParentBar||!l.parentTimeDataItem.item.barShape)){var I=_.classed(ie)?_:_.select("."+ie),A=(I.size()?I:_.select("."+re)).node()||_.node();n(A).on("mouseenter.ngantt"+o._uniqueID,(function(e){try{o._lastMouseEnterElem!==A&&(o._onmouseenter_cursor(e,A,ee),o.isInInteraction()||(o._lastTooltipBarElem=A,o._triggerEvent(o._extendCallbackArgs({sender:l.item,eventType:"tooltip",elem:_.node(),event:e})),n(window).on("mousemove.ngantt"+o._uniqueID+"-tooltip",(function(e){try{if(o._lastTooltipBarElem===A){var t=A.getBoundingClientRect(),i=Math.max((parseFloat(window.getComputedStyle(A)["stroke-width"].replace("px",""))||0)/2,1),a=t.left-i,r=t.right+i,s=t.top-i,l=t.bottom+i;(Math.floor(a)>Math.ceil(e.pageX)||Math.ceil(r)<=Math.floor(e.pageX)||Math.floor(s)>Math.ceil(e.pageY)||Math.ceil(l)<=Math.floor(e.pageY))&&(n(window).off("mousemove.ngantt"+o._uniqueID+"-tooltip"),o._triggerEvent(o._extendCallbackArgs({sender:null,eventType:"tooltip",elem:null,event:e})),delete o._lastTooltipBarElem)}}catch(e){o._handleException(e,"onMouseMove_bar")}}))))}catch(e){o._handleException(e,"onMouseEnter_bar")}}))}s&&_.append("path").attr("class",ne)}t===l&&l.phantomDataItem?_.style("opacity",y._DefaultBarOpacity):s||null==l.item.opacity||_.style("opacity",l.item.opacity)}}else{var E;o.options.createBarFunc&&!s&&(E=o._extendCallbackArgs({timeItem:l.item,caption:void 0}),o.options.createBarFunc.call(o,E),l.worldViewFillColor=E.worldViewFillColor,l.worldViewBorderColor=E.worldViewBorderColor)}return o._positionBar(_,t,i===pt.WorldView?3:a,void 0,!0),_}return o._positionBar(null,t,a),null},_checkBarVisibilityForLimitedXCoords:function(e,t){"use strict";var i=this;if(i.options.barVisibilityCheckEnabled){var a=t.newX,n=t.newEndX;t.outerStart&&(a=Math.min(a,i._timeAxis.convertDateToX(t.outerStart)),n=Math.max(n,i._timeAxis.convertDateToX(t.outerEnd)));var r=i._isXOutsideLimits(a);r&&r===i._isXOutsideLimits(n)?"unlimitedVisibility"in t||(t.unlimitedVisibility=e.attr("visibility"),e.attr("visibility","hidden"),t.isHiddenByLimits=!0):"unlimitedVisibility"in t&&(e.attr("visibility",t.unlimitedVisibility),delete t.unlimitedVisibility,delete t.isHiddenByLimits)}},_calculateProgress:function(e,t,i,a){"use strict";var n;return a?a instanceof Date?a:a>=100?i:a<0?t:C.hasWorkingTime(e,i,t)&&this.options.progressBarWidthCalculationMode===vt.ConsiderWorkingTimesOnly?(n=C.calculateWorkingTime(e,i,t)*a/100,C.addWorkingTime(e,t,n)):(n=(i.getTime()-t.getTime())*a/100,new Date(t.getTime()+n)):t},_positionBar:function(e,t,i,a,o){"use strict";var s,l,c=this;if(l=t.phantomType?(s=t).timeDataItem:t,2===i||(i?c._isTimeDataItemVisible(l):t.elem)){var d,m,u=c._timeAxis,h=Array.isArray(l.item.childTimeItems)&&l.item.childTimeItems.length;h&&t.backgroundElem&&(m=r.select(t.backgroundElem));var p=null,_=null;if(!i)if(s)p=c._determineTimeDataItemExtent(s);else{if(l.selectedFrameElem){var f=c._determineSelectionFrameExtent(l);f&&c._positionSelectionFrame(l,r.select(l.selectedFrameElem),l.selectedFrameMaskElem&&r.select(l.selectedFrameMaskElem),f)}l.item.marked&&(_=c._determineTimeDataItemExtent(l,void 0,void 0,!0))&&(p=c._determineTimeDataItemExtent(l),e.select(".ngantt-marked-bar").attr("transform","translate("+(c.convertXToLimitedX(p.outerLeft)-c.convertXToLimitedX(p.left))+")").attr("x",-c._barFrameDistance+c.convertXToLimitedX(_.left)-c.convertXToLimitedX(p.left)).attr("y",-c._barFrameDistance+_.top-p.top).attr("width",Math.max(c.convertXToLimitedX(_.outerRight)-c.convertXToLimitedX(_.outerLeft),0)+2*c._barFrameDistance).attr("height",_.bottom-_.top+2*c._barFrameDistance))}var g=null!==p?p:c._determineTimeRange(t);if(g){var T=p?p.left:u.convertDateToX(g.start),D=p?p.right:u.convertDateToX(g.end),v=Math.max(c.convertXToLimitedX(D)-c.convertXToLimitedX(T),0),y=!c._barDragging.hasCoupledTimeItems(),w=y&&c._barDragging.getPointerX()-T||0,b=y&&c._barDragging.getPointerDateTime()||void 0,I=c._getActualBarShape(l);t.newX=T;var A=l.rowDataItem.visibleRowDataItem.subRowDataItems[l.subRowIndex];if(t.newY=c.determineActualRowMargins().top+(A?A.offsetY:0)+(l.item.barTopOffset||0)-(A?A.minimumY:0),t.phantomDataItem&&(t.phantomDataItem.newY=l.newY+l.rowDataItem.visibleRowDataItem.newY-t.phantomDataItem.rowDataItem.visibleRowDataItem.newY),t.newEndX=D,t.phantomDataItem&&t.phantomDataItem.frameD3&&c._barDragging.isDropped()){null===_&&(_=c._determineTimeDataItemExtent(l,void 0,void 0,!0)),t.phantomDataItem.frameStart=_.start,t.phantomDataItem.frameEnd=_.end;var R=t.phantomDataItem.newY;t.phantomDataItem.frameD3.transition().duration(c.options.transitionDuration).attr("transform","translate("+(c.convertXToLimitedX(c._timeAxis.convertDateToX(t.phantomDataItem.frameStart))+Rt)+","+(R+xt)+")").select("."+ae).attr("width",c.convertXToLimitedX(c._timeAxis.convertDateToX(t.phantomDataItem.frameEnd))-c.convertXToLimitedX(c._timeAxis.convertDateToX(t.phantomDataItem.frameStart))+2*c._phantomFrameDistance)}if(3!==i&&o&&!s&&c._checkBarVisibilityForLimitedXCoords(e,l),!h||l.item.barShape){var x=3!==i&&l.item.respectingCalendar;if(void 0===x&&(x=c.options.defaultRespectingCalendar),i){if(3===i){P=c._extendCallbackArgs({barShapeId:I,barHeight:c._getActualBarHeight(l),worldViewBarWidth:D-T,dataItem:l,rowDataItem:l.rowDataItem,timeRange:g,calculateProgressFunc:function(){return 0},worldViewVisible:!0});this._barFactory.positionBar(P),c.options.positionBarFunc&&(O=c._extendCallbackArgs({timeItem:l.item,width:D-T,isPhantom:!!s,start:g.start,duration:C.calculateWorkingTime(V,g.end,g.start),end:g.end,progress:d,worldViewVisible:!0}),c.options.positionBarFunc.call(c,O)),c._worldViewDivJQ&&c._putBarIntoWorldViewCache(l,O&&O.worldViewPathData||P.worldViewPathData)}}else{var L=u.isDateAfterEnd(g.start)||u.isDateBeforeStart(g.end);if(!l.isHiddenByLimits||c._worldViewDivJQ){if(!l.isHiddenByLimits){if(!L){var B=u.collapseCalendar();B&&c._getActualBarType(l)!==at.Single&&B.determineTimeType(g.start)!==S.WorkingTime&&!C.calculateWorkingTime(B,g.end,g.start)&&(L=!0)}e.attr("visibility",L?"hidden":null)}if(!L||c._worldViewDivJQ){e.selectAll("."+le).attr("width",v);var O,M=c._getActualBarHeight(l),V=x?l.item.calendar||l.rowDataItem&&l.rowDataItem.item.calendar||c.options.defaultCalendar:void 0,k=(!V||(V.determineTimeType(g.start),S.WorkingTime),L?void 0:V&&s&&c._barDragging.isInitiated()&&a&rt.DragLeftSide),F=L?void 0:k&&w&&g.start.getTime()>b.getTime(),N=L?void 0:V&&s&&c._barDragging.isInitiated()&&a&rt.DragRightSide,W=L?void 0:N&&w!==v&&g.end.getTime()<b.getTime(),P=c._extendCallbackArgs({barShapeId:I,barD3:L?void 0:e,barHeight:M,width:v,worldViewBarWidth:D-T,pointerX:w,calendar:V,dataItem:l,rowDataItem:l.rowDataItem,timeAxis:c._timeAxis,timeRange:g,draggingLeftSide:k,draggingRightSide:N,openOnLeftSide:F,openOnRightSide:W,calculateProgressFunc:function(){return c._calculateProgress(V,g.start,g.end,l.item.progress)},convertXToLimitedX:function(e){return c.convertXToLimitedX(e)},worldViewVisible:!!c._worldViewDivJQ});if(this._barFactory.positionBar(P),!L)switch(m&&this._barFactory.positionBar(n.extend({},P,{barD3:m,calculateProgressFunc:function(){return 0},worldViewVisible:!1})),I){case nt.Custom:var H=u.convertDateToX(g.start),X=c.determineActualRowMargins().top+M/2;e.attr("transform","translate("+(c.convertXToLimitedX(H)+bt)+","+(X+It)+")")}if(c._worldViewDivJQ&&c._putBarIntoWorldViewCache(l,P.worldViewPathData),!L){var U=c._getActualBarType(l)>at.Single;e.selectAll("."+se).each((function(){var e=r.select(this);if(e.node()&&!e.attr("data-text")&&U&&E.isTextClippingAllowed(I)){if(l.item.clipEndAtNextItemStart&&void 0!==l.subRowIndex){var t=l.rowDataItem.visibleRowDataItem.subRowDataItems[l.subRowIndex];if(t.timeSpans&&!t.timeSpans.getValueAtDate(g.end)){var i=t.timeSpans.determineNextDateWithValue(g.end);v=i?Math.max(c.convertXToLimitedX(u.convertDateToX(i.date))-c.convertXToLimitedX(T),0):-1}}v>=0?c.setClipPathAttrOnElemD3WithRefCount(e,c.getOrCreateClipPathForRange(0,v)):c.setClipPathAttrOnElemD3WithRefCount(e)}}))}if(c.options.positionBarFunc&&(O=c._extendCallbackArgs({timeItem:l.item,elem:L?void 0:e.node(),width:D-T,isPhantom:!!s,pointerX:!L&&c._barDragging.isInitiated()?c._barDragging.getPointerX():void 0,calendar:V,start:g.start,duration:C.calculateWorkingTime(V,g.end,g.start),end:g.end,progress:d}),!L&&m&&(O.backgroundElem=m.node()),c.options.positionBarFunc.call(c,O)),c._worldViewDivJQ&&c._putBarIntoWorldViewCache(l,O&&O.worldViewPathData||P.worldViewPathData),!L&&!s&&l.phantomDataItem){var G=l.phantomDataItem;G.start=c._getBindingPropertyInfosAndValue(l.item,"start","date").value,G.end=c._getBindingPropertyInfosAndValue(l.item,"end","date").value,c._positionBar(r.select(G.elem),G,i,a,o)}}}}}}}},_putBarIntoWorldViewCache:function(e,t){var i=this;if(i._worldViewDivJQ&&t){var a=e.rowDataItem.visibleRowDataItem,n=i._getTopOfRowDataItemForWorldView(a),r=i._timeAxis.actualTimeAreaWidth();t=t.map((function(t){return{x:Math.min(Math.max(t.x+e.newX,0),r),y:t.y}}));var o={x:i.actualTableWidth(),xPx:1,y:n.top+e.newY,yPx:n.topPx};null!=e.worldViewFillColor&&"none"!==e.worldViewFillColor&&"transparent"!==e.worldViewFillColor&&(a.worldViewBarCacheMap["F"+e.id]={method:"fillPath",args:[v.Content,{fillStyle:e.worldViewFillColor},t,o]}),null!=e.worldViewBorderColor&&"none"!==e.worldViewBorderColor&&"transparent"!==e.worldViewBorderColor&&(a.worldViewBarCacheMap["S"+e.id]={method:"drawPath",args:[v.Content,{strokeStyle:e.worldViewBorderColor},t,o]}),e.worldViewRowDataItem!==a&&(e.worldViewRowDataItem&&(delete e.worldViewRowDataItem.worldViewBarCacheMap["F"+e.id],delete e.worldViewRowDataItem.worldViewBarCacheMap["S"+e.id]),e.worldViewRowDataItem=a)}},_positionBarFully:function(e,t,i,a,n,o,s){"use strict";var l=this;if(l._positionBar(e,i,a,n,o),"newX"in i){e.interrupt(),r.timeFormat&&e.transition().each((function(){r.select(this).interrupt()})),null==s&&(s=i.newY);var c="translate("+(l.convertXToLimitedX(i.newX)+Rt)+","+(s+xt)+")";e.attr("transform")!==c&&(e.attr("transform",c),i.backgroundElem&&r.select(i.backgroundElem).attr("transform",c),"phantomType"in i||(i.oldX=i.newX,i.oldEndX=i.newEndX,i.oldY=i.newY,t&&(i.oldRowY=t.newY,i.oldRowAtTheTop=!!l._isItemAtTheTop(t.item))))}},recheckBarInteractions:function(e){"use strict";var t=this,i=t._getDataItem(e,t._timeDataItemsMap);i&&i.elem&&t._lastMouseEnterElem&&(i.elem===t._lastMouseEnterElem||i.elem===t._lastMouseEnterElem.parentNode)&&(delete t._lastBarInteractionValues,t._onmousemove_cursor(t._lastMouseMoveEvent,t._lastMouseEnterElem,ee))},_onmousemove_cursor:function(e,t,i){"use strict";var a=this;if(a._lastMouseMoveEvent=e,!a._currentPanParams&&i===ee){var n=r.select(t),o=n.datum();if(o&&!o.timeDataItem){var s=a._pointToSVGRelative(t,e.pageX,e.pageY),l=a._determineBarInteraction(n,a._getActualBarInteractions(o),s,e);a._setBarInteractionCursor(l)}}},_onmouseenter_cursor:function(e,t,i){"use strict";var a=this;if(!a.isInInteraction()){if(a._lastMouseEnterElem&&a._lastMouseEnterElem!==t&&a._onmouseleave_cursor(),a._lastMouseEnterElem=t,a._lastMouseEnterClassName=i,p.isIE){var r=t.nextSibling,o=t.parentNode;o.removeChild(t),o.insertBefore(t,r)}n(window).on("mousemove.ngantt"+a._uniqueID+"-cursor",(function(e){try{if(!a.isInInteraction()){var n=t.getBoundingClientRect(),r=Math.max((parseFloat(window.getComputedStyle(t)["stroke-width"].replace("px",""))||0)/2,1),o=n.left-r,s=n.right+r,l=n.top-r,c=n.bottom+r;Math.floor(o)>Math.ceil(e.pageX)||Math.ceil(s)<Math.floor(e.pageX)||Math.floor(l)>Math.ceil(e.pageY)||Math.ceil(c)<Math.floor(e.pageY)?a._onmouseleave_cursor():a._onmousemove_cursor(e,t,i)}}catch(e){a._handleException(e,"onMouseMove_cursor")}})),a._onmousemove_cursor(e,t,i)}},_onmouseleave_cursor:function(){"use strict";var e=this;n(window).off("mousemove.ngantt"+e._uniqueID+"-cursor"),e._lastMouseEnterElem=void 0,e.isInInteraction()||e._lastMouseEnterClassName!==ee||(e._setBarInteractionCursor(rt.None),e._lastBarInteractionValues&&(e._lastBarInteractionValues.outOfBar=!0))},_shouldDragCompoundBar:function(e){"use strict";var t=this.options.alwaysDragCompoundBar;return!t&&e&&((e.srcEvent?e.srcEvent:e)._shiftKey||e.pointers&&2===e.pointers.length)&&(t=!0),t},_determineBarInteraction:function(e,t,i,a,r){"use strict";var o=this,s=n(a.srcEvent?a[m.SUB_ELEM_PROPERTY]:a.target);if(s.hasClass(he)||s.hasClass(pe))return rt.None;var l=e.datum();t&rt.DragHorOrVer&&(t|=rt.DragHor|rt.DragVer);var c=o._isTimeDataItemEditable(l),d=!1;l.parentTimeDataItem&&(o._shouldDragCompoundBar(a)||t===rt.None)&&(null!=(l=l.parentTimeDataItem).item.barInteractions&&(t=o._getActualBarInteractions(l)),d=!0);var u=t;if(c){if(u&(rt.DragHor|rt.DragLeftSide|rt.DragRightSide)){var h=l.rowDataItem;h.visibleRowDataItem.isCollapsed&&!o.options.timeItemsEditableInCollapsedRows&&(o.options.timeItemsHaveSameReferenceAsRowItems&&(h=h.parentRowDataItem),h.visibleRowDataItem!==h&&(u&=~(rt.DragHor|rt.DragHorOrVer|rt.DragLeftSide|rt.DragRightSide)))}}else u=rt.None;if(!o._lastBarInteractionValues||!r&&o._lastBarInteractionValues.outOfBar||o._lastBarInteractionValues.timeItem!==l.item||o._lastBarInteractionValues.determinedBarInteractions!==u)if(o._lastBarInteractionValues={timeItem:l.item,possibleBarInteractions:t,determinedBarInteractions:u,finalBarInteractions:u,outOfBar:!1},o.options.checkPossibleInteractionsFunc){var p=o._extendCallbackArgs({item:l.item,elemType:$e.Bar,elem:l.elem,event:a.center?a.srcEvent:a,hammerEvent:a.center?a:void 0,point:i,startX:l.oldX,endX:l.oldEndX,isEditable:c,isInCollapsedRow:l.rowDataItem.visibleRowDataItem.isCollapsed,possibleInteractions:t,interactions:u,dragCompound:d||o._shouldDragCompoundBar(a)});o.options.checkPossibleInteractionsFunc(p),o._lastBarInteractionValues.finalBarInteractions=null!=o.options.forcedBarInteractions?l.rowDataItem.isLeaf?o.options.forcedLeafBarInteractions:o.options.forcedBarInteractions:p.interactions,o._lastBarInteractionValues.finalBarInteractions!==rt.None&&p.dragCompound&&(o._lastBarInteractionValues.finalBarInteractions|=ot.Compound)}else o._lastBarInteractionValues.finalBarInteractions!==rt.None&&(d||o._shouldDragCompoundBar(a))&&(o._lastBarInteractionValues.finalBarInteractions|=ot.Compound,d&&!o._shouldDragCompoundBar(a)||(o._lastBarInteractionValues.finalBarInteractions&=~(rt.DragLeftSide|rt.DragRightSide)));var _=o._lastBarInteractionValues.finalBarInteractions;o._getActualBarType(l)&(it.End|it.Duration)||(_&=~(rt.DragLeftSide|rt.DragRightSide));o._timeAxis.collapseCalendar();if(_&rt.DragRightSide){var f=void 0!==l.newX?l.newX:l.oldX,g=void 0!==l.newEndX?l.newEndX:l.oldEndX;if(Math.abs(i.x)>g-f-o.options.barDragAreaExtent&&(!(_&(rt.DragHor|rt.DragVer|rt.DragHorOrVer))||g-f>o.options.barDragAreaExtent))return rt.DragRightSide}if(_&rt.DragLeftSide){f=void 0!==l.newX?l.newX:l.oldX,g=void 0!==l.newEndX?l.newEndX:l.oldEndX;if(Math.abs(i.x)<o.options.barDragAreaExtent&&(!(_&(rt.DragHor|rt.DragVer|rt.DragHorOrVer))||g-f>(_&rt.DragLeftSide?2.5*o.options.barDragAreaExtent:o.options.barDragAreaExtent)))return rt.DragLeftSide}return _&~(rt.DragLeftSide|rt.DragRightSide)},determineActualTimeResolutionInSeconds:function(){"use strict";return R.timeUnitToSeconds(this.options.timeResolutionUnit)*(this.options.timeResolutionUnitsPerStep||1)},_convertXToDateInActualTimeResolution:function(e){"use strict";var t=this,i=t.determineActualTimeResolutionInSeconds(),a=t._timeAxis.convertXToDate(e,!1,!0).getTime(),n=a-a%i;if((n!==a?t._timeAxis.convertDateToX(new Date(n)):e)!==e){var r=n+i;a=t._timeAxis.convertDateToX(new Date(r))>e?n:r}else a=n;return new Date(a)},_setBarInteractionCursor:function(e){"use strict";var t=this,i="";switch(f.isContextMenuActive()&&(e=rt.None),e&~ot.Compound){case rt.DragHor:i="ew-resize";break;case rt.DragLeftSide:case rt.DragRightSide:i="col-resize";break;case rt.DragVer:i="ns-resize";break;case rt.DragHorOrVer:case rt.DragHor|rt.DragVer:case rt.DragHor|rt.DragVer|rt.DragHorOrVer:case rt.DragHor|ot.DragHorOrVerOverride:case rt.DragVer|ot.DragHorOrVerOverride:i="move"}t._barDragging.isInitiated()&&t._barDragging.setOption("interactionCursor",i),c.setCursor(t.element[0],i)},_onBarPress:function(e,t){"use strict";var i=this,a=!0;if(!i._barDragging.isInitiated()){var n=i._pointToSVGRelative(t.elem,e.center.x,e.center.y);i._determineBarInteraction(r.select(t.elem),i._getActualBarInteractions(t),n,e,!0)!==rt.None&&i._barDragging.initiate(e,t,!1)&&(i._touchScrollingEnabled=!1,a=!1)}a&&"touch"!==e.pointerType&&(e[m.CANCEL_PROPERTY]=!0)},_onBarPressUp:function(e,t){"use strict";var i=this,a=i._barDragging.isActive(),n=!a;i._barDragging.isInitiated()&&i._barDragging.terminate(e,!a),n&&"touch"===e.pointerType&&i.options.onEventFunc&&(i._setBarInteractionCursor(rt.None),i._triggerEvent(i._extendCallbackArgs({sender:t.item,eventType:"contextmenu",elem:t.elem,elemType:$e.Bar,event:e.srcEvent,hammerEvent:e})))},_onBarDragStart:function(e,t){"use strict";var i=this,a=!0;if(i._barDragging.isInitiated())a=!1;else if("mouse"===e.pointerType){var n=i._pointToSVGRelative(t.elem,e.center.x,e.center.y);i._determineBarInteraction(r.select(t.elem),i._getActualBarInteractions(t),n,e,!0)!==rt.None&&i._barDragging.initiate(e,t,!0)&&(a=!1)}a&&(e[m.CANCEL_PROPERTY]=!0)},_onBarDragMove:function(e,t){"use strict";this._barDragging.isInitiated()&&this._barDragging.handleDrag(e,t)},_onBarDragEnd:function(e){"use strict";this._barDragging.terminate(e,e.type.indexOf("cancel")>=0)},_triggerBarDragStartCallback:function(e){"use strict";var t=this,i=t._getDataItem(e.sender,t._timeDataItemsMap),a=function(){var a=t._determineSuperTimeDataItem(i);e.coupledItems=t.selectedTimeItems().filter((function(e){return e!==a.item})).map((function(e){for(var i=t._getDataItem(e,t._timeDataItemsMap),a=t._determineSuperTimeDataItem(i),n=t._determineTimeDataItems([a.item],!0).reverse();i=n.pop();)if(t._getActualBarInteractions(i))return i.item})).filter((function(e){return e}))};(i.rowDataItem.isLeaf?t.options.forcedLeafBarInteractions:t.options.forcedBarInteractions)===rt.None?e.cancel=!0:e.interaction&(rt.DragLeftSide|rt.DragRightSide)||!t.options.automaticDraggingOfSelectedTimeItems||a(),t.options.dragStartFunc&&(t.options.dragStartFunc(t._extendCallbackArgs(e)),e.cancel||e.interaction&(rt.DragLeftSide|rt.DragRightSide)||!t.options.automaticDraggingOfSelectedTimeItems?delete e.coupledItems:a())},_findRoundedTargetDateTime:function(e,t,i,a){"use strict";var n=t,r=this.determineActualTimeResolutionInSeconds();if(t.getTime()!==i.getTime()){for(var o=n<i?1e3:-1e3;o>0?n<i:n>i;){var s=C.addWorkingTime(e,n,o*r);if(!s)break;if(e)if(a)e.determineTimeType(s)!==S.WorkingTime&&(s=e.findStartOfNextTimeTypeChange(s));else{var l=new Date(s);l.setMilliseconds(l.getMilliseconds()-1),e.determineTimeType(l)!==S.WorkingTime&&(s=e.findStartOfCurrentTimeTypeInterval(s))}if(!s||(o>0?s>i:s<i))break;n=s}if(n.getTime()!==i.getTime()){var c=C.addWorkingTime(e,n,-o*r);if(e)if(a)e.determineTimeType(c)!==S.WorkingTime&&(c=e.findStartOfNextTimeTypeChange(c));else{var d=new Date(c);d.setMilliseconds(d.getMilliseconds()-1),e.determineTimeType(d)!==S.WorkingTime&&(c=e.findStartOfCurrentTimeTypeInterval(c))}Math.abs(c-i)<Math.abs(n-i)&&(n=c)}}return n},_calculateStartForEntityPhantomFromPointer:function(e,t,i,a){var n=this,r=a-n.actualTableViewWidth()-n._actualSplitterWidth(),o=e&&(Math.abs(i)||0),s=o?t||e.item.calendar||n.options.defaultCalendar:void 0,l=n._convertXToDateInActualTimeResolution(r+n._timeAxis.timeAreaViewScrollOffset());if(l=C.addWorkingTime(s,l,-Math.floor(o/2))||l,o&&s&&!C.addWorkingTime(s,l,o)){var c=C.addWorkingTime(s,l,-o);c?l=c:s=null}var d=n.determineActualTimeResolutionInSeconds(),m=C.addWorkingTime(s,l,2e3*d-1);return m.setSeconds(m.getSeconds()-(60*(60*(24*m.getDate()+m.getHours())+m.getMinutes())+m.getSeconds())%d),{start:l=n._findRoundedTargetDateTime(s,m,l,!0),end:o?C.addWorkingTime(s,l,o):void 0}},_updateVerticalDOMElementsForRowDrag:function(e,t,i){"use strict";var a=this;if(a._super.apply(a,arguments),a._currentCursorDateLineVisible){var n=a._calculateStartForEntityPhantomFromPointer(t,e.object.calendar,e.object.duration,i.x);a._positionDateLine(a._cursorDateLineD3,n.start,{y:18,text:a._formatDate(n.start)},{y:i.y-a._actualTitleHeight(J),endDate:n.end}),a._cursorDateLineD3.style("visibility",null)}},_updateHorizontalDOMElementsForRowDrag:function(e,t,i){"use strict";var a=this;a._super.apply(a,arguments),t?(a._horizontalDragAreaD3.style("visibility",null),a._positionHorizontalDragArea(t)):a._horizontalDragAreaD3.style("visibility","hidden")},_determineStartEndForRowDrag:function(e,t,i){"use strict";var a=this;if(a._super.apply(a,arguments),t)return a._calculateStartForEntityPhantomFromPointer(t,e.object.calendar,e.object.duration,i.x)},_handleDragEnterForRowDrag:function(e){"use strict";var t=this;t._super.apply(t,arguments),"netronic_rowItem"===e.objectType&&(t._isInDragOver=!0,t._currentCursorDateLineVisible=!0)},_handleDragLeaveForRowDrag:function(){"use strict";var e=this;e._super.apply(e,arguments),e._horizontalDragAreaD3.style("visibility","hidden"),e._currentCursorDateLineVisible=e.options.horizontalMousePositionHighlightingEnabled,e._currentCursorDateLineVisible||e._cursorDateLineD3.style("visibility","hidden")},_createVerticalDragArea:function(){"use strict";var e=this._verticalDragAreaParentD3.append("g").attr("class","ngantt-vertical-drag-area").attr("transform","translate("+this.convertXToLimitedX(this._timeAxis.timeAreaViewScrollOffset())+")").style("visibility","hidden");e.append("rect").attr("class","ngantt-vertical-drag-area-rect"),this._verticalDragAreaD3=e},_positionVerticalDragArea:function(e,t){"use strict";var i=this._verticalDragAreaD3.select("rect"),a=this.convertXToLimitedX(this._timeAxis.convertDateToX(e)),n=this.convertXToLimitedX(this._timeAxis.convertDateToX(t));i.attr("x",a).attr("y",0).attr("width",Math.max(n-a,0)).attr("height",this._actualInnerBodyViewHeightsSumWithSeparator())},_createHorizontalDragArea:function(){"use strict";var e=this._horizontalDragAreaParentD3.append("g").attr("class","ngantt-horizontal-drag-area").style("visibility","hidden");e.append("rect").attr("class","ngantt-horizontal-drag-area-rect"),this._horizontalDragAreaD3=e},_positionHorizontalDragArea:function(e){"use strict";var t=this,i=this._horizontalDragAreaD3.select("rect"),a=(e=e.visibleRowDataItem).newY;t._isItemAtTheTop(e.item)||(a+=t._layoutRows[Y].innerViewExtent()+t._actualBodyAreaSeparatorHeight()),i.attr("y",a-this.verticalScrollOffset()).attr("width",this._currentTimeAreaViewWidth).attr("height",e.totalHeight)},_createCursorRow:function(){"use strict";var e=this._horizontalDragAreaParentD3.append("g").attr("class","ngantt-cursor-row").style("visibility","hidden");return e.append("rect").attr("class",fe),e},_positionCursorRow:function(e){"use strict";var t=this;if(e){var i=this._horizontalDragAreaParentD3.select(".ngantt-cursor-row-rect"),a=(e=e.visibleRowDataItem).newY;t._isItemAtTheTop(e.item)||(a+=t._layoutRows[Y].innerViewExtent()+t._actualBodyAreaSeparatorHeight()),i.attr("y",a-this.verticalScrollOffset()).attr("width",this._currentTimeAreaViewWidth).attr("height",e.totalHeight)}},_getOrCreateSpecialRowElem:function(e,t,i){"use strict";var a=this;e.specialRowElem||(e.specialRowElem=[]);var n=e.specialRowElem[i];if(!n&&t){var r=(i?a._highlightedBodyD3s:a._phantomsBodyD3s)[a._getBodyAreaIndex(e.item)].append("g").attr("class",i?Ce:a.NXXXXX.PHANTOM_ROW_CLASS).attr("transform","translate(0,"+e.newY+")").data([e]);n=r.node(),e.specialRowElem[i]=n,r.append("g").attr("class",Ye).attr("transform","translate("+(a._actualLayoutColumnLeft(U)+Ot)+")").attr("clip-path","url(#"+a.NXXXXX.WIDTH_CLIPPATH_ID[U]+this._uniqueID+")").attr("height",e.totalHeight).append("g").attr("class",ze).attr("transform","translate("+-a.convertXToLimitedX(a._timeAxis.timeAreaViewScrollOffset())+")")}return n},_removeSpecialRowElem:function(e,t){"use strict";var i=e.specialRowElem[t];i&&(r.select(i).remove(),e.specialRowElem[t]=void 0,e.zOrdersToBarLayersD3Maps&&delete e.zOrdersToBarLayersD3Maps[t+1])},_registerGestureEventsOnTimeAreaBackground:function(e){"use strict";var t=this;e.classed(m.TAP_EVENT_CLASS_NAME,!0).classed(m.CONTEXTMENU_EVENT_CLASS_NAME,!0).classed(m.PINCH_EVENT_CLASS_NAME,t.options.zoomingByPinchInTimeAreaEnabled),n(e.node()).data(m.HANDLER_FUNCTION_PROPERTY+qe+this._uniqueID,(function(e){try{t._handleGestureEventOnTimeAreaBackground(e)}catch(e){t._handleException(e,"onEventDispatch_background")}}))},_handleGestureEventOnTimeAreaBackground:function(e){"use strict";var t,i=this,a=e.srcEvent||e;r.mouse?(r.event=a,t=r.mouse(i._backgroundBodyD3s[Y].node()),r.event=null):t=r.pointer(a,i._backgroundBodyD3s[Y].node());var n=i.actualTableViewWidth(),o=t[0]>=0&&t[0]<n;if(!o||!i._isInsideFixedPrecedingImageListColumn(e))switch(e.type){case m.TAP_EVENT_NAME:i._handleTapOnTimeAreaBackground(e),i._triggerEvent(i._extendCallbackArgs({sender:o?null:"TimeAreaBackground",eventType:"tap",event:e.srcEvent,hammerEvent:e}));break;case m.CONTEXTMENU_EVENT_NAME:if(i.options.onEventFunc){var s=i.options.contextMenuEventOnRowItemInTimeArea&&i._findRowDataItemAtY(e.pageY);s?i._triggerEvent(i._extendCallbackArgs({sender:s.item,elem:s.foregroundRowElem,elemType:$e.Row,eventType:"contextmenu",event:e})):i._triggerEvent(i._extendCallbackArgs({sender:o?null:"TimeAreaBackground",eventType:"contextmenu",event:e}))}i.options.preventDefaultOnContextMenuEvents&&(e.stopPropagation(),e.preventDefault());break;case m.PINCH_EVENT_NAME+"start":i._pinchStartVisualZoomFactor=i.options.visualZoomFactor,i._pinchCounter=0,i._pinchStartTime=performance.now(),i._pinchStartTimeStamp=e.srcEvent.timeStamp,i._pinchLastTimeStamp=0;break;case m.PINCH_EVENT_NAME:case m.PINCH_EVENT_NAME+"end":var l=e.type===m.PINCH_EVENT_NAME+"end";!function(){delete i._pinchTimerId;var t=i.options.visualZoomFactor,a=i._pinchStartVisualZoomFactor*e.scale,n=Math.max(i.options.minimumVisualZoomFactorOnInteraction,Math.min(i.options.maximumVisualZoomFactorOnInteraction,a));if(i.options.checkVisualZoomFactorFunc){var r=i._extendCallbackArgs({oldVisualZoomFactor:t,newVisualZoomFactorRaw:a,newVisualZoomFactor:n,hammerEvent:e,event:e.srcEvent,finished:l});l&&delete i._pinchStartTime,i.options.checkVisualZoomFactorFunc.call(i,r),n=r.newVisualZoomFactor}if(t!==n){var o=n/t,s=i._actualLayoutColumnLeft(U),c=s*t,d=s*n,m=i._actualTitleHeight(J)*t,u=i._actualTitleHeight(J)*n,h=i.horizontalTimeAreaViewScrollOffset(),p=i.verticalScrollOffset(),_=i._pointToSVGRelative(i._svgRootD3.node(),e.center.x,e.center.y);i.option("visualZoomFactor",n),i.scrollTo(void 0,h+(d-c)+(_.x-d)*(o-1)/t,p+(u-m)+(_.y-u)*(o-1)/t),i._pinchCounter=0}}(),i._pinchLastTimeStamp=e.srcEvent.timeStamp,e.preventDefault(),l&&(delete i._pinchStartVisualZoomFactor,delete i._pinchCounter,delete i._pinchStartTime,delete i._pinchStartTimeStamp,delete i._pinchLastTimeStamp)}},handleTapOnTimeAreaBackground:function(e){this._handleTapOnTimeAreaBackground(e)},_handleTapOnTimeAreaBackground:function(e){"use strict";var t=this;if(t.options.timeItemsSelectable&&t._selectedTimeItems.length){var i=t._extendCallbackArgs({timeItem:null,oldSelectedRowItems:t.selectedRowItems(),oldSelectedLinkItems:[],oldSelectedItems:t._selectedTimeItems.slice(),newSelectedItems:(p.isMacOrIOS?e.srcEvent.metaKey:e.srcEvent.ctrlKey)?t._selectedTimeItems.slice():[],altKey:e.srcEvent.altKey,shiftKey:e.srcEvent.shiftKey,metaKey:e.srcEvent.metaKey,ctrlKey:e.srcEvent.ctrlKey,event:e.srcEvent,hammerEvent:e,cancel:!1});if(t.options.selectTimeItemFunc){if(t.options.selectTimeItemFunc.call(t,i),i.cancel)return;Array.isArray(i.newSelectedItems)||(i.newSelectedItems=[])}else if(i.newSelectedItems.length)return;t.options.timeItemsHaveSameReferenceAsRowItems||t._changeRowItemSelection([]),t._changeLinkItemSelection([]),t._changeTimeItemSelection(i.newSelectedItems)}else if(t.options.rowItemsSelectable&&Object.keys(t._selectedRowDataItemsMap).length){i=t._extendCallbackArgs({rowItem:null,oldSelectedTimeItems:t._selectedTimeItems.slice(),oldSelectedLinkItems:[],oldSelectedItems:t.selectedRowItems(),newSelectedItems:(p.isMacOrIOS?e.srcEvent.metaKey:e.srcEvent.ctrlKey)?t.selectedRowItems():[],altKey:e.srcEvent.altKey,shiftKey:e.srcEvent.shiftKey,metaKey:e.srcEvent.metaKey,ctrlKey:e.srcEvent.ctrlKey,event:e.srcEvent,hammerEvent:e,cancel:!1});if(t.options.selectRowItemFunc){if(t.options.selectRowItemFunc.call(t,i),i.cancel)return;Array.isArray(i.newSelectedItems)||(i.newSelectedItems=[])}else if(i.newSelectedItems.length)return;t.options.timeItemsHaveSameReferenceAsRowItems||t._changeTimeItemSelection([]),t._changeLinkItemSelection([]),t._changeRowItemSelection(i.newSelectedItems),t.update()}else if(t.options.linkItemsSelectable&&Object.keys(t._selectedLinkDataItemsMap).length){i=t._extendCallbackArgs({linkItem:null,oldSelectedTimeItems:[],oldSelectedRowItems:[],oldSelectedItems:t.selectedLinkItems(),newSelectedItems:(p.isMacOrIOS?e.srcEvent.metaKey:e.srcEvent.ctrlKey)?t.selectedLinkItems():[],altKey:e.srcEvent.altKey,shiftKey:e.srcEvent.shiftKey,metaKey:e.srcEvent.metaKey,ctrlKey:e.srcEvent.ctrlKey,event:e.srcEvent,hammerEvent:e,cancel:!1});if(t.options.selectLinkItemFunc){if(t.options.selectLinkItemFunc.call(t,i),i.cancel)return;Array.isArray(i.newSelectedItems)||(i.newSelectedItems=[])}else if(i.newSelectedItems.length)return;t._changeTimeItemSelection([]),t._changeRowItemSelection([]),t._changeLinkItemSelection(i.newSelectedItems),t.update()}},_changeTimeItemSelection:function(e){"use strict";var t=this,i={},a=[],n=!!t._selectedTimeItems.length;t._selectedTimeItems.forEach((function(e){var n=t._getDataItem(e,t._timeDataItemsMap,t._unusedTimeDataItemsMap);n&&(i[n.id]||(i[n.id]=n.selected,a.push(n)),n.selected=!1)})),t._selectedTimeItems.length=0,e.forEach((function(e){var n=e.selectable,r=t._getDataItem(e,t._timeDataItemsMap);r&&(null==n?r.rowDataItem.isLeaf?t.options.defaultLeafTimeItemSelectable:t.options.defaultTimeItemSelectable:n)&&(i[r.id]||(i[r.id]=r.selected,a.push(r)),t._selectedTimeItems.push(e),r.selected=!0)})),a.forEach((function(e){e.selected!==i[e.id]&&(e.selected?e.elem&&t._prependBarSelectedRect(e,r.select(e.elem)):t._removeSelectionFrameOfTimeDataItem(e))})),"auto"===t.options.unselectedItemsShownCovered&&n!==!!e.length&&t._foregroundBodyD3s.forEach((function(e){e.selectAll("."+t.NXXXXX.ROW_CLASS).each((function(e){t._checkForVisibilityOfUnselectedRowCover(e)}))}))},_moveSelectedBar:function(e,t,i){"use strict";var a=this;if(a.options.selectedItemsShownHighlighted&&!!e.highlighted!==i){var n=r.select(a._getOrCreateSpecialRowElem(e.rowDataItem.visibleRowDataItem,!0,1)),o=(i?n:r.select(e.rowDataItem.visibleRowDataItem.foregroundRowElem)).select(".ngantt-timearea-row-contents"),s=Array.isArray(e.item.childTimeItems)&&e.item.childTimeItems.length,l=t.classed(me);s&&!l&&(e.backgroundElem&&a._moveSelectedBar(e,r.select(e.backgroundElem),i),e.item.childTimeItems.forEach((function(e){var t=a._getDataItem(e,a._timeDataItemsMap);a._moveSelectedBar(t,r.select(t.elem),i)})));var c=s&&(null==e.item.zOrder||l)?-1e3:100*(parseFloat(e.item.zOrder)||0);c+=e.subRowIndex,a._determineBarLayerByZOrder(o,c,i?2:0).node().appendChild(t.node()),e.highlighted=i}},_checkHighlightingForTimeDataItem:function(e,t){e.rowDataItem&&this._checkForVisibilityOfUnselectedRowCover(e.rowDataItem.visibleRowDataItem),this.options.selectedItemsShownHighlighted&&this._moveSelectedBar(e,t,!0)},_prependBarSelectedRect:function(e,t){"use strict";var i=this;if(i._checkHighlightingForTimeDataItem(e,t),e.selectedFrameElem&&(r.select(e.selectedFrameElem).remove(),delete e.selectedFrameElem),e.selectedFrameMaskElem&&(r.select(e.selectedFrameMaskElem).remove(),delete e.selectedFrameMaskElem),i.options.barSelectionWithFrames){var a=i._determineSelectionFrameExtent(e);if(a){var n,o=i._getBodyAreaIndex(e.rowDataItem.item);(null!=e.item.barShape&&Array.isArray(e.item.childTimeItems)||i.options.barSelectionFramesShownWithHigherZOrder)&&(n=i.options.barSelectionFramesShownWithHigherZOrder?i._barSelectionFramesD3[o].append("mask"):t.insert("mask",":first-child")),n&&(n.attr("class","ngantt-selected-bar-mask").attr("id",Xe+e.id),n.append("rect").attr("fill","white"),n.append("rect").attr("fill","black"),e.selectedFrameMaskElem=n.node()),i.options.barSelectionFramesShownWithHigherZOrder&&t.classed(Qe,!0);var s=(i.options.barSelectionFramesShownWithHigherZOrder?i._barSelectionFramesD3[o].append("rect"):t.insert("rect",":first-child")).attr("class","ngantt-selected-bar").attr("filter","url(#ngantt-blur-filter"+i._uniqueID+")");i._positionSelectionFrame(e,s,n,a),i.options.barSelectionFramesShownWithHigherZOrder&&!e.rowDataItem.visibleRowDataItem.entered&&(e.rowDataItem.oldVisibleRowDataItem&&e.rowDataItem.visibleRowDataItem!==e.rowDataItem.oldVisibleRowDataItem||e.rowDataItem.visibleRowDataItem.oldY!==e.rowDataItem.visibleRowDataItem.newY)&&(s.attr("visibility","hidden"),window.setTimeout((function(){e.selected&&(a=i._determineSelectionFrameExtent(e),i._positionSelectionFrame(e,s,n,a),r.select(e.selectedFrameElem).attr("visibility",null))}),i.options.transitionDuration+50)),n&&s.attr("mask","url(#ngantt-selected-bar-mask-"+e.id+")"),e.selectedFrameElem=s.node()}}},_determineSelectionFrameExtent:function(e){"use strict";var t=this,i=t._determineTimeDataItemExtent(e,void 0,void 0,!0);if(i){var a=e.rowDataItem.visibleRowDataItem,n=a.subRowDataItems[e.subRowIndex],r=t.convertXToLimitedX(i.left),o=i.top,s=r,l=o;if(t._worldViewDivJQ&&(n&&(l+=n.offsetY-n.minimumY),l+=t.determineActualRowMargins().top),t.options.barSelectionFramesShownWithHigherZOrder)n&&(o+=n.offsetY-n.minimumY),o+=t.determineActualRowMargins().top+(null!=a.oldY?a.oldY:a.newY);else{var c=t._determineTimeDataItemExtent(e);r-=t.convertXToLimitedX(c.left)}var d=t.convertXToLimitedX(i.outerRight)-t.convertXToLimitedX(i.outerLeft),m=i.bottom-i.top;return{x:r,y:o,w:d,h:m,worldViewX:s,worldViewY:l,xplus:-t._barFrameDistance+r,yplus:-2*t._barFrameDistance+o,wplus:d+2*t._barFrameDistance,hplus:m+4*t._barFrameDistance,xoffset:t.convertXToLimitedX(i.outerLeft)-t.convertXToLimitedX(i.left)}}},_positionSelectionFrame:function(e,t,i,a){"use strict";if(a){var n=this;if(i&&(i.select("rect:nth-child(1)").attr("x",a.xplus-St).attr("y",a.yplus-St).attr("width",a.wplus+200).attr("height",a.hplus+200),i.select("rect:nth-child(2)").attr("x",a.x).attr("y",a.y).attr("width",a.w).attr("height",a.h)),t.attr("transform","translate("+a.xoffset+")").attr("x",a.xplus).attr("y",a.yplus).attr("width",a.wplus).attr("height",a.hplus),n._worldViewDivJQ){var r=e.rowDataItem.visibleRowDataItem;r.worldViewSelectionCacheMap||(r.worldViewSelectionCacheMap={});var o=n._getTopOfRowDataItemForWorldView(r);r.worldViewSelectionCacheMap["T"+e.id]={method:"drawRect",args:[{left:n.actualTableWidth()+a.worldViewX,leftPx:1,top:o.top+a.worldViewY,topPx:o.topPx,width:a.w,height:a.h}]},n._renderCachedRowInWorldView(r,"S")}}},_removeSelectionFrameOfTimeDataItem:function(e){"use strict";var t=this;if(e.elem&&(e.rowDataItem&&t._checkForVisibilityOfUnselectedRowCover(e.rowDataItem.visibleRowDataItem),e.highlighted&&t._moveSelectedBar(e,r.select(e.elem),!1),r.select(e.elem).classed(Qe,!1)),r.select(e.selectedFrameElem).remove(),r.select(e.selectedFrameMaskElem).remove(),delete e.selectedFrameElem,delete e.selectedFrameMaskElem,e.rowDataItem){var i=e.rowDataItem.visibleRowDataItem;i.worldViewSelectionCacheMap&&delete i.worldViewSelectionCacheMap["T"+e.id],t._worldViewDivJQ&&t._renderCachedRowInWorldView(i,"S")}},_isAnyItemSelected:function(){"use strict";var e=this;return Object.keys(e._selectedRowDataItemsMap).length||e._selectedTimeItems.length||Object.keys(e._selectedLinkDataItemsMap).length},isTimeItemSelected:function(e){"use strict";try{w.assertNotNull(e,"",0);var t=this._getDataItem(e,this._timeDataItemsMap);return this._isTimeDataItemSelected(t)}catch(e){this._handleException(e,"isTimeItemSelected")}},_isTimeDataItemSelected:function(e){"use strict";if(e){for(var t=e;t.parentTimeDataItem;)t=t.parentTimeDataItem;return!!t.selected}},selectedTimeItems:function(e){"use strict";try{w.assertArrayOrNull(e,"",0);var t=this;if(void 0===e){var i=[],a=!1;return t._selectedTimeItems.forEach((function(e){t._getDataItem(e,t._timeDataItemsMap)?i.push(e):a=!0})),a&&this._changeTimeItemSelection(i),i}if(t.options.timeItemsSelectable){var n=e;Array.isArray(e)&&(n=[],e.forEach((function(e){var i=t._getDataItem(e,t._timeDataItemsMap);if(i){for(var a=i;a.parentTimeDataItem;)a=a.parentTimeDataItem;n.push(a.item)}}))),t.options.timeItemsHaveSameReferenceAsRowItems||t._changeRowItemSelection([]),t._changeLinkItemSelection([]),t._changeTimeItemSelection(n),t._barDragging.isActive()&&t._barDragging.isDropped()||t.update()}}catch(e){this._handleException(e,"selectedTimeItems")}},_registerBackgroundPanningEvents:function(){"use strict";var e=this;e._backgroundBodyScrollParentD3.classed(m.PRESS_PAN_EVENT_CLASS_NAME,e.options.timeItemsSelectableByRectangle).classed(m.PAN_EVENT_CLASS_NAME,e.options.timeItemsSelectableByRectangle),e._svgRootD3.classed(m.PAN_EVENT_CLASS_NAME,!e.options.rowItemsDraggable&&!e.options.timeItemsSelectableByRectangle),e.options.timeItemsSelectableByRectangle?n(window).on("keydown.ngantt"+e._uniqueID+"-rectselect keyup"+qe+e._uniqueID+"-rectselect",(function(t){e._checkModifierKeysForBarSelectionByRectangle(t)})):n(window).off("keydown.ngantt"+e._uniqueID+"-rectselect keyup"+qe+e._uniqueID+"-rectselect")},_checkModifierKeysForBarSelectionByRectangle:function(e){"use strict";try{var t=this;t._cachedHammerEventForSelectionByRect&&(p.isMacOrIOS?91===e.keyCode||93===e.keyCode||224===e.keyCode:17===e.keyCode)&&(t._cachedHammerEventForSelectionByRect.srcEvent=e,t._dragBarSelectionRectangle(t._cachedHammerEventForSelectionByRect))}catch(e){this._handleException(e,"onKeyDown_selectionRect")}},_checkBarSelectionRectangleEvents:function(e){"use strict";var t=this;switch(e.type){case m.PRESS_EVENT_NAME:t._pressOnDiagramActive="touch"===e.pointerType,t._pressOnDiagramActive?t._temporaryMarkVisible=void 0:e[m.CANCEL_PROPERTY]=!0;break;case m.PRESS_EVENT_NAME+"up":if(t._pressOnDiagramActive=!1,t._finishBarSelectionRectangle(e,!0),"touch"===e.pointerType&&t.options.onEventFunc){var i=t.options.contextMenuEventOnRowItemInTimeArea&&t._findRowDataItemAtY(e.center.y);i?t._triggerEvent(t._extendCallbackArgs({sender:i.item,elem:i.foregroundRowElem,elemType:$e.Row,eventType:"contextmenu",event:e.srcEvent,hammerEvent:e})):t._triggerEvent(t._extendCallbackArgs({sender:"TimeAreaBackground",eventType:"contextmenu",event:e.srcEvent,hammerEvent:e})),t.options.preventDefaultOnContextMenuEvents&&(e.stopPropagation(),e.preventDefault())}break;case m.PAN_EVENT_NAME+"start":("mouse"===e.pointerType||t._pressOnDiagramActive)&&t._startDraggingBarSelectionRectangle(e)||(e[m.CANCEL_PROPERTY]=!0),t._pressOnDiagramActive=!1;break;case m.PAN_EVENT_NAME+"move":t._dragBarSelectionRectangle(e);break;case m.PAN_EVENT_NAME+"end":t._finishBarSelectionRectangle(e,!1);break;case m.PAN_EVENT_NAME+"cancel":t._finishBarSelectionRectangle(e,!0)}},_startDraggingBarSelectionRectangle:function(e){"use strict";var t=this;c.setCursor(t.element[0],"crosshair");var i=t._pointToSVGRelative(t._svgRootD3.node(),e.center.x,e.center.y),a=i.y>=t._actualTitleHeight(J)+t._layoutRows[Y].innerViewExtent()?1:0;if(a&&(i.y-=t._layoutRows[Y].innerViewExtent()+t._actualBodyAreaSeparatorHeight()),i.y+=-t._actualTitleHeight(J)+t._layoutRows[a].scrollStart(),i.x<t._layoutColumns[X]+t.options.splitterWidth)return!1;if(t._phantomsBodyD3s[a].append("g").attr("class",oe).attr("transform","translate("+i.x+","+i.y+")").append("g").attr("transform","scale("+1/t.options.visualZoomFactor+")").append("rect"),t._temporaryTimeAreaViewScrollOffsetForBarSelection=t._timeAxis.timeAreaViewScrollOffset(),t._temporaryHorizontalBodyAreaIndexForBarSelection=a,t.options.selectedItemsShownHighlighted||"touch"===e.pointerType!==(p.isMacOrIOS?e.srcEvent.metaKey:e.srcEvent.ctrlKey)?(t._temporarilySelectedTimeDataItemsByRect=[],t._selectedTimeItems.forEach((function(e){var i=t._getDataItem(e,t._timeDataItemsMap);i&&i.rowDataItem&&t._isItemAtTheTop(i.rowDataItem.item)===!a&&t._temporarilySelectedTimeDataItemsByRect.push(i)}))):t._selectedTimeItems.forEach((function(e){var i=t._getDataItem(e,t._timeDataItemsMap);i&&i.elem&&t._removeSelectionFrameOfTimeDataItem(i)})),!t.options.timeItemsHaveSameReferenceAsRowItems){var n=t.selectedRowItems();n.length&&n.forEach((function(e){var i=t._getDataItem(e,t._rowDataItemsMap);i&&i.foregroundRowElem&&r.select(i.foregroundRowElem).selectAll(".ngantt-table-row-selected").remove()}))}return t.options.canSelectTimeItemFuncResultsCacheable&&(t._temporaryTimeDataItemIDToSelectionAllowedMap={}),!0},_dragBarSelectionRectangle:function(e,t){"use strict";var i=this,a=this._pointToSVGRelative(this._svgRootD3.node(),e.center.x,e.center.y);i._temporaryHorizontalBodyAreaIndexForBarSelection?a.y+=-i._actualTitleHeight(J)-i._layoutRows[Y].innerViewExtent()-i._actualBodyAreaSeparatorHeight()+i._layoutRows[z].scrollStart():a.y+=-i._actualTitleHeight(J)+i._layoutRows[Y].scrollStart(),a.x=Math.max(a.x,i._layoutColumns[X].innerViewExtent()+i.options.splitterWidth+1);var o=this._phantomsBodyD3s[i._temporaryHorizontalBodyAreaIndexForBarSelection].select(".ngantt-bar-selection");if(0!==!o.size){var l=s(o.attr("transform")),c=o.select("rect");if(t){var d=i._timeAxis.timeAreaViewScrollOffset();l.translate[0]+=i._temporaryTimeAreaViewScrollOffsetForBarSelection-d,o.attr("transform",l.toString()),i._temporaryTimeAreaViewScrollOffsetForBarSelection=d}var u=!(2==i.options.timeItemsSelectableByRectangle)||l.translate[0]>a.x,h=a.x-l.translate[0],p=a.y-l.translate[1];c.attr("x",h>=0?0:h*i.options.visualZoomFactor).attr("y",p>=0?0:p*i.options.visualZoomFactor).attr("width",Math.abs(h)*i.options.visualZoomFactor).attr("height",Math.abs(p)*i.options.visualZoomFactor).classed("ngantt-bar-selection-partially",u).classed("ngantt-bar-selection-fully",!u);var _=i._findTimeDataItemsInRect({x:l.translate[0],y:l.translate[1]},{x:a.x,y:a.y},u),f=i._isCtrlKeyPressed(e);f&&i._selectedTimeItems.forEach((function(e){var t=i._getDataItem(e,i._timeDataItemsMap,i._unusedTimeDataItemsMap);if(t){var a=_.indexOf(t);a<0?_.push(t):_.splice(a,1)}}));var g,T=_.slice();if(i._temporarilySelectedTimeDataItemsByRect&&(i._temporarilySelectedTimeDataItemsByRect.forEach((function(e){var t=T.indexOf(e);t>=0&&T.splice(t,1)})),g=i._temporarilySelectedTimeDataItemsByRect.slice(),_.forEach((function(e){var t=g.indexOf(e);t>=0&&g.splice(t,1)}))),T.length&&i.options.canSelectTimeItemFunc){var D=i._temporarilySelectedTimeDataItemsByRect?i._temporarilySelectedTimeDataItemsByRect.slice():[];g&&g.forEach((function(e){D.splice(D.indexOf(e),1)})),T.slice().forEach((function(t){var a=!0;if(i._temporaryTimeDataItemIDToSelectionAllowedMap&&t.id in i._temporaryTimeDataItemIDToSelectionAllowedMap)a=i._temporaryTimeDataItemIDToSelectionAllowedMap[t.id];else{var n=i._extendCallbackArgs({timeItem:t.item,otherSelectedTimeItems:D.map((function(e){return e.item})),altKey:e.srcEvent.altKey,shiftKey:e.srcEvent.shiftKey,metaKey:f,ctrlKey:f,event:e.srcEvent,hammerEvent:e,canSelect:!0});i.options.canSelectTimeItemFunc.call(i,n),i._temporaryTimeDataItemIDToSelectionAllowedMap&&(i._temporaryTimeDataItemIDToSelectionAllowedMap[t.id]=n.canSelect),a=n.canSelect}a?D.push(t):T.splice(T.indexOf(t),1)})),_=D}i._temporarilySelectedTimeDataItemsByRect=_,i._cachedHammerEventForSelectionByRect=n.extend({},e),T.forEach((function(e){e&&i._prependBarSelectedRect(e,r.select(e.elem))})),g&&g.forEach((function(e){i._removeSelectionFrameOfTimeDataItem(e)})),t||i._checkForAutoscroll(e.center.x,e.center.y,!0,!0,(function(){i._dragBarSelectionRectangle(e,!0)}))}else e[m.CANCEL_PROPERTY]=!0},_finishBarSelectionRectangle:function(e,t){"use strict";var i=this;if(e||(t=!0),c.setCursor(i.element[0],null),i._stopAutoscroll(),void 0!==i._temporaryTimeAreaViewScrollOffsetForBarSelection&&(this._phantomsBodyD3s[i._temporaryHorizontalBodyAreaIndexForBarSelection].select(".ngantt-bar-selection").remove(),i._temporarilySelectedTimeDataItemsByRect&&i._temporarilySelectedTimeDataItemsByRect.forEach((function(e){i._removeSelectionFrameOfTimeDataItem(e)})),i._selectedTimeItems.forEach((function(e){var t=i._getDataItem(e,i._timeDataItemsMap);t&&i._prependBarSelectedRect(t,r.select(t.elem))})),!t)){var a=i._isCtrlKeyPressed(e),n=[];if(i._temporarilySelectedTimeDataItemsByRect&&i._temporarilySelectedTimeDataItemsByRect.forEach((function(e){n.push(e.item)})),i.options.selectTimeItemFunc){var o=i._extendCallbackArgs({timeItem:n[0],oldSelectedRowItems:i.selectedRowItems(),oldSelectedItems:i._selectedTimeItems.slice(),newSelectedItems:n,altKey:e.srcEvent.altKey,shiftKey:e.srcEvent.shiftKey,metaKey:a,ctrlKey:a,event:e.srcEvent,hammerEvent:e,cancel:!1});i.options.selectTimeItemFunc.call(i,o),!o.cancel&&Array.isArray(o.newSelectedItems)||(t=!0)}t||(i.options.timeItemsHaveSameReferenceAsRowItems||!o.newSelectedItems.length||i.options.timeItemsHaveSameReferenceAsRowItems||i._changeRowItemSelection([]),this._changeLinkItemSelection([]),i._changeTimeItemSelection(o.newSelectedItems),i.update())}t&&!i.options.timeItemsHaveSameReferenceAsRowItems&&i._updateAllRowSelections(),delete i._temporaryTimeAreaViewScrollOffsetForBarSelection,delete i._temporarilySelectedTimeDataItemsByRect,delete i._cachedHammerEventForSelectionByRect,delete i._temporaryTimeDataItemIDToSelectionAllowedMap,delete i._temporaryHorizontalBodyAreaIndexForBarSelection},_findTimeDataItemsInRect:function(e,t,i){"use strict";var a=this,n=a._temporaryTimeAreaViewScrollOffsetForBarSelection,r=a.actualTableViewWidth(),o={left:Math.min(e.x,t.x)-r-a._actualSplitterWidth()+n,right:Math.max(e.x,t.x)-r-a._actualSplitterWidth()+n,top:Math.min(e.y,t.y),bottom:Math.max(e.y,t.y)},s=[];return a._determineRowDataItems(!0,void 0,a._temporaryHorizontalBodyAreaIndexForBarSelection).forEach((function(e){if(e.newY>o.bottom)return!1;e.newY+e.totalHeight>=o.top&&a._findTimeDataItemsInRowRecursively(e,s,o,i,!0)})),s},_findTimeDataItemsInRowRecursively:function(e,t,i,a,n){"use strict";var r=this;Array.isArray(e.item.timeItems)&&e.item.timeItems.forEach((function(e){if(!1!==e.selectable){var n=r._getDataItem(e,r._timeDataItemsMap),o=r._determineTimeDataItemExtent(n,void 0,void 0,!0),s=n.newY+n.rowDataItem.visibleRowDataItem.newY+o.top,l=n.newY+n.rowDataItem.visibleRowDataItem.newY+o.bottom;(a?i.right>=o.outerLeft&&i.left<=o.outerRight&&i.bottom>=s&&i.top<=l:i.left<=o.outerLeft&&i.right>=o.outerRight&&i.top<=s&&i.bottom>=l)&&t.push(n)}})),e.isLeaf||["leafRowDataItems","childRowDataItems"].forEach((function(o,s){(!n||e[s?"isCollapsed":"areLeavesCollapsed"]&&r._getCurrentlyDisplayedElementsInRow(e)&(s?tt.BarsOfCollapsedChildRows:tt.BarsOfCollapsedLeafRows))&&Array.isArray(e[o])&&e[o].forEach((function(e){r._findTimeDataItemsInRowRecursively(e,t,i,a,!1)}))}))},_changeLinkItemSelection:function(e){"use strict";var t,i,a=this,n={};for(i=0;i<e.length;i++)e[i]&&(t=a._getDataItem(e[i],a._linkDataItemsMap))&&(n[t.id]=t);var r=Object.keys(a._selectedLinkDataItemsMap);for(i=0;i<r.length;i++)n[(t=a._selectedLinkDataItemsMap[r[i]]).id]||(delete t.selected,t.version++,delete a._selectedLinkDataItemsMap[r[i]]);var o=Object.keys(n);for(i=0;i<o.length;i++){var s=(t=n[o[i]]).item.selectable;(null==s?a.options.defaultLinkItemSelectable:s)&&(a._selectedLinkDataItemsMap[t.id]||(t.selected=!0,a._selectedLinkDataItemsMap[t.id]=t,t.version++))}},_selectLink:function(e,t){"use strict";var i,a,n,r=this,o=r.selectedLinkItems(),s=o.slice(),l=r._isCtrlKeyPressed(t);if(l){if(r._selectedTimeItems.length)return;if(r._selectedLinkDataItemsMap[e.id]){var c=s.indexOf(e.item);c>-1&&s.splice(c,1)}else a=s.slice(),s.push(e.item),i=!0}else r.options.canSelectLinkItemFunc&&o.indexOf(e.item)<0&&(a=[],i=!0),s=[e.item];if(r._suspendForSelect=!0,i&&r.options.canSelectLinkItemFunc){var d=r._extendCallbackArgs({linkItem:e.item,otherSelectedLinkItems:a,altKey:t.srcEvent.altKey,shiftKey:t.srcEvent.shiftKey,metaKey:l,ctrlKey:l,event:t.srcEvent,hammerEvent:t,canSelect:!0});r.options.canSelectLinkItemFunc.call(r,d),d.canSelect||(n=!0)}if(!n&&r.options.selectLinkItemFunc){d=r._extendCallbackArgs({linkItem:e.item,oldSelectedTimeItems:r._selectedTimeItems.slice(),oldSelectedRowItems:r.selectedRowItems(),oldSelectedItems:r.selectedLinkItems(),newSelectedItems:s,altKey:t.srcEvent.altKey,shiftKey:t.srcEvent.shiftKey,metaKey:l,ctrlKey:l,event:t.srcEvent,hammerEvent:t,cancel:!1});r.options.selectLinkItemFunc.call(r,d),d.cancel?n=!0:s=Array.isArray(d.newSelectedItems)?d.newSelectedItems:[]}delete r._suspendForSelect,n||r.selectedLinkItems(s)},isLinkItemSelected:function(e){"use strict";try{w.assertNotNull(e,"",0);var t=this,i=t._getDataItem(e,t._linkDataItemsMap);if(i)return null!=t._selectedLinkDataItemsMap[i.id]}catch(e){this._handleException(e,"isLinkItemSelected")}},selectedLinkItems:function(e){"use strict";try{w.assertArrayOrNull(e,"",0);var t=this;if(void 0===e)return Object.keys(t._selectedLinkDataItemsMap).map((function(e){return t._selectedLinkDataItemsMap[e].item}));t.options.linkItemsSelectable&&(t._changeTimeItemSelection([]),t._changeRowItemSelection([]),t._changeLinkItemSelection(e),t.update())}catch(e){this._handleException(e,"selectedLinkItems")}},_removeLinks:function(e){"use strict";var t=this;e.each((function(e){e.selectedLinkElem&&(n(e.selectedLinkElem).data(m.HANDLER_FUNCTION_PROPERTY+qe+t._uniqueID,null),r.select(e.selectedLinkElem).remove(),e.selectedLinkElem=void 0),n(this).off(qe+t._uniqueID),e.elem=void 0,r.select(e.hotRegionElem).remove(),n(e.hotRegionElem).data(m.HANDLER_FUNCTION_PROPERTY+qe+t._uniqueID,null),e.hotRegionElem=void 0})).remove()},_createAndUpdateAllLinks:function(e){"use strict";var t=this,i=[],a=t._calculateVisibleVerticalBodyRangeForVirtualization(z);t.options.linksVisible&&Object.keys(t._linkDataItemsMap).forEach((function(e){var n=t._linkDataItemsMap[e],r=n.sourceTimeDataItem?n.sourceTimeDataItem.rowDataItem:void 0,o=n.targetTimeDataItem?n.targetTimeDataItem.rowDataItem:void 0;if(r&&!t._isItemAtTheTop(r.item)&&r.visibleRowDataItem.arrayIndex>=0&&o&&!t._isItemAtTheTop(o.item)&&o.visibleRowDataItem.arrayIndex>=0){var s=t._isTimeDataItemVisible(n.sourceTimeDataItem)&&0!==r.totalHeight,l=t._isTimeDataItemVisible(n.targetTimeDataItem)&&0!==o.totalHeight;if(t.options.linksWithDanglingBarsVisible?s||l:s&&l){var c=r.newY,d=o.newY,m=c+r.totalHeight,u=d+o.totalHeight,h=m<a.top?-1:c>a.bottom?1:0;h===(u<a.top?-1:d>a.bottom?1:0)&&h||i.push(n)}}}));var o=t._linksD3.selectAll(".ngantt-link").data(i,(function(e){return e.id+"_"+e.version})),s=o.enter().append("g").attr("class",(function(e){return t._enrichClass(e,Le,{elemType:$e.Link})}));this.options.linksWithDanglingBarsVisible&&s.each((function(){r.select(this).append("circle").attr("class",(function(e){return t._enrichClass(e,"ngantt-link-dangling-bar ngantt-link-dangling-source-bar",{elemType:$e.LinkDanglingSourceBar})})).attr("r","6").attr("visibility","hidden"),r.select(this).append("circle").attr("class",(function(e){return t._enrichClass(e,"ngantt-link-dangling-bar ngantt-link-dangling-target-bar",{elemType:$e.LinkDanglingTargetBar})})).attr("r","6").attr("visibility","hidden")})),s.append("path").attr("class",(function(e){return t._enrichClass(e,Be,{elemType:$e.LinkPath})})),s.each((function(e){var i="ngantt-link-hot-region "+m.CONTEXTMENU_EVENT_CLASS_NAME+" "+m.PRESS_EVENT_CLASS_NAME+" "+m.TAP_EVENT_CLASS_NAME+" "+m.DOUBLE_TAP_EVENT_CLASS_NAME,a=t._linkHotRegionsD3.append("g").attr("class",i);if(a.append("path"),e.hotRegionElem=a.node(),n(e.hotRegionElem).data(m.HANDLER_FUNCTION_PROPERTY+qe+t._uniqueID,(function(i){try{switch(i.type){case m.CONTEXTMENU_EVENT_NAME:t.options.onEventFunc&&(t._setBarInteractionCursor(rt.None),t._triggerEvent(t._extendCallbackArgs({sender:e.item,eventType:"contextmenu",elemType:$e.Link,event:i}))),t.options.preventDefaultOnContextMenuEvents&&(i.stopPropagation(),i.preventDefault());break;case m.PRESS_EVENT_NAME+"up":t.options.onEventFunc&&"touch"===i.pointerType&&(t._setBarInteractionCursor(rt.None),t._triggerEvent(t._extendCallbackArgs({sender:e.item,eventType:"contextmenu",elemType:$e.Link,event:i.srcEvent,hammerEvent:i})));break;case m.TAP_EVENT_NAME:t.options.onEventFunc&&t._triggerEvent(t._extendCallbackArgs({sender:e.item,eventType:"tap",elem:this,elemType:$e.Link,event:i.srcEvent,hammerEvent:i}));var a=e.item.selectable;(null==a?t.options.defaultLinkItemSelectable:a)&&t._selectLink(e,i);break;case m.DOUBLE_TAP_EVENT_NAME:t.options.onEventFunc&&t._triggerEvent(t._extendCallbackArgs({sender:e.item,eventType:"doubletap",elem:this,elemType:$e.Link,event:i.srcEvent,hammerEvent:i}))}}catch(e){t._handleException(e,"onEventDispatch_link")}})),!t.options.isForExport){var o=n(r.select(e.hotRegionElem).select("path").node());o.on("mouseenter.ngantt"+t._uniqueID,(function(i){try{t._onmouseenter_cursor(i,this,Le),t.isInInteraction()||(t._triggerEvent(t._extendCallbackArgs({sender:e.item,event:i,eventType:"tooltip",elem:this,elemType:$e.Link})),n(window).on("mousemove.ngantt"+t._uniqueID+"_"+e.id,(function(i){try{i.target!==o[0]&&i.target!==e.elem&&(n(window).off("mousemove.ngantt"+t._uniqueID+"_"+e.id),!t.options.onEventFunc||t._lastMouseEnterElem!==o[0]&&t._lastMouseEnterElem!==e.elem||t._triggerEvent(t._extendCallbackArgs({sender:null,eventType:"tooltip",elem:null,event:i})))}catch(e){t._handleException(e,"onMouseLeave_link")}})))}catch(e){t._handleException(e,"onMouseEnter_link")}}))}}));var l=r.timeFormat?s.merge(o):o;l.each((function(e){if(e.selected&&!e.selectedLinkElem){var i=t._selectedLinksD3.append("path").attr("class","ngantt-selected-link "+m.CONTEXTMENU_EVENT_CLASS_NAME+" "+m.PRESS_EVENT_CLASS_NAME+" "+m.TAP_EVENT_CLASS_NAME+" "+m.DOUBLE_TAP_EVENT_CLASS_NAME).node();e.selectedLinkElem=i,n(i).data(m.HANDLER_FUNCTION_PROPERTY+qe+t._uniqueID,(function(i){n(e.hotRegionElem).data(m.HANDLER_FUNCTION_PROPERTY+qe+t._uniqueID)(i)}))}else!e.selected&&e.selectedLinkElem&&(n(e.selectedLinkElem).data(m.HANDLER_FUNCTION_PROPERTY+qe+t._uniqueID,null),r.select(e.selectedLinkElem).remove(),e.selectedLinkElem=void 0)})),this.options.linkMarkersVisible&&s.each((function(e){var i=r.select(this);(null!=e.item.targetMarker?e.item.targetMarker:t.options.defaultLinkTargetMarker)!==ct.None&&i.append("path").attr("class",(function(e){return t._enrichClass(e,Oe,{elemType:$e.LinkTargetMarker})}))}));var c=[];l.each((function(i){var a=r.select(this);[i.sourceTimeDataItem,i.targetTimeDataItem].forEach((function(e){e&&t._getDataItem(e.id,t._timeDataItemsMap)&&(c[e.id]||(c[e.id]=!0,e.elem&&e.elem.parentElement&&!e.isHiddenByLimits&&0!==e.rowDataItem.totalHeight&&t._isTimeDataItemVisible(e)||t._positionBar(null,e,2)))})),t._positionLink(a,i,e),i.elem=this})),t._removeLinks(o.exit())},_doDetermineLinkInfo:function(e,t){"use strict";var i,a=e.sourceTimeDataItem,n=e.targetTimeDataItem,r=a.rowDataItem.visibleRowDataItem,o=n.rowDataItem.visibleRowDataItem,s=r.newY+a.newY,l=o.newY+n.newY,c=this._getActualBarHeight(a),d=this._getActualBarHeight(n),m=e.item.type||this.options.defaultLinkType||lt.EndStart;m!==lt.EndStart&&m!==lt.EndEnd||a.item.linkSourceDate instanceof Date&&(i=this._timeAxis.convertDateToX(a.item.linkSourceDate))===a.newEndX&&(i=void 0);var u,h=void 0!==i;m!==lt.EndStart&&m!==lt.EndEnd||n.item.linkTargetDate instanceof Date&&(u=this._timeAxis.convertDateToX(n.item.linkTargetDate));var p,_=void 0!==u,f={type:m};switch(m){case lt.StartStart:f.source={x:a.newX,y:l>=s?s+c:s+this.options.barCornerWidth,portDirection:l>=s?I.Down:I.Up},p=n.newX-a.newX,f.target=p>=t?{x:n.newX,y:l+d/2,portDirection:I.Left}:{x:n.newX,y:l>=s?l+this.options.barCornerWidth:l+d,portDirection:l>=s?I.Up:I.Down};break;case lt.StartEnd:f.source={x:a.newX,y:l>=s?s+c:s+this.options.barCornerWidth,portDirection:l>=s?I.Down:I.Up},f.target={x:n.newEndX,y:l>=s?l:l+d,portDirection:l>=s?I.Up:I.Down};break;case lt.EndStart:p=n.newX-a.newEndX,h||p<t&&s!==l?(f.source={x:h?i:a.newEndX,y:l>=s?s+c:s,portDirection:l>=s?I.Down:I.Up},f.target=s<l+d&&l<s+c?{x:_?u:n.newX,y:l>=s?l+d:l+this.options.barCornerWidth/2,portDirection:l>=s?I.Down:I.Up}:{x:_?u:n.newX,y:l>=s?l+this.options.barCornerWidth/2:l+d,portDirection:l>=s?I.Up:I.Down}):(f.source={x:a.newEndX,y:s+c/2,portDirection:I.Right},f.target={x:n.newX,y:l+d/2,portDirection:I.Left});break;case lt.EndEnd:p=n.newEndX-a.newEndX,h||p<t?(f.source={x:h?i:a.newEndX,y:l>=s?s+c:s,portDirection:l>=s?I.Down:I.Up},f.target=s<l+d&&l<s+c?{x:n.newEndX,y:l>=s?l+d:l,portDirection:l>=s?I.Down:I.Up}:{x:n.newEndX,y:l>=s?l:l+d,portDirection:l>=s?I.Up:I.Down}):(f.source={x:a.newEndX,y:s+c/2,portDirection:I.Right},f.target={x:n.newEndX,y:l>=s?l:l+d,portDirection:l>=s?I.Up:I.Down})}return r.subRowDataItems[a.subRowIndex]&&(f.source.allocatedTimeSpans=r.subRowDataItems[a.subRowIndex].timeSpans),o.subRowDataItems[n.subRowIndex]&&(f.target.allocatedTimeSpans=o.subRowDataItems[n.subRowIndex].timeSpans),f.source.y&&(f.source.yAbove=s-this.options.verticalLinkDistance,f.source.yBelow=s+c+this.options.verticalLinkDistance),f.target.y&&(f.target.yAbove=l-this.options.verticalLinkDistance,f.target.yBelow=l+d+this.options.verticalLinkDistance),f.routingType=e.item.routingType,this.options.linksWithDanglingBarsVisible&&(0===r.totalHeight?(f.source.y=r.newY,f.source.yAbove=r.newY,f.source.yBelow=r.newY):this._isTimeDataItemVisible(a)||(f.source.y=f.source.y-6,f.source.yAbove=f.source.y,f.source.yBelow=f.source.y),0===o.totalHeight?(f.target.y=o.newY,f.target.yAbove=o.newY,f.target.yBelow=o.newY):this._isTimeDataItemVisible(n)||(f.target.y=f.target.y-6,f.target.yAbove=f.target.y,f.target.yBelow=f.target.y)),f},_positionLink:function(e,t,i){"use strict";var a=this;switch(void 0!==t.item.routingType?t.item.routingType:this._linkRouter.options.routingType){case A.Orthogonal:this.options.linkMarkersVisible&&(null!=t.item.targetMarker?t.item.targetMarker:a.options.defaultLinkTargetMarker)!==ct.None?(this._linkRouter.options.sourcePortSectionExtent=0,this._linkRouter.options.targetPortSectionExtent=10):(this._linkRouter.options.sourcePortSectionExtent=5,this._linkRouter.options.targetPortSectionExtent=5);break;default:this.options.linkMarkersVisible&&(null!=t.item.targetMarker?t.item.targetMarker:a.options.defaultLinkTargetMarker)!==ct.None?(this._linkRouter.options.sourcePortSectionExtent=0,this._linkRouter.options.targetPortSectionExtent=5):(this._linkRouter.options.sourcePortSectionExtent=0,this._linkRouter.options.targetPortSectionExtent=0)}var n=this._doDetermineLinkInfo(t,this._linkRouter.options.sourcePortSectionExtent+this._linkRouter.options.targetPortSectionExtent+5),o=this._linkRouter.determinePath(n);a.options.linksWithDanglingBarsVisible&&(e.selectAll("circle.ngantt-link-dangling-source-bar").attr("cx",a.convertXToLimitedX(n.source.x)).attr("cy",n.source.y).attr("visibility",0!==t.sourceTimeDataItem.rowDataItem.totalHeight&&a._isTimeDataItemVisible(t.sourceTimeDataItem)?"hidden":null),e.selectAll("circle.ngantt-link-dangling-target-bar").attr("cx",a.convertXToLimitedX(n.target.x)).attr("cy",n.target.y).attr("visibility",0!==t.targetTimeDataItem.rowDataItem.totalHeight&&a._isTimeDataItemVisible(t.targetTimeDataItem)?"hidden":null));var s=0;n.target.portDirection===I.Up?s=90:n.target.portDirection===I.Right?s=180:n.target.portDirection===I.Down&&(s=270),e.select(".ngantt-link-target-marker").attr("d","M0,0l-5,-3v6L0,0");var l=a.getCurrentLowerXLimit(),c=a.getCurrentUpperXLimit(),d=n.source.x<l&&n.target.x<l||n.source.x>=c&&n.target.x>=c?"hidden":null,m=e.select(".ngantt-link-path"),u=r.select(t.hotRegionElem),h=t.selectedLinkElem?r.select(t.selectedLinkElem):null;(m.attr("d")!==o||h&&h.attr("d")!==o)&&(t.elem&&i!==pt.LinkItemsChanged&&i!==pt.TimeAxisChanged&&"hidden"!==d?(t.transitionActive=!0,a._cacheTransitionFunction((function(){t.transitionActive&&(e.select(".ngantt-link-path").transition().duration(a.options.transitionDuration).attr("d",o),h&&h.transition().duration(a.options.transitionDuration).attr("d",o),u.select("path").transition().duration(a.options.transitionDuration).attr("d",o),e.select(".ngantt-link-target-marker").transition().duration(a.options.transitionDuration).attr("transform","translate("+a.convertXToLimitedX(n.target.x)+","+n.target.y+") rotate("+s+")"))}))):(delete t.transitionActive,e.select(".ngantt-link-path").attr("d",o).interrupt().transition(),u.select("path").attr("d",o).interrupt().transition(),h&&h.attr("d",o).interrupt().transition(),e.select(".ngantt-link-target-marker").attr("transform","translate("+a.convertXToLimitedX(n.target.x)+","+n.target.y+") rotate("+s+")").interrupt().transition(),"hidden"===d||i!==pt.RowExpanded&&i!==pt.RowLeavesExpanded||(d="hidden",window.setTimeout((function(){e.attr("visibility",null),u.attr("visibility",null),h&&h.attr("visibility",null)}),a.options.transitionDuration)))),e.attr("visibility",d),u.attr("visibility",d),h&&h.attr("visibility",d),a.options.positionLinkFunc&&a.options.positionLinkFunc.call(a,a._extendCallbackArgs({linkItem:t.item,elem:e.node()}))},_createTableRow:function(e,t,i,a){"use strict";var n=a===pt.WorldView?void 0:t.append("g").attr("class",this.NXXXXX.TABLE_ROW_CLASS);this._PE_CreateTableRow_222(e,n,i,a,$e.TableRow)},_PE_determineTableCellWidth:function(e){"use strict";return Math.max(0,Math.max(this.actualTableWidth(),this.actualTableViewWidth())-this._fixedTableColumnsWidthSucceeding-e)},_PE_LastColumnResult:function(){return!0},_PE_Decision111:function(){return!0},_PE_ColumnIndexResult:function(e){return e},addDateLine:function(e){"use strict";try{w.assertNotNull(e,"",0);if(e.id){if(this._dateLineIDsToSVGElementsMap[e.id])return;Array.isArray(this.options.dateLines)||(this.options.dateLines=[]),this.options.dateLines.push(e),this._createDateLine(!1!==e.inForeground?this._foregroundDateLinesD3:this._backgroundDateLinesD3,e)}}catch(e){this._handleException(e,"addDateLine")}},addRowDateLine:function(e){"use strict";try{w.assertNotNull(e,"",0);var t,i,a=this;if(e.timeItem&&(t=a._getDataItem(e.timeItem,a._timeDataItemsMap,a._unusedTimeDataItemsMap),e.rowItem=e.rowItem||t.rowDataItem.item,i=a._getDataItem(e.rowItem,a._rowDataItemsMap,a._unusedRowDataItemsMap),e.date?e.timeItem=void 0:e.date=e.timeItem.start),e.yStartOffsetInRow||(e.yStartOffsetInRow=0),e.rowItem&&e.date&&i){if(e.rowItem.dateLines){for(var n=!0,r=0;r<e.rowItem.dateLines.length;r++){var o=e.rowItem.dateLines[r];o.date.getTime()===e.date.getTime()&&o.yStartOffsetInRow===e.yStartOffsetInRow&&(n=!1)}n&&e.rowItem.dateLines.push(e)}else e.rowItem.dateLines=[],e.rowItem.dateLines.push(e);var s=function(t){var i=a._rowDateLinesD3s[a._getBodyAreaIndex(t.item)].append("g").classed(We,!0);i.append("line").classed(Pe,!0),i.property(Se,e),a._rowDateLineElemsByRowDataItemIds[t.id].push(i)};if(a._rowDateLineElemsByRowDataItemIds[i.id]){var l=!0;for(r=0;r<a._rowDateLineElemsByRowDataItemIds[i.id].length;r++){var c=a._rowDateLineElemsByRowDataItemIds[i.id][r].property(Se);c.date.getTime()===e.date.getTime()&&c.yStartOffsetInRow===e.yStartOffsetInRow&&(l=!1)}l&&s(i)}else a._rowDateLineElemsByRowDataItemIds[i.id]=[],s(i);return!0}}catch(e){this._handleException(e,"addRowDateLine")}return!1},_updateRowDateLines:function(e){"use strict";Array.isArray(e.item.dateLines)&&e.item.dateLines.forEach((function(e){e.timeItem&&(e.date=e.timeItem.start)}))},removeDateLine:function(e){"use strict";try{w.assertString(e,"",0);var t=this;if(e){var i=t._dateLineIDsToSVGElementsMap[e];if(i&&(t._elementD3.select("#"+e).remove(),delete t._dateLineIDsToSVGElementsMap[e],Array.isArray(this.options.dateLines))){var a=this.options.dateLines.indexOf(r.select(i).property(Se));a>=0&&this.options.dateLines.splice(a,1)}}}catch(e){this._handleException(e,"removeDateLine")}},_dateLinesChanged:function(){"use strict";var e=this;e._backgroundDateLinesD3.selectAll(".ngantt-date-line").remove(),e._foregroundDateLinesD3.selectAll(".ngantt-date-line:not(.ngantt-drag-date-line):not(.ngantt-cursor-date-line)").remove(),e._dateLineIDsToSVGElementsMap={},Array.isArray(e.options.dateLines)&&e.options.dateLines.forEach((function(t){e._createDateLine(!1!==t.inForeground?e._foregroundDateLinesD3:e._backgroundDateLinesD3,t)})),e.options.worldViewVisible&&e._renderCompleteWorldView()},_createDateLine:function(e,t){"use strict";var i=this,a=t.labelOrientation===mt.Horizontal?0:-90,r=e.append("g").attr("class",De);t.className&&r.classed(t.className,!0);var o=r.append("g");t.id&&(i._dateLineIDsToSVGElementsMap[t.id]=r.node(),r.attr("id",t.id)),r.property(Se,t);var s=i._actualInnerBodyViewHeightsSumWithSeparator();if(o.append("line").attr("class",ve).attr("y2",s),t.label){var l=o.append("text").attr("class",ye).text(t.label);if(t.className&&(t.className.indexOf(Ee)>-1||t.className.indexOf(Ae)>-1||t.className.indexOf(_e)>-1))o.insert("rect","text").attr("class",be);else{var c,d,m=t.labelPosition;if(0===a)if(m&&l.style("text-anchor",m&ut.Left?"end":m&ut.Center?"middle":"start"),c="end"===l.style("text-anchor")?"-0.3em":"middle"===l.style("text-anchor")?0:"0.3em",8&m){var u;d="-0.3em",l.style("font-size","66%");try{u=l.node().getBBox()}catch(e){u={height:0,width:0,x:0,y:0}}o.insert("rect",":first-child").attr("width",u.width).attr("class","ngantt-date-line-caption-background ntimescale-ribbon-cell").attr("height",u.height).attr("x","end"===l.style("text-anchor")?-u.width:"middle"===l.style("text-anchor")?-u.width/2:0).attr("y",-u.height)}else d="0.9em";else d=m?m&ut.Left?"-0.3em":m&ut.Center?"0.3em":"0.9em":"-0.3em",c="-0.3em";l.attr("dx",c),l.attr("transform","rotate("+a+")"),l.attr("dy",d)}}if(t.draggable&&!i.options.isForExport&&n(r.node()).nSplitterWidget({height:s,width:1,svgGroupElem:o.node(),svgLineElem:o.select("line").node(),changed:function(e,t){i._onDateLineDropped(this,t)},startDrag:function(e,t){i._onDateLineDragStart(this,e,t)},endDrag:function(e,t){i._onDateLineDragEnd(this,e,t)},dragged:function(e,t){i._onDateLineDragged(this,e,t.newValue)},showDragStart:!0,useOwnEventDispatcher:!1}),t.createFunc&&t.createFunc.call(this,this._extendCallbackArgs({parentD3:o,dateLineDefinition:t})),t.phantom)o.append("rect").attr("class",Ie);return this._positionDateLine(r),r},moveDateLine:function(e,t){"use strict";try{w.assertString(e,"",0),w.assertDate(t,"",1);var i=this._dateLineIDsToSVGElementsMap[e];return i&&this._positionDateLine(r.select(i),t),!!i}catch(e){this._handleException(e,"moveDateLine")}},getDateLine:function(e){try{w.assertString(e,"",0);var t=this._dateLineIDsToSVGElementsMap[e];return t?r.select(t).property(Se):void 0}catch(e){this._handleException(e,"getDateLine")}},_positionDateLine:function(e,t,i,a){"use strict";var r=this,o=e.property(Se);t&&(o.date=t);var s=o.date;if(s){e.attr("visibility",null);var l=r.convertXToLimitedX(r._timeAxis.convertDateToX(s)),c=r._actualInnerBodyViewHeightsSumWithSeparator();if(e.classed(T.CLASS)?n(e.node()).nSplitterWidget("option",{min:0,max:r._timeAxis.actualTimeAreaWidth(),height:c,position:{x:l,y:0}}):e.attr("transform","translate("+l+")"),i){var d=!1;if(e===r._cursorDateLineD3){var m=l-r.convertXToLimitedX(r._timeAxis.timeAreaViewScrollOffset());(m<=0||m>r._timeAxis.timeAreaViewWidth())&&(d=!0)}var u,h=e.select("text").attr("transform","translate(0,"+(i.y||0)+")");i.text&&h.text(d?"":i.text);try{u=h.node().getBBox()}catch(e){u={height:0,width:0,x:0,y:0}}var p="end"===h.style("text-anchor")?-u.width:"middle"===h.style("text-anchor")?-u.width/2:0;e.select(".ngantt-drag-date-line-text-rect").attr("x",p).attr("y",(i.y||0)+u.y).attr("width",u.width).attr("height",u.height).attr("display",d?"none":"initial")}if(a&&a.endDate){var _=r.convertXToLimitedX(r._timeAxis.convertDateToX(a.endDate));e.select(".ngantt-drag-date-line-phantom-rect").attr("x",0).attr("y",a.y-r.options.barHeight/2||0).attr("width",_-l).attr("height",r.options.barHeight)}else e.select(".ngantt-drag-date-line-phantom-rect").attr("width",0)}else e.attr("visibility","collapse")},_dateLineDefinitionByElem:function(e){"use strict";for(var t,i=this,a=Object.keys(i._dateLineIDsToSVGElementsMap),n=a.length-1;n>=0&&(t=a[n],i._dateLineIDsToSVGElementsMap[t]!==e);n--);if(void 0!==t)for(n=i.options.dateLines.length-1;n>=0;n--){var r=i.options.dateLines[n];if(r.id===t)return r}},_getCallbackArgsForDateLine:function(e){"use strict";if(e){var t=this._dateLineDefinitionByElem(e);if(t)return this._extendCallbackArgs({sender:t,elem:e,elemType:$e.DateLine,cancel:!1})}},_onDateLineDragStart:function(e,t,i){"use strict";var a=this;if(a.options.dragStartFunc||a.options.dragEnterFunc){var n=a._getCallbackArgsForDateLine(e);if(n)a.options.dragStartFunc&&(a.options.dragStartFunc.call(a,n),i.cancel=n.cancel),!n.cancel&&a.options.dragEnterFunc&&(a.options.dragEnterFunc.call(a,n),i.cancel=n.cancel),a.__wasCursorDateLineVisible=a.option("horizontalMousePositionHighlightingEnabled"),a._cursorDateLineD3.select("line").attr("visibility","hidden"),a.option("horizontalMousePositionHighlightingEnabled",!0),r.select(e).selectAll(".ngantt-date-line-line, .ngantt-date-line-text").style("opacity",y._DefaultBarOpacity)}},_onDateLineDragEnd:function(e,t,i){"use strict";var a=this;if(a.options.dragLeaveFunc||a.options.dragEndFunc){var n=a._getCallbackArgsForDateLine(e);if(n){r.select(e).selectAll(".ngantt-date-line-line, .ngantt-date-line-text").style("opacity",null),a._cursorDateLineD3.select("line").attr("visibility",null),a.option("horizontalMousePositionHighlightingEnabled",a.__wasCursorDateLineVisible),delete a.__wasCursorDateLineVisible;var o=i.newValue;o&&(bt<0&&p.isFirefox&&o++,o=a.convertLimitedXToX(o),n.newDate=a._timeAxis.convertXToDate(o,!1,!0),n.cancel=i.canceled,a.options.dragLeaveFunc&&a.options.dragLeaveFunc.call(a,n),a.options.dragEndFunc&&a.options.dragEndFunc.call(a,n),i.canceled=!0)}}},_onDateLineDragged:function(e,t,i){"use strict";var a=this;bt<0&&p.isFirefox&&i++,i=a.convertLimitedXToX(i);var r,o=a._timeAxis.timeAreaViewScrollOffset();if(a._checkForAutoscroll(t.pageX,t.pageY,!0,!1,(function(){r&&window.clearTimeout(r),r=window.setTimeout((function(){try{var t=a._timeAxis.timeAreaViewScrollOffset()-o;n(e).nSplitterWidget("instance").manualDrag(i,t),i+=t,o=a._timeAxis.timeAreaViewScrollOffset()}catch(e){a._handleException(e,"_onDateLineDragged")}}),10)})),a.options.draggedFunc){var s=a._getCallbackArgsForDateLine(e);if(s)return s.newDate=a._timeAxis.convertXToDate(i,!1,!0),a.options.draggedFunc.call(a,s),!s.cancel}},_onDateLineDropped:function(e,t){"use strict";var i=this;if(i._stopAutoscroll(),i.options.droppedFunc){var a=i._getCallbackArgsForDateLine(e);if(a){var n=t.newValue;bt<0&&p.isFirefox&&n++,n=i.convertLimitedXToX(n),a.newDate=i._timeAxis.convertXToDate(n,!1,!0),i.options.droppedFunc.call(i,a),t.canceled=a.cancel}}},_updateRelevantRowDateLines:function(){"use strict";var e=this;if(Object.keys(e._rowDateLineElemsByRowDataItemIds).length){for(var t={},i={},a={},n=Object.keys(e._realizedVisibleRowsMap),r=0;r<n.length;r++){i[n[r]]||(i[n[r]]=e._realizedVisibleRowsMap[n[r]]),(o=e._realizedVisibleRowsMap[n[r]].parentRowDataItem)&&!a[o.id]&&(a[o.id]=o)}for(r=0;r<e._realizedInvisibleRowsArray.length;r++){var o;i[e._realizedInvisibleRowsArray[r].id]||(i[e._realizedInvisibleRowsArray[r].id]=e._realizedInvisibleRowsArray[r]),(o=e._realizedInvisibleRowsArray[r].parentRowDataItem)&&!a[o.id]&&(a[o.id]=o)}var s=function t(i,a){i.parentRowDataItem&&i.parentRowDataItem.item!==e.options.rowItemsRoot&&(a[i.parentRowDataItem.id]||(a[i.parentRowDataItem.id]=i.parentRowDataItem,i.parentRowDataItem.parentRowDataItem&&t(i.parentRowDataItem,a)))},l=Object.keys(a);for(r=0;r<l.length;r++)s(a[l[r]],a);var c=Object.keys(i);for(r=0;r<c.length;r++)t[c[r]]||(t[c[r]]=i[c[r]]);for(l=Object.keys(a),r=0;r<l.length;r++)t[l[r]]||(t[l[r]]=a[l[r]]);var d=[],m=Object.keys(t);for(r=0;r<m.length;r++)d.push(t[m[r]]);d.forEach((function(t){if(t.item.dateLines){var i=e._rowDateLineElemsByRowDataItemIds[t.id],a=t.item.dateLines;if(t.isCollapsed){if(i&&a)for(s=0;s<i.length;s++){l=i[s].select(".ngantt-row-date-line"),c=a[s],p=e._timeAxis.convertDateToX(c.date),_=e.options.transitionDuration,f=i[s],g=l;e._cacheTransitionFunction((function(){f.attr("transform","translate("+p+")"),g.attr("y1",l.attr("y1")).attr("y2",l.attr("y2")).transition().duration(_).attr("y1",l.attr("y1")).attr("y2",l.attr("y1"))}))}}else{var n,r=function e(t){var i=void 0;return["childRowDataItems","leafRowDataItems"].every((function(e,a){if(t&&Array.isArray(t[e])&&!t[a?"areLeavesCollapsed":"isCollapsed"]){var n=t[e].length-1;return i=t[e][n],!1}return!0})),i&&e(i)||i||t}(t);i?"number"==typeof i[0].select(".ngantt-row-date-line").attr("y2")?n=i[0].select(".ngantt-row-date-line").attr("y2"):(n=parseFloat(i[0].select(".ngantt-row-date-line").attr("y2")))||(n=r.oldY+(r.oldTotalHeight||r.totalHeight)):n=r.oldY+(r.oldTotalHeight||r.totalHeight);var o=r.newY+(r.totalHeight||r.oldTotalHeight);if(i&&a)for(var s=0;s<i.length;s++){var l=i[s].select(".ngantt-row-date-line"),c=a[s];if(r){var d=t.oldY+c.yStartOffsetInRow,m=n,u=t.newY+c.yStartOffsetInRow,h=o,p=e._timeAxis.convertDateToX(c.date),_=e.options.transitionDuration,f=i[s],g=l;e._cacheTransitionFunction((function(){f.attr("transform","translate("+p+")"),d&&m?g.attr("y1",d).attr("y2",m).transition().duration(_).attr("y1",u).attr("y2",h):g.attr("y1",u).attr("y2",h)}))}else{//!nextRowDataItem
var p=e._timeAxis.convertDateToX(c.date),_=e.options.transitionDuration,f=i[s],g=l;e._cacheTransitionFunction((function(){f.attr("transform","translate("+p+")"),g.attr("y1",l.attr("y1")).attr("y2",l.attr("y2")).transition().duration(_).attr("y1",l.attr("y1")).attr("y2",l.attr("y1"))}))}}}}}))}},_updateRowDateLinesX:function(){"use strict";var e=this;e._rowDateLinesD3s.forEach((function(t){t.selectAll(".ngantt-row-date-line-group").each((function(){var t=r.select(this).property(Se);r.select(this).attr("transform","translate("+e.convertXToLimitedX(e._timeAxis.convertDateToX(t.date))+")")}))}))},_removeAllRowDateLines:function(){"use strict";this._rowDateLineElemsByRowDataItemIds={},r.selectAll(".ngantt-row-date-line-group").remove()},_removeRowDateLines:function(e,t,i){"use strict";var a=this,n=a._rowDateLineElemsByRowDataItemIds[e.id];if(n)if(t){(o=n[t].select(".ngantt-row-date-line")).attr("y1",o.attr("y1")).attr("y2",o.attr("y2")).transition().duration(a.options.transitionDuration).attr("y1",i||o.attr("y1")).attr("y2",i||o.attr("y1")),n[t].transition().duration(a.options.transitionDuration).remove(),n.splice(t,1)}else{for(var r=0;r<n.length;r++){var o;(o=n[r].select(".ngantt-row-date-line")).attr("y1",o.attr("y1")).attr("y2",o.attr("y2")).transition().duration(a.options.transitionDuration).attr("y1",i||o.attr("y1")).attr("y2",i||o.attr("y1")),n[r].transition().duration(a.options.transitionDuration).remove()}delete a._rowDateLineElemsByRowDataItemIds[e.id]}},_findDateAreaEntry:function(e,t){"use strict";var i=this,a=i._pointToSVGRelative(i._svgRootD3.node(),t.center?t.center.x:t.pageX,t.center?t.center.y:t.pageY),n=i._timeAxis.convertXToDate(a.x-i.actualTableViewWidth()-i._actualSplitterWidth()+i._timeAxis.timeAreaViewScrollOffset());if(n){var r,o=n.getTime(),s=i._timeAxis.convertXToDate(a.x-i.actualTableViewWidth()-i._actualSplitterWidth()+i._timeAxis.timeAreaViewScrollOffset()+1),l=s?s.getTime()-1:o;if(Array.isArray(e.entries))if(!e.entries.slice().reverse().every((function(e,t){return!(e.start&&e.end&&e.start.getTime()<=l&&e.end.getTime()>=o)||(r=t,!1)})))return e.entries.length-1-r}},_dateAreasChanged:function(){"use strict";var e=this;e._backgroundDateAreasD3.selectAll(".ngantt-date-area").remove().each((function(){n(this).data(m.HANDLER_FUNCTION_PROPERTY+qe+e._uniqueID,null).off(qe+e._uniqueID)})),e._foregroundDateAreasD3.selectAll(".ngantt-date-area").remove().each((function(){n(this).data(m.HANDLER_FUNCTION_PROPERTY+qe+e._uniqueID,null).off(qe+e._uniqueID)})),Array.isArray(e.options.dateAreas)&&e.options.dateAreas.forEach((function(t){e._createDateArea(t,t.inForeground?e._foregroundDateAreasD3:e._backgroundDateAreasD3,null)}))},_createDateArea:function(e,t,i){"use strict";var a,r=this;if(null!=e.id){a=t.append("g").attr("class",i?[Ne,m.TAP_EVENT_CLASS_NAME,m.DOUBLE_TAP_EVENT_CLASS_NAME,m.CONTEXTMENU_EVENT_CLASS_NAME].join(" "):ge),e.className&&a.classed(e.className,!0),i?a.property(r._OBJECT_ID_PROPERTY,e.id):a.attr("id",e.id),p.isIOS||r.options.isForExport||n(a.node()).on("mouseenter.ngantt"+r._uniqueID,(function(t){try{if(r._onmouseenter_cursor(t,this,Ne),!r.isInInteraction()){r._lastTooltipBarElem=t.target;var o=Array.isArray(e.entries),s=r._findDateAreaEntry(e,t);(!o||s>=0)&&(r._lastTooltipDateAreaEntryIndex=s,r._triggerEvent(r._extendCallbackArgs({sender:e,entryIndex:s,eventType:"tooltip",rowItem:i,elem:this,elemType:$e.DateArea,event:t})),n(a.node()).on("mouseleave.ngantt"+r._uniqueID,(function(t){n(window).off("mousemove.ngantt"+r._uniqueID+"-tooltip-da"+e.id),r._triggerEvent(r._extendCallbackArgs({sender:null,eventType:"tooltip",elem:null,event:t}))})),n(window).on("mousemove.ngantt"+r._uniqueID+"-tooltip-da"+e.id,(function(t){try{var a=t.target,n=!0;if(a!==r._lastTooltipBarElem&&(n=!1),n){var o=Array.isArray(e.entries),s=r._findDateAreaEntry(e,t);o&&s===r._lastTooltipDateAreaEntryIndex?r._lastTooltipBarElem===a&&(n=!1):r._lastTooltipDateAreaEntryIndex=s,n&&null!=s&&r._triggerEvent(r._extendCallbackArgs({sender:e,entryIndex:s,eventType:"tooltip",rowItem:i,elem:a,elemType:$e.DateArea,event:t}))}}catch(e){r._handleException(e,"onMouseMove_dateArea")}})))}}catch(e){r._handleException(e,"onMouseEnter_dateArea")}})).data(m.HANDLER_FUNCTION_PROPERTY+qe+r._uniqueID,(function(t){try{var a=Array.isArray(e.entries),n=r._findDateAreaEntry(e,t);if(!a||n>=0)switch(t.type){case m.TAP_EVENT_NAME:r._handleTapOnTimeAreaBackground(t),r._triggerEvent(r._extendCallbackArgs({sender:e,entryIndex:n,elemType:$e.DateArea,rowItem:i,eventType:"tap",event:t.srcEvent,hammerEvent:t}));break;case m.DOUBLE_TAP_EVENT_NAME:r._triggerEvent(r._extendCallbackArgs({sender:e,entryIndex:n,elemType:$e.DateArea,rowItem:i,eventType:"doubletap",event:t.srcEvent,hammerEvent:t}));break;case m.PRESS_EVENT_NAME+"up":"touch"===t.pointerType&&r._triggerEvent(r._extendCallbackArgs({sender:e,entryIndex:n,elemType:$e.DateArea,rowItem:i,eventType:"contextmenu",event:t.srcEvent,hammerEvent:t}));break;case m.CONTEXTMENU_EVENT_NAME:r._triggerEvent(r._extendCallbackArgs({sender:e,entryIndex:n,elemType:$e.DateArea,rowItem:i,eventType:"contextmenu",event:t})),r.options.preventDefaultOnContextMenuEvents&&(t.stopPropagation(),t.preventDefault())}}catch(e){r._handleException(e,"onEventDispatch_dateArea")}}));var o=a.append("path");if(i)o.classed(r.NXXXXX.ROW_MAIN_HEIGHT_SCALE_CLASS,!0);else{var s=r._actualInnerBodyViewHeightsSumWithSeparator();o.attr("height",s)}(Array.isArray(e.entries)?e.entries.some((function(e){return!!e.caption})):e.caption)&&(e.entries||[e]).forEach((function(e){e.caption&&a.append("text").attr("class",Te).attr("dy","1em").text(e.caption)})),e.createFunc&&e.createFunc.call(e,r._extendCallbackArgs({dateArea:a.node(),dateAreaDefinition:e,rowItem:i})),r._positionDateArea(a,e,!!i)}return a},_positionDateArea:function(e,t,i){"use strict";var a=this;t?((t=n.extend({},t)).entries&&(t.entries=t.entries.map((function(e){return n.extend({},e)}))),e.datum(t)):t=e.datum();var o=e.selectAll(".ngantt-date-area-text").nodes(),s=t.entries||[t],l="",c=0;s.forEach((function(e){var t=e.start,n=e.end;if(t&&n&&t<n&&n>a._currentStart&&t<a._currentEnd){var s=a.convertXToLimitedX(a._timeAxis.convertDateToX(t)),d=a.convertXToLimitedX(a._timeAxis.convertDateToX(n));if(l+=["M",s,",0H",d,"V",i?1:a._actualInnerBodyViewHeightsSumWithSeparator(),"H",s,"Z"].join(""),e.caption){var m=r.select(o[c++]);m.attr("x",s+2),a.setClipPathAttrOnElemD3WithRefCount(m,a.getOrCreateClipPathForRange(s,Math.max(d-2,s)))}}})),e.select("path").attr("d",l)},_createDateAreasInRow:function(e,t,i){"use strict";var a,n=this;Array.isArray(e.item.dateAreas)&&e.item.dateAreas.forEach((function(r){!!r.inForeground===i&&(a||(a=t.append("g").attr("class",i?"ngantt-foreground-row-date-areas":"ngantt-background-row-date-areas")),n._createDateArea(r,a,e.item))}))},_determineDateAreasForRowInWorldView:function(){},_positionDateAreasInRow:function(e,t,i){"use strict";var a=this;if(Array.isArray(e.item.dateAreas)){var n={};e.item.dateAreas.forEach((function(e){!!e.inForeground===i&&(n[e.id]=e)})),t.selectAll("."+Ne).each((function(e){if(e){var t=r.select(this);n[t.property(a._OBJECT_ID_PROPERTY)]&&a._positionDateArea(t,void 0,!0)}}))}},_initializeTimescaleDependentStripesOrDateLines:function(){"use strict";var e="url(#"+this.NXXXXX.WIDTH_CLIPPATH_ID[U]+this._uniqueID+")";this._alternatingTimeStripesScrollParentD3=this._svgRootD3.append("g").attr("class",je).attr("clip-path",e),this._alternatingTimeStripesD3=this._alternatingTimeStripesScrollParentD3.append("path").attr("class","ngantt-alt-time-stripes"),this._timescaleRibbonDateLinesScrollParentD3=this._svgRootD3.append("g").attr("class",je).attr("clip-path",e),this._timescaleRibbonDateLinesD3=this._timescaleRibbonDateLinesScrollParentD3.append("path").attr("class","ngantt-ribbon-date-lines")},_updateTimescaleDependentStripesOrDateLines:function(){"use strict";var e=this;if(e.options.alternatingTimeStripesVisible){this._alternatingTimeStripesD3.attr("visibility",null);var t=(e._timescaleWidgets[J]||e._timescaleWidgets[$]).getDatesOfMostDetailedRibbon(!0);if(t&&t.length){for(var i=(e._timescaleWidgets[J]||e._timescaleWidgets[$]).getCurrentTypicalCellWidthOfMostDetailedRibbon(),a=Math.floor(t[0].getTime()/i)%2,n=e._timeAxis,r=this.convertXToLimitedX(n.timeAreaViewScrollOffset()),o=a?2:0,s=t.length,l=n.convertXToDate(n.timeAreaViewScrollOffset()+n.timeAreaViewWidth()),c=Math.max(e._actualInnerBodyViewHeightsSumWithSeparator(),e._actualBodyHeightsSum()).toString(),m=[];o<=s;){//!!
if(a){var u=e.convertXToLimitedX(e._timeAxis.convertDateToX(t[o-1]))-r,h=e.convertXToLimitedX(e._timeAxis.convertDateToX(t[o]||l))-r;u!==h&&(u=u.toString(),h=h.toString(),m.push("M",u,",0H",h,"V",c,"H",u,"Z"))}a=!a,o++}this._alternatingTimeStripesD3.attr("d",m.join(""))}}else this._alternatingTimeStripesD3.attr("visibility","hidden").attr("d",null);if(e.options.timescaleRibbonDateLinesVisible){if(e._layoutRows[Y].innerViewExtent()||e._layoutRows[z].innerViewExtent()){var p=(e._timescaleWidgets[J]||e._timescaleWidgets[$]).getCellsOfMostDetailedRibbon();if(p&&p.length){var _=(n=e._timeAxis).collapseCalendar(),f=this.convertXToLimitedX(n.timeAreaViewScrollOffset());s=p.length;c=(c=e._actualInnerBodyViewHeightsSumWithSeparator()).toString();m=[];d.applyTimeZone(e.options.timeZone,(function(){for(var t=1;t<s;t++){var a=p[t];if(t||a.width<i)var n=!!_&&a.previousDateSkipped;var r=e.convertXToLimitedX(e._timeAxis.convertDateToX(d.toDate(a.dateOrMoment)))-f;n?m.push("M",(r-1).toString(),",0V",c,"M",(r+1).toString(),",0V",c):m.push("M",r.toString(),",0V",c)}})),this._timescaleRibbonDateLinesD3.attr("d",m.join("")).attr("visibility",null)}}}else this._timescaleRibbonDateLinesD3.attr("visibility","hidden").attr("d",null)},_bodyChanged_isSuspended:function(e){"use strict";if(this.options.updateSuspended){if(!([pt.Other,pt.RowItemsChanged,pt.LinkItemsChanged,pt.TimeItemsChanged].indexOf(e)<0))return this._cachedBodyChangedArguments||(this._cachedBodyChangedArguments=[]),void 0!==this._cachedBodyChangedArguments[0]&&e===pt.LinkItemsChanged||(this._cachedBodyChangedArguments[0]=e),!0;this._setOption("updateSuspended",!1)}return!1},_bodyChanged_prepareUpdate:function(){"use strict";this.options.automaticCalculationOfSubRowIndexesOfBarsInRow||this.calculateInvalidSubRowIndexesOfBarsInRows()},_bodyChanged_additionalUpdates:function(e){"use strict";null!=e?this._createAndUpdateAllLinks(e):this._createAndUpdateAllLinks(pt.LinkItemsChanged)},_bodyChanged_updateNeededByUpdateCause:function(e){return e!==pt.LinkItemsChanged},_bodyChanged_restrictTotalHeight:function(e){"use strict";if(!1===e.item.barsPaneVisible){var t=e.isLeaf?this.options.defaultLeafRowMainHeight:this.options.defaultRowMainHeight;this._bodyChanged_setTotalHeight(e,Math.max(e.totalHeight,t))}},_bodyChanged_calcTotalHeight:function(e,t){"use strict";var i=e.isLeaf?this.options.defaultLeafRowMainHeight:this.options.defaultRowMainHeight;return Math.max(t||0,e.mainHeight||0,!1!==e.item.barsPaneVisible?i:0)},_updateRows_moveVertically:function(e,t,i,a){"use strict";var n=this;if(e.phantomRowElem&&t!==pt.RowExpanded&&t!==pt.RowLeavesExpanded){var o=s(r.select(e.phantomRowElem).attr("transform"));o.translate[1]+=a,r.select(e.phantomRowElem).transition().duration(n.options.transitionDuration).attr("transform",o.toString())}if(n.options.barSelectionFramesShownWithHigherZOrder||n.options.selectedItemsShownHighlighted){var l;if(n.options.selectedItemsShownHighlighted){var c=n._getOrCreateSpecialRowElem(e,!1,1);c&&(l=r.select(c).selectAll("."+ee+",."+de))}else l=i.selectAll(".ngantt-zsel-bar");l&&l.each((function(i){if(i.selectedFrameElem&&(n.options.barSelectionFramesShownWithHigherZOrder||n._worldViewDivJQ))if(i.rowDataItem.visibleRowDataItem.totalHeight&&!i.rowDataItem.visibleRowDataItem.isHidden){if(n.options.barSelectionFramesShownWithHigherZOrder){var o=r.select(i.selectedFrameElem);if(i.rowDataItem.visibleRowDataItem.entered||t===pt.RowExpanded||t===pt.RowLeavesExpanded)if((o=r.select(i.selectedFrameElem)).transition().duration(n.options.transitionDuration).attr("y",+o.attr("y")+a),i.selectedFrameMaskElem){var s=r.select(i.selectedFrameMaskElem),l=s.select("rect:nth-child(1)");l.transition().duration(n.options.transitionDuration).attr("y",+l.attr("y")+a);var c=s.select("rect:nth-child(2)");c.transition().duration(n.options.transitionDuration).attr("y",+c.attr("y")+a)}}n._worldViewDivJQ&&(e.worldViewSelectionCacheMap["T"+i.id].args[2].top+=a)}else n._removeSelectionFrameOfTimeDataItem(i)}))}},_updateRows_handleSelectionFrame:function(e){"use strict";if(e&&e.selectedFrameElem&&this.options.barSelectionFramesShownWithHigherZOrder){var t=r.select(e.selectedFrameElem);t.transition().duration(this.options.transitionDuration).attr("transform",t.attr("transform")+" "+wt)}},_updateRows_updateSingleRow:function(e,t,i,a){"use strict";this._updateCalendarGridForRow(e,t,!0,i&&e!==a)},_updateRows_prepareExitingRow:function(e){"use strict";var t=this;t._determineVisibleTimeDataItemsInRow(e).forEach((function(i){i.oldX=i.newX,i.oldEndX=i.newEndX,i.oldY=i.newY,i.oldRowY=e.newY,i.oldRowAtTheTop=!!t._isItemAtTheTop(e.item)}))},_updateRows_handleExitingRows:function(e,t){"use strict";var i=this;i._updateRelevantRowDateLines(),e.forEach((function(e){i._removeRowCompletely(e,!0),i._removeRowDateLines(e,void 0,t?(t.newY||t.oldY)+(t.newTotalHeight||t.oldTotalHeight):void 0)}))},_updateRows_callback:function(e,t,i){"use strict";var a=this;if(a.options.timeAreaRowUpdateFunc){var n=a.getCurrentUpperXLimit()-a.getCurrentLowerXLimit(),r=a._extendCallbackArgs({isForeground:!1,width:a._actualLayoutColumnLeft(U)+n,timeAreaWidth:n,bodyViewScrollOffsetChanged:!1,timeAreaWidthChanged:!1,timeAreaViewWidthChanged:!1,timeAreaViewScrollOffsetChanged:!1,baseTimeUnitWidthChanged:!1,startOrEndChanged:!1,xCoordTransformChanged:!1,rowHeightChanged:!0});r.rowItem=e.item;var o=t.select(".ngantt-timearea-row"),s=o.select("g.ngantt-timearea-row-contents");r.isForeground=!1,r.rowElem=o.node(),r.parentElem=s.node(),a.options.timeAreaRowUpdateFunc.call(a,r),s=(o=i.select(".ngantt-timearea-row")).select("g.ngantt-timearea-row-contents"),r.isForeground=!0,r.rowElem=o.node(),r.parentElem=s.node(),a.options.timeAreaRowUpdateFunc.call(a,r)}},_removeSelectionFrames:function(e,t){"use strict";var i=this,a=e.datum();(i.options.barSelectionFramesShownWithHigherZOrder||a.worldViewSelectionCacheMap)&&e.selectAll(".ngantt-zsel-bar").each((function(e){!i.options.barSelectionFramesShownWithHigherZOrder||!t&&i._isTimeDataItemVisible(e)||i._removeSelectionFrameOfTimeDataItem(e),a.worldViewSelectionCacheMap&&delete a.worldViewSelectionCacheMap["T"+e.id]}))},_expandOrCollapseRow:function(e,t,i,a){"use strict";this._doExpandOrCollapseRow(e,{interactively:t,withoutUpdate:i,concernsLeaves:a,additionalFlagsForInvalidateRows:{barsChangedFlag:!0},beforeStateChangeFunc:this._handleBeforeExpandOrCollapseRow,afterStateChangeFunc:this._handleAfterExpandOrCollapseRow})},_handleBeforeExpandOrCollapseRow:function(e,t){"use strict";var i=this;if(!(t?e.areLeavesCollapsed:e.isCollapsed)&&i.options.virtualized){!function e(t){["leafRowDataItems","childRowDataItems"].forEach((function(a,n){var o=n?tt.BarsOfCollapsedChildRows:tt.BarsOfCollapsedLeafRows;(n?function(e){return i._getCollapsedDisplayedElementsForRowItem(e.item)}:i._getCurrentlyDisplayedElementsInRow).call(i,t)&o&&Array.isArray(t[a])&&t[a].forEach((function(t){t&&!t.isHidden&&(t.foregroundRowElem||i._createRow(t,void 0,pt.BeforeRowCollapse),t.isLeaf||e(t),r.select(t.foregroundRowElem).selectAll("."+ee+",."+de).attr("visibility","hidden"))}))}))}(e)}if(t?e.areLeavesCollapsed:e.isCollapsed){(t?i._getCurrentlyDisplayedElementsInRow(e)&tt.BarsOfCollapsedLeafRows:i._getCollapsedDisplayedElementsForRowItem(e.item)&tt.BarsOfCollapsedChildRows)&&function e(t){["leafRowDataItems","childRowDataItems"].forEach((function(a){Array.isArray(t[a])&&t[a].forEach((function(t){Array.isArray(t.item.timeItems)&&t.item.timeItems.forEach((function(e){for(var t=[i._getDataItem(e,i._timeDataItemsMap)],a=0;a<t.length;a++){var n=t[a];n&&(n.elem&&(n.actuallyVisibleInCollapsedRow=!0),Array.isArray(n.item.childTimeItems)&&n.item.childTimeItems.forEach((function(e){t.push(i._getDataItem(e,i._timeDataItemsMap))})))}})),e(t)}))}))}(e)}},_handleAfterExpandOrCollapseRow:function(e,t){"use strict";var i=this;if(i.options.automaticCalculationOfSubRowIndexesOfBarsInRow)i._calculateSubRowIndexesOfBarsInRow(e,!0);else if(!(e.isCollapsed||t&&e.areLeavesCollapsed)){!function e(a){i._invalidRowDataItemIDsForSubRowIndexesMap[a.id]=!0,a.isLeaf||["leafRowDataItems","childRowDataItems"].forEach((function(i,n){n&&t||!Array.isArray(a[i])||a[i].forEach((function(t){t&&e(t)}))}))}(e)}},_getOrCreateClipPathForRow:function(e,t){"use strict";var i=this,a=[Fe,i._uniqueID,"_",e,"_",t].join(""),n=i._defsD3.select("#"+a);return n.size()||(n=i._defsD3.append("clipPath").attr("id",a)).append("rect").attr("width",i.options.isForExport?1e7:1e5).attr("y",e).attr("height",t-e),a},_localeChanged:function(){"use strict";try{this._updateDateLineGrids(),this._super()}catch(e){this._handleException(e,"onLocaleChanged")}},_formatDate:function(e){"use strict";var t,i=this;return d.applyTimeZone(i.options.timeZone,(function(){var a=d.dateToMomentIfNecessary(e),n=function(n){var o=n.date+" "+n.time;if(t=d.isMomentJSCurrentlyUsed?(r.timeFormat?r.utcFormat:r.time.format.utc)(o)(d.toDisplayDate(a)):(r.timeFormat?r.timeFormat:r.time.format)(o)(a),i.options.formatDateFunc){var s={ganttWidget:i,date:e,text:t};i.options.formatDateFunc.call(i,s),t=s.text}};i.options.locale instanceof u?i.options.locale.applyDateFormat((function(){n(i.options.locale.params())})):n(h.locale())})),t},_detachEventListenersFromBars:function(e){"use strict";var t=this,i=t.options.detachEventListenersExFunc?[]:void 0;e.size()&&(e.each((function(){n(this).data(m.HANDLER_FUNCTION_PROPERTY+qe+t._uniqueID,null).off(qe+t._uniqueID),i&&i.push(this)})),t.options.detachEventListenersExFunc&&t.options.detachEventListenersExFunc.call(t,t._extendCallbackArgs({isForeground:!0,elems:i,elemType:$e.Bar})),t.options.detachEventListenersFunc&&e.each((function(e){e&&t.options.detachEventListenersFunc.call(t,t._extendCallbackArgs({isForeground:!0,item:e.item,elem:this,elemType:$e.Bar}))})))},_detachTimeDataItem:function(e,t,i){"use strict";var a=this;e.elem&&(t||(t=r.select(e.elem)),e.version===t.property(a._ITEM_VERSION_PROPERTY)&&(a._detachEventListenersFromBars(t),e.elem=void 0,delete e.unlimitedVisibility,delete e.isHiddenByLimits,delete e.highlighted,i&&(delete e.oldX,delete e.oldEndX,delete e.oldY,delete e.oldRowY,delete e.oldRowAtTheTop,e.selectedFrameElem&&a._removeSelectionFrameOfTimeDataItem(e)),t.datum(null)))},_createXCoordinateLimiter:function(){this._xCoordinateLimiter=new l(this.options.minimumLinearCoordinateExtent,this.options.maximumLinearCoordinateExtent,this.options.linearCoordinateReserve)},_saveXStretchCenterCoordinate:function(e){this._savedXStretchCenterCoordinate=e},_updateXCoordinateLimiterTransform:function(){if(!this._xCoordinateLimiter)return!1;var e=this._savedXStretchCenterCoordinate;return this._savedXStretchCenterCoordinate=void 0,this._xCoordinateLimiter.updateTransformIfNecessary({viewExtent:this._layoutColumns[U].innerViewExtent(),viewScrollOffset:this._timeAxis.timeAreaViewScrollOffset(),chartExtent:this._timeAxis.actualTimeAreaWidth(),chartStretchCenterCoordinate:e})},convertXToLimitedX:function(e){return w.assertNumber(e,"nGanttWidget.convertXToLimitedX",0),this._xCoordinateLimiter?this._xCoordinateLimiter.transform(e):e},convertLimitedXToX:function(e){return w.assertNumber(e,"nGanttWidget.convertLimitedXToX",0),this._xCoordinateLimiter?this._xCoordinateLimiter.reverseTransform(e):e},_limitX:function(e){return this._xCoordinateLimiter?this._xCoordinateLimiter.limit(e):e},_isXOutsideLimits:function(e){return this._xCoordinateLimiter?this._xCoordinateLimiter.isCoordOutsideLimits(e):0},getCurrentLowerXLimit:function(){return this._xCoordinateLimiter?this._xCoordinateLimiter.getCurrentLowerLimit():this._timeAxis.convertDateToX(this._timeAxis.actualStart())},getCurrentUpperXLimit:function(){return this._xCoordinateLimiter?this._xCoordinateLimiter.getCurrentUpperLimit():this._timeAxis.convertDateToX(this._timeAxis.actualEnd())},_PE_CurrentOffsetCorrection:function(){this._currentOffsetCorrection={x:Lt+(this.options.offsetCorrection&&+this.options.offsetCorrection.x||0),y:Bt+(this.options.offsetCorrection&&+this.options.offsetCorrection.y||0)}},_updateCursorHighlighters:function(e){"use strict";var t=this;if(t._currentCursorDateLineVisible){var i=t._pointToSVGRelative(t._svgRootD3.node(),e.pageX,e.pageY),a=t._timeAxis.convertXToDate(i.x-t._layoutColumns[X].innerViewExtent()-t._actualSplitterWidth()+t._timeAxis.timeAreaViewScrollOffset(),!1,!0),n=i.y-t._actualTitleHeight(J)+18+16/t.options.visualZoomFactor,r=t._actualInnerBodyViewHeightsSumWithSeparator();n>r&&(n=r),t._positionDateLine(t._cursorDateLineD3,a,{y:n,text:t._formatDate(a)}),t._cursorDateLineD3.style("visibility",null)}else t._cursorDateLineD3.style("visibility","hidden");if(t.options.verticalMousePositionHighlightingEnabled&&"hidden"===t._verticalDragAreaD3.style("visibility")){var o=t._findRowDataItemAtY(e.pageY);t._positionCursorRow(o),t._cursorRowD3.style("visibility",null)}else t._cursorRowD3.style("visibility","hidden")},_makeCursorHighlightersInvisible:function(){"use strict";this._cursorDateLineD3.style("visibility","hidden"),this._cursorRowD3.style("visibility","hidden")},_PE_ActualTableViewWidth:function(){return this.actualTableViewWidth()},_PE_TableViewWidth:function(){return this._determineCurrentTableViewWidthMaximum()},_PE_ActualTableViewWidth_222:function(){return this.actualTableViewWidth()},_actualScrollableWidth:function(e){"use strict";return e===U?this._timeAxis.actualTimeAreaWidth():this._super(e)},_actualSplitterWidth:function(){return this._layoutColumns[G].outerViewExtent()},_createLayoutGrid:function(){"use strict";this._super(),this._layoutGrid&&this._layoutStacks&&this._layoutStacks[Q]&&(this._layoutStacks[Q].appendStripes([U,G]),this._layoutColumns[G].extent(this.options.isForExport?this.options.splitterWidth:0),this._layoutColumns[G].innerViewExtent(this.options.splitterWidth),this._layoutColumns[G].outerViewExtent(this.options.splitterWidth))},_layoutStackUpdateColumns:function(e,t,i){"use strict";if(this._super(e,t,i),i.innerViewExtent!==t.innerViewExtent){var a=this._actualScaledMainWidth();this._svgSplitterRootD3&&this._svgSplitterRootD3.style("width",a+1+"px")}},_layoutStackUpdateRows:function(e,t,i){"use strict";var a=this;if(this._super(e,t,i),i.innerViewExtent!==t.innerViewExtent){var o=this._actualScaledMainHeight(),s=this._actualInnerBodyViewHeightsSumWithSeparator();this._svgSplitterRootD3&&this._svgSplitterRootD3.style("height",o+"px"),this._verticalSplitterWidget&&this._verticalSplitterWidget.option("height",o),this._updateTimescaleDependentStripesOrDateLines(),[this._backgroundDateLinesD3,this._foregroundDateLinesD3].forEach((function(e){e.selectAll(".ngantt-date-line").each((function(){var e=r.select(this);e.classed(T.CLASS)?n(e.node()).nSplitterWidget("option",{height:Math.max(s+1,0)}):e.select("line").attr("y2",Math.max(s,0))}))})),[this._backgroundDateAreasD3,this._foregroundDateAreasD3].forEach((function(e){e.selectAll(".ngantt-date-area").each((function(){a._positionDateArea(r.select(this))}))})),this._dateLineGridsD3.selectAll(".ngantt-date-line line").attr("y2",s+1)}},_layoutStripeUpdateColumn:function(e,t,i){"use strict";switch(this._super(e,t,i),e.getStripeID()){case G:if(i.start!==t.start){if(this._tableTitleSplitterLineD3s)for(var a=0;a<=1;a++)this._titleVisible(a)&&this._tableTitleSplitterLineD3s[a]&&this._tableTitleSplitterLineD3s[a].attr("x1",i.start).attr("x2",i.start);if(this._tableBodySplitterLineD3s)for(var n=0;n<=1;n++)this._tableBodySplitterLineD3s[n]&&this._tableBodySplitterLineD3s[n].attr("x1",i.start).attr("x2",i.start)}break;case U:if(i.start!==t.start){var r="translate("+(this._actualLayoutColumnLeft(U)+Ot)+")";for(a=0;a<=1;a++)this._titleVisible(a)&&this._timescaleD3s[a]&&this._timescaleD3s[a].attr("transform",r);this._linkHotRegionsContainerD3.attr("transform",r),this._linksContainerD3.attr("transform",r),this._rowDateLinesContainerD3s.forEach((function(e){e.attr("transform",r)})),this._backgroundBodyD3s.slice().concat(this._foregroundBodyD3s).forEach((function(e){e.selectAll(".ngantt-timearea-row").attr("transform",r)})),this._updateD3sXY()}i.innerViewExtent!==t.innerViewExtent&&this._timeAxis.timeAreaViewWidth(Math.max(0,i.innerViewExtent))}},_layoutStripeUpdateRow:function(e,t,i){"use strict";var a=this;if(this._super(e,t,i),i.start!==t.start){var n=function(e){a._titleVisible(e)&&a._tableTitleSplitterLineD3s&&a._tableTitleSplitterLineD3s[e]&&a._tableTitleSplitterLineD3s[e].attr("y1",a._actualTitleAreaTop(e)).attr("y2",a._actualTitleAreaBottom(e))},r=function(e){a._tableBodySplitterLineD3s&&a._tableBodySplitterLineD3s[e]&&a._tableBodySplitterLineD3s[e].attr("y1",a._actualBodyViewTop(e)).attr("y2",a._actualOuterBodyViewBottom(e))};switch(e.getStripeID()){case j:n(J);break;case Y:r(Y);break;case z:r(z);break;case Z:n($)}}if(i.innerViewExtent!==t.innerViewExtent){var o=function(e){if(a._titleVisible(e)){var t=a._actualTitleHeight(e);a._timescaleWidgets[e]&&a._timescaleWidgets[e].option("height",t),a._tableTitleSplitterLineD3s&&a._tableTitleSplitterLineD3s[e]&&a._tableTitleSplitterLineD3s[e].attr("y2",a._actualTitleAreaBottom(e))}},s=function(e){a._tableBodySplitterLineD3s&&a._tableBodySplitterLineD3s[e]&&a._tableBodySplitterLineD3s[e].attr("y2",a._actualOuterBodyViewBottom(e))};switch(e.getStripeID()){case j:o(J),this._updateD3sXY();break;case Y:s(Y);break;case z:s(z);break;case Z:o($)}}},_updateD3sXY:function(){"use strict";var e=this,t=this._actualTitleHeight(J),i=this._actualLayoutColumnLeft(U)+Ot,a="translate("+(i+(-Mt||bt))+","+t+")",n="translate("+(i+(Ot||At))+","+t+")";this._alternatingTimeStripesScrollParentD3.attr("transform",n),this._timescaleRibbonDateLinesScrollParentD3.attr("transform","translate("+(i+Et)+","+t+")"),this._verticalDragAreaParentD3&&this._verticalDragAreaParentD3.attr("transform",n),this._horizontalDragAreaParentD3&&this._horizontalDragAreaParentD3.attr("transform",n),this._dateLineGridsParentD3.attr("transform","translate("+(i+Et)+","+t+")"),e._barSelectionFramesParentsD3&&q.forEach((function(t){e._barSelectionFramesParentsD3[t].attr("transform","translate("+(i+Et)+","+e._actualBodyViewTop(t)+")")})),this._backgroundWatermarkParentD3.attr("transform",n),this._backgroundDateLinesParentD3.attr("transform",a),this._foregroundDateLinesParentD3.attr("transform",a),this._backgroundDateAreasParentD3.attr("transform",n),this._foregroundDateAreasParentD3.attr("transform",n)},_createAndPositionDivOverlays:function(){"use strict";var e=this;this._super(),this._overlayAreas[U]=[];for(var t=0;t<=1;t++)this._overlayAreas[U][t]=new _({layoutRow:{},layoutColumn:{}},{forX:!0,forY:!0},(function(){return e._actualScrollBarWidth()})),this._overlayAreas[U][t]._createAndPositionDivOverlays(this._divScaleJQ,Ge[t],Ue[t],this.NXXXXX.IOS_SCROLL_BAR_CLASS,t,(function(t){try{if(t){var i=this.scrollLeft();e._layoutColumns[U].cachedScrollStart()-i<1&&e._layoutColumns[U].cachedScrollStart()-i>-.1&&(i=e._layoutColumns[U].cachedScrollStart())}var a=[];a[U]=t?i*e._layoutColumns[U].scrollFactorExceeding():void 0;var n=[];n[t]=this.scrollTop(),e._doRequestScroll(a,n)}catch(t){e._handleException(t,"onScroll")}}));for(var i=0;i<=1;i++)if(this._titleVisible(i)){var a=i+2;this._overlayAreas[U][a]=new _({layoutRow:{},layoutColumn:{}},{forX:!1,forY:!1},void 0),this._overlayAreas[U][a]._createAndPositionDivOverlays(this._divScaleJQ,Ke[i],Ze[i],this.NXXXXX.IOS_SCROLL_BAR_CLASS,a,void 0)}this._titleVisible($)&&this._overlayAreas[U][z].setScrollBarExistence({forX:!1})},_createAndAppendSVGRootDefs:function(){"use strict";this._super(),this._widthClipPathRectD3s[U]=this._defsD3.append("clipPath").attr("id",this.NXXXXX.WIDTH_CLIPPATH_ID[U]+this._uniqueID).append("rect"),this._defsD3.append("pattern").attr("id","ngantt-graying-pattern").attr("patternUnits","userSpaceOnUse").attr("width",2).attr("height",2).append("line").attr("x2",2).attr("y2",2).attr("opacity",1).attr("stroke","white").attr("stroke-width",1)},_appendTitle:function(e){"use strict";this._super(e),this._tableTitleD3s[e]&&(this._timescaleD3s||(this._timescaleD3s=[]),this._timescaleD3s[e]=this._titleD3s[e].append("g").attr("class","ngantt-timescale"),this._timescaleD3s[e].attr("clip-path","url(#"+this.NXXXXX.WIDTH_CLIPPATH_ID[U]+this._uniqueID+")"),this.options.isForExport&&(this._tableTitleSplitterLineD3s||(this._tableTitleSplitterLineD3s=[]),this._tableTitleSplitterLineD3s[e]||(this._tableTitleSplitterLineD3s[e]=this._svgRootD3.append("line").attr("class","ngantt-table-title-splitter-line"))))},_appendBackground:function(){"use strict";var e=this;this._super(),n(this._backgroundBodyScrollParentD3.node()).data(m.HANDLER_FUNCTION_PROPERTY+qe+e._uniqueID,(function(t){try{e._checkBarSelectionRectangleEvents(t,this)}catch(t){e._handleException(t,"onEventDispatch_background")}})),this._registerGestureEventsOnTimeAreaBackground(this._backgroundBodyRectD3s[Y]),this._registerGestureEventsOnTimeAreaBackground(this._backgroundBodyRectD3s[z]),this._registerGestureEventsOnTimeAreaBackground(this._backgroundBodyD3s[Y]),this._registerGestureEventsOnTimeAreaBackground(this._backgroundBodyD3s[z]),this._initializeTimescaleDependentStripesOrDateLines(0);var t="url(#"+this.NXXXXX.WIDTH_CLIPPATH_ID[U]+this._uniqueID+")";this.options.isForExport||(this._verticalDragAreaParentD3=this._svgRootD3.append("g").attr("class","ngantt-vertical-drag-area-parent").attr("clip-path",t),this._horizontalDragAreaParentD3=this._svgRootD3.append("g").attr("class","ngantt-horizontal-drag-area-parent").attr("clip-path","url(#ngantt-body-clippath"+this._uniqueID+")")),this._backgroundWatermarkParentD3=this._svgRootD3.append("g").attr("class","ngantt-background-watermark-parent").style("opacity",this.options.watermarkOpacity),this._dateLineGridsParentD3=this._svgRootD3.append("g").attr("class","ngantt-date-line-grids-parent").attr("clip-path",t),this._dateLineGridsD3=this._dateLineGridsParentD3.append("g").attr("class","ngantt-date-line-grids"),this._backgroundDateAreasParentD3=this._svgRootD3.append("g").attr("class","ngantt-background-date-areas").attr("clip-path",t),this._backgroundDateAreasD3=this._backgroundDateAreasParentD3.append("g"),this._backgroundDateLinesParentD3=this._svgRootD3.append("g").attr("class","ngantt-background-date-lines").attr("clip-path",t),this._backgroundDateLinesD3=this._backgroundDateLinesParentD3.append("g")},_appendForeground:function(){"use strict";var e=this;this._super();var t="url(#"+this.NXXXXX.WIDTH_CLIPPATH_ID[U]+this._uniqueID+")";this._linkHotRegionsContainerD3=this._foregroundBodyParentD3s[z].append("g").attr("clip-path",t),this._linkHotRegionsD3=this._linkHotRegionsContainerD3.append("g").attr("class","ngantt-link-hot-regions"),this._linksContainerD3=this._foregroundBodyParentD3s[z].append("g").attr("clip-path",t),this._selectedLinksD3=this._linksContainerD3.append("g"),this._linksD3=this._linksContainerD3.append("g").attr("class","ngantt-links"),this._rowDateLinesContainerD3s=[],this._rowDateLinesD3s=[];for(var i=0;i<=1;i++)this._rowDateLinesContainerD3s[i]=this._foregroundBodyParentD3s[i].append("g").attr("clip-path",t),this._rowDateLinesD3s[i]=this._rowDateLinesContainerD3s[i].append("g").attr("class","ngantt-row-date-lines");var a=function(t,i,a,n,r,o){for(var s=e._svgRootD3.append("g").attr("class",a).attr("clip-path","url(#ngantt-body-clippath"+e._uniqueID+")"),l=0;l<=1;l++){var c=t[l]=s.append("g").attr("class",n[l]);o&&!e.options.isForExport&&c.attr("clip-path","url(#"+e.NXXXXX.BODY_PARENT_CLIPPATH_ID[l]+e._uniqueID+")"),i[l]=c.append("g").attr("class",r[l])}return s};if(this._highlightedBodyParentD3s=[],this._highlightedBodyD3s=[],this._highlightedBodyScrollParentD3=a(this._highlightedBodyParentD3s,this._highlightedBodyD3s,"ngantt-hlt-body-scroll-parent",xe,Re,!0),this._foregroundDateAreasParentD3=this._svgRootD3.append("g").attr("class","ngantt-foreground-date-areas").attr("clip-path",t),this._foregroundDateAreasD3=this._foregroundDateAreasParentD3.append("g"),this._foregroundDateLinesParentD3=this._svgRootD3.append("g").attr("class","ngantt-foreground-date-lines").attr("clip-path",t),this._foregroundDateLinesD3=this._foregroundDateLinesParentD3.append("g"),!this.options.isForExport){this._barSelectionFramesParentsD3=[],this._barSelectionFramesD3=[];for(i=0;i<=1;i++)this._barSelectionFramesParentsD3[i]=this._svgRootD3.append("g").attr("class",this.NXXXXX.BAR_SELECTION_FRAMES_PARENT_CLASS[i]).attr("clip-path","url(#"+this.NXXXXX.BODY_PARENT_CLIPPATH_ID[i]+this._uniqueID+")"),this._barSelectionFramesD3[i]=this._barSelectionFramesParentsD3[i].append("g").attr("class","ngantt-bar-selection-frames");this._phantomsBodyParentD3s=[],this._phantomsBodyD3s=[],this._phantomsBodyScrollParentD3=a(this._phantomsBodyParentD3s,this._phantomsBodyD3s,"ngantt-phantoms-body-scroll-parent",ke,Ve,!1),this._recordingSymbolD3=this._svgRootD3.append("g").attr("class","ngantt-recording-symbol").attr("visibility",this.options.recordingSymbolVisible?null:"hidden"),this._recordingSymbolD3.append("path").attr("transform","translate(4,4) scale(1.25)").attr("d","m16,0c8.83704,0 16,7.16299 16,16c0,8.83697 -7.16296,16 -16,16c-8.83698,0 -16,-7.16303 -16,-16c0,-8.83701 7.16302,-16 16,-16z"),this._recordingSymbolD3.append("text").attr("x",24.40045).attr("y",32.62427).attr("transform","matrix(0.7510551022804536,0,0,0.7407494025528649,5.890325738570294,5.413760407394605)").text("Rec")}if(this.options.isForExport){this._tableBodySplitterLineD3s||(this._tableBodySplitterLineD3s=[]);for(i=0;i<=1;i++)this._tableBodySplitterLineD3s[i]||(this._tableBodySplitterLineD3s[i]=this._svgRootD3.append("line").attr("class","ngantt-table-body-splitter-line"))}},_appendIOSScrollBars:function(){"use strict";this._super();for(var e=0;e<=1;e++)this._overlayAreas[U][e].appendIOSScrollBars(this._divScaleJQ)},_hideInvisiblesForPrinting:function(e,t){"use strict";switch(this._super(e,t),e.printingMode){case 0:break;case 1:case 2:this._hideInvisiblesForPrintingAtLast(e,t,"."+ee+",."+de),this._hideInvisiblesForPrintingAtLast(e,t,".ngantt-row")}},_calcRepeatedWidthForPrinting:function(){return this._layoutColumns[X].extent()+this._layoutColumns[G].extent()},_calcWidthDifference:function(e){"use strict";return this._calcInnerTimeAreaViewWidth(e)-this._layoutColumns[U].innerViewExtent()},_specifyNewViewWidth:function(e){"use strict";var t=[];return t[X]=this.actualTableViewWidth(),t[U]=this._calcTimeAreaViewWidth(e),t},_shouldHeightChange:function(e,t){"use strict";return e||Math.abs(t[z])>=1||Math.abs(t[Y])>=1},_shouldWidthChange:function(e,t){"use strict";return Math.abs(t)>=1},_calcTimeAreaViewWidth:function(e){"use strict";return e-this.actualTableViewWidth()-this._actualSplitterWidth()},_calcInnerTimeAreaViewWidth:function(e){"use strict";var t=this._calcTimeAreaViewWidth(e)-this._actualScrollBarWidth();return t<0&&(t=0),t},_doResizeOverlaysHeightWithAnimation:function(e){"use strict";this._super(e),this._overlayAreas&&(this._resizeBodyViewsOverlaysHeight(e,this._overlayAreas[U]),this._titleVisible($)&&this._overlayAreas[U][Z]._setViewTopHeightWithAnimation(e,this._actualTitleAreaTop($),this._actualTitleHeight($)+this._actualTitleAreaScrollBarWidth($)))},_PE_DoResizeHeight_222:function(e){"use strict";var t=this;if(t._super(e),t._barSelectionFramesParentsD3){var i=this._actualLayoutColumnLeft(U)+Ot;e(t._barSelectionFramesParentsD3[z].attr("transform","translate("+i+","+t._actualBodyViewTop(z)+")"))}},_getHorViewScrollOffset:function(e){"use strict";return e===U?this._timeAxis.timeAreaViewScrollOffset():this._super(e)},_getScrollOffsets:function(e,t){"use strict";return{horScrollOffset:this._getHorViewScrollOffset(e),verScrollOffset:this._overlayAreas[e][t].scrollTop()}},_PE_UpdateVirtualization:function(){this._createAndUpdateAllLinks(pt.LinkItemsChanged),this._super()},_PE_getParent:function(e){"use strict";var t=this,i=t._super(e);if(i)return i;var a=t._getDataItem(e,t._timeDataItemsMap,t._unusedTimeDataItemsMap);return a&&a.parentTimeDataItem?a.parentTimeDataItem.item:void 0},_PE_DoInvalidateRow_111:function(e){"use strict";for(;e=e.parentRowDataItem;)this._doCalculateSummaryTimeItemsInRow(e,!1,!0)},_PE_virt106:function(e,t){"use strict";e.oldSummariesExistent=e.summariesExistent,e.summariesExistent=void 0,t.barsChangedFlag&&this._updateRowDateLines(e),this.options.linksVisible&&this.options.linkItems&&this.options.linkItems.length&&!t.timeItemsWithLinksSet&&(t.timeItemsWithLinksSet={}),t.barsChangedFlag=!0},_PE_virt107:function(e,t,i){"use strict";var a=this;if(i.barsChangedFlag){var n={};Array.isArray(e.timeDataItems)&&(e.timeDataItems.forEach((function(e){n[e.id]=!0})),e.timeDataItems&&(e.timeDataItems.length=0)),e.summariesExistent=!1,Array.isArray(t.timeItems)&&t.timeItems.forEach((function(t){var r=a._createTimeDataItemAndChildrenRecursively(t,e,n);r&&a._getActualBarType(r)&it.Summary&&(e.summariesExistent=!0),i.timeItemsWithLinksSet&&(r&&r.linkCounter&&(i.timeItemsWithLinksSet[r.id]=!0),Array.isArray(t.childTimeItems)&&t.childTimeItems.forEach((function(e){var t=a._getDataItem(e,a._timeDataItemsMap);t&&t.linkCounter&&(i.timeItemsWithLinksSet[t.id]=!0)})))})),Object.keys(n).forEach((function(e){var t=a._timeDataItemsMap[e];t&&(delete t.parentTimeDataItem,delete t.rowDataItem,a.options.autoDisposeOfUnusedItems||(a._unusedTimeDataItemsMap[t.id]=t),delete a._timeDataItemsMap[t.id],t.selected&&a._selectedTimeItems.splice(a._selectedTimeItems.indexOf(t.item),1),delete t.selected)}))}else{if(Array.isArray(t.timeItems))for(var r=0;r<t.timeItems.length;r++){var o=a._getDataItem(t.timeItems[r],a._timeDataItemsMap);if(o&&a._getActualBarType(o)&it.Summary){e.summariesExistent=!0;break}}i.timeItemsWithLinksSet&&Array.isArray(t.timeItems)&&t.timeItems.forEach((function(e){var t=a._getDataItem(e,a._timeDataItemsMap);t&&t.linkCounter&&(i.timeItemsWithLinksSet[t.id]=!0),Array.isArray(e.childTimeItems)&&e.childTimeItems.forEach((function(e){var t=a._getDataItem(e,a._timeDataItemsMap);t&&t.linkCounter&&(i.timeItemsWithLinksSet[t.id]=!0)}))}))}e.summariesExistent&&((i.barsChangedFlag||i.childRowsChangedFlag)&&a._doCalculateSummaryTimeItemsInRow(e,!1,!1),e.oldSummariesExistent||(i.barsChangedFlag=!0)),i.barsChangedFlag&&(a.options.automaticCalculationOfSubRowIndexesOfBarsInRow?a._calculateSubRowIndexesOfBarsInRow(e):a._invalidRowDataItemIDsForSubRowIndexesMap[e.id]=!0),a._updateOfRowsNeeded=!0},_PE_GetFrameRectD3:function(e){"use strict";var t=this,i=t._super(e);if(!i){var a=t._getDataItem(e,t._timeDataItemsMap);if(a){var n=a.elem;if(n){var o,s,l=t._getBodyAreaIndex(a.rowDataItem.item),c=t.getItemBoundingRect(e),d=-3+c.xOffset,m=-3+c.yOffset;return t.options.barSelectionFramesShownWithHigherZOrder?(d+=a.newX,m+=a.newY+a.rowDataItem.visibleRowDataItem.newY,o=t.convertXToLimitedX(d),s=t.convertXToLimitedX(d+c.width+6),i=t._barSelectionFramesD3[l].append("rect")):(o=d,s=d+c.width+6,i=r.select(n).append("rect")),i.attr("x",o).attr("y",m).attr("rx",3).attr("ry",3).attr("width",s-o).attr("height",c.height+6).attr("class",t.NXXXXX.TEMP_MARKING_CLASS),t.options.scrollToItemHighlightingColor&&i.style("stroke",t.options.scrollToItemHighlightingColor),i}}}return i},_PE_OnDragEvent_Interaction:function(){return rt.Move},_PE_SelectRowCancelled:function(){"use strict";return!!this._selectedTimeItems.length},_PE_SelectRow_111:function(e){"use strict";e.oldSelectedTimeItems=this._selectedTimeItems.slice()},_PE_SelectedRowItems_01:function(e){"use strict";var t=this;e.length&&(t.options.timeItemsHaveSameReferenceAsRowItems||t._changeTimeItemSelection([]),t._changeLinkItemSelection([]))},_PE_virt104:function(e){return this._getRowMainHeight(e)},_PE_CellWidth:function(e,t,i,a){return a},_PE_CreateTableRow_Classes:function(e,t){"use strict";var i=this._super(e,t);return this._enrichClass(e,i,{elemType:t,level:e.level})},_PE_Selectable:function(e){"use strict";var t=e.item.selectable;return null==t?e.isLeaf?this.options.defaultLeafRowItemSelectable:this.options.defaultRowItemSelectable:t},_PE_LastColumnWidth:function(e,t){return t},_PE_TableRowWidth:function(){return Math.max(this.actualTableWidth(),this.actualTableViewWidth())},_PE_TmpOffset:function(){return this._layoutColumns[X].innerViewExtent()-this._fixedTableColumnsWidthSucceeding},_PE_X2:function(){return Math.max(this.actualTableViewWidth(),this._actualScrollableWidth(X))},_PE_TranslateWidth:function(){return this._layoutColumns[X].innerViewExtent()-this._fixedTableColumnsWidthSucceeding},_PE_RecalculateTableWidth:function(e,t,i){"use strict";e!==t.length-1?this._setViewWidth(X,this._tableViewWidthAtStartDrag):this._setViewWidth(X,this._layoutColumns[X].innerViewExtent()+i),this._tableViewChanged(!0,!0)},_PE_LocalActualTableWidth:function(){return this._layoutColumns[X].innerViewExtent()},_PE_CreateRowContent:function(e,t,i,a,n){"use strict";this._createTimeAreaRow(e,t,!1,a,n),this._super(e,t,i,a,n),this._createTimeAreaRow(e,i,!0,a,n)},_PE_Unrealized:function(e,t,i){"use strict";e.virtualizationStatus===ft&&(this._createTimeAreaRow(e,void 0,!0,t,i,!0),e.virtualizationStatus=gt)},_PE_D3Selection:function(){return"."+ee+",."+de},_detachRowContents:function(e,t){"use strict";var i=this;delete e.datum().zOrdersToBarLayersD3Maps,e.selectAll(i._PE_D3Selection()).each((function(e){i._detachTimeDataItem(e,r.select(this),t)}))},_verSBLayoutColumn:function(){return U},_PE_DefaultWidth:function(e){return e===X?0:1/0},_innerClientXToLayoutColumn:function(e){"use strict";return e>=this._actualLayoutColumnLeft(U)&&e<this._actualInnerLayoutColumnRight(U)?U:this._super(e)},_PE_GetTableRowD3:function(e){return r.select(e.foregroundRowElem).select("."+this.NXXXXX.TABLE_ROW_CLASS)},_PE_SetTimeAreaViewScrollOffset:function(e,t){"use strict";this._timeAxis.timeAreaViewScrollOffset(e,t),this._layoutColumns[U].scrollStart(this._timeAxis.timeAreaViewScrollOffset())},_ignoreNextScrollEvents:function(e,t){"use strict";this._super(e,t),void 0!==t&&t!==U||(this._ignoreNextScrollEvents[U]=[e,e])},_getChartSizeForWorldView:function(){var e=this._super();return this._timeAxis&&(e.width+=this._timeAxis.actualTimeAreaWidth()),e.widthPx=2,e},_renderCompleteWorldView:function(){var e=this;if(e._super(),e._foregroundBodyD3s){var t=e._worldViewDivJQ.nWorldViewCanvasWidget("instance"),i=e.actualTableWidth(),a=e._getChartSizeForWorldView(),n=function(n){if(Array.isArray(e.options.dateLines)){var o=e._timeAxis,s=o.actualStart(),l=o.actualEnd(),c=function(e){if(e&&"none"!==e)return e.split(/, /).map((function(e){return parseFloat(e)}))};e.options.dateLines.forEach((function(d){if(d.id&&!1!==d.inForeground===n){var m=r.select(e._dateLineIDsToSVGElementsMap[d.id]).select("line").node(),u=d.date;if(d.date&&d.date>=s&&d.date<l){var h=i+o.convertDateToX(u);t.drawLine(v.DateLines,{strokeStyle:window.getComputedStyle(m).stroke,lineDash:c(window.getComputedStyle(m).getPropertyValue("stroke-dasharray")),lineWidth:1},{x0:h,y0:e.options.titleHeight,y0Px:1,x1:h,y1:a.height,xPx:1,y1Px:a.heightPx})}}}))}};n(!1),t.drawLine(v.Content,{strokeStyle:"black",lineWidth:1},{x0:i,y0:0,x1:i,y1:a.height,y1Px:a.heightPx-1});var o=e._timescaleD3s[0].select(".ntimescale-ribbon-cell-rect:not(.ntimescale-ribbon-cell-weekend),.ntimescale-ribbon-cell-rect");if(o.size()&&t.fillRect(v.Content,{fillStyle:window.getComputedStyle(o.node()).fill},{left:i,leftPx:1,top:0,width:a.width-i,height:e.options.titleHeight}),t.drawLine(v.Content,{strokeStyle:"black",lineWidth:1},{x0:i,y0:e.options.titleHeight,x1:a.width,y1:e.options.titleHeight,x1Px:1}),e._actualBodyAreaSeparatorHeight()){var s=e.options.titleHeight+e._layoutRows[Y].extent();t.drawLine(v.Content,{strokeStyle:"black",lineWidth:1},{x0:i,y0:s,x1:a.width,y1:s,xPx:a.widthPx,yPx:1})}n(!0),t.drawLine(v.Content,{strokeStyle:"black",lineWidth:1},{x0:a.width,y0:0,x1:a.width,y1:a.height,xPx:a.widthPx-1,y1Px:a.heightPx-1})}},_onViewRectMovedInWorldView:function(e){var t=this;t._super.apply(t,arguments);var i=[e.newLeftTop.x],a=[e.newLeftTop.y];e.viewRect.tableBase_colIndex&&(i[0]-=t._layoutColumns[0].extent()),e.viewRect.tableBase_rowIndex&&t._layoutRows[0].innerViewExtent()&&(a[0]-=t._layoutRows[0].extent()),t.scrollTo(i[e.viewRect.tableBase_colIndex],i[1-e.viewRect.tableBase_colIndex],a[1-e.viewRect.tableBase_rowIndex],a[e.viewRect.tableBase_rowIndex])},_clearAdditionalLayoutGridColumnsInWorldView:function(e,t,i,a,n){this._super.apply(this,arguments),e.clearRect(v.Selection,{left:i,leftPx:1,top:a,topPx:n,width:this._timeAxis.actualTimeAreaWidth(),height:t.totalHeight})},_renderCachedRowInWorldView:function(e,t){var i=this;if(i._super.apply(this,arguments),e.totalHeight){var a=i._worldViewDivJQ.nWorldViewCanvasWidget("instance");if(!t||t.indexOf("C")>=0){var n=i._getTopOfRowDataItemForWorldView(e);a.clearRect(v.Content,{left:i._tableWidth,leftPx:1,top:n.top,topPx:n.topPx,width:i._timeAxis.actualTimeAreaWidth(),height:e.totalHeight});var r=e.worldViewBarCacheMap;r&&Object.keys(r).forEach((function(e){var t=r[e];a[t.method].apply(a,t.args)}))}}}};n.widget("netronic.nGanttWidget",n.netronic.nTableBaseWidget,Vt);var kt=n.netronic.nGanttWidget;kt.CALGRID_CLASS=ce,kt.WIDGET_CLASS="ngantt-widget",kt.NAMESPACE=qe,kt.ROW_HEIGHT_PROP_CLASS=He,kt.BAR_WIDTH_DEPENDENT_PROP_CLASS=le,kt.BarInteractions=rt,kt.BarType=at,kt.BarShape=nt,kt.BarSnapTargets=st,kt.ConstraintType=et,kt.DateLineGridRecurrence=Je,kt.DateLineLabelOrientation=mt,kt.DisplayedElements=tt,kt.ElemType=$e,kt.HorizontalAlignment=Dt,kt.LinkType=lt,kt._LinkTypeFlags={SourceStart:2,TargetEnd:1},kt.TableRowDefinitionType=kt.TableRowDefinitionTypes=ht,kt.TimeAxisZoom=dt,e.exports=kt},2354:function(e,t,i){var a=i(3755),n=i(9748),r=n.PortDirections,o=n.RoutingType,s=function e(t){if(!(this instanceof e))return new e(t);this.options=a.extend({},{sourcePortSectionExtent:5,targetPortSectionExtent:5,routingType:o.Curved,timeAxis:null,xCoordinateLimiter:null},t);var i=t.xCoordinateLimiter;this._transformXToLimitedX=i?function(e){return i.transform(e)}:function(e){return e}};a.extend(s.prototype,{determinePath:function(e){return(void 0!==e.routingType?e.routingType:this.options.routingType)===o.Orthogonal?this._determineOrthogonalPath(e):this._determineCurvedPath(e)},_determineCurvedPath:function(e){var t={x:e.source.x,y:e.source.y},i={x:e.target.x,y:e.target.y},a=function(e){return Math.floor(e.x)+","+Math.floor(e.y)},n=this._transformXToLimitedX;switch(e.source.portDirection){case r.Left:t.x+=this.options.sourcePortSectionExtent;break;case r.Right:t.x-=this.options.sourcePortSectionExtent;break;case r.Up:t.y-=this.options.sourcePortSectionExtent;break;case r.Down:t.y+=this.options.sourcePortSectionExtent}switch(e.target.portDirection){case r.Left:i.x-=this.options.targetPortSectionExtent;break;case r.Right:i.x+=this.options.targetPortSectionExtent;break;case r.Up:i.y-=this.options.targetPortSectionExtent;break;case r.Down:i.y+=this.options.targetPortSectionExtent}var o={},s={};switch(e.source.portDirection){case r.Left:case r.Right:o.x=n((t.x+i.x)/2),o.y=t.y;break;case r.Up:case r.Down:o.x=n(t.x),o.y=(t.y+i.y)/2}switch(e.target.portDirection){case r.Left:case r.Right:s.x=n((i.x+t.x)/2),s.y=i.y;break;case r.Up:case r.Down:s.x=n(i.x),s.y=(i.y+t.y)/2}return t.x=n(t.x),i.x=n(i.x),"M"+a(t)+"C"+a(o)+" "+a(s)+" "+a(i)},_determineOrthogonalPath:function(e){var t=this._transformXToLimitedX,i=this.options.timeAxis,a="",n=e.source,o={x:n.x,y:n.y},s=e.target,l={x:s.x,y:s.y};if(n.portDirection===r.Left?o.x-=this.options.sourcePortSectionExtent:n.portDirection===r.Right&&(o.x+=this.options.sourcePortSectionExtent),s.portDirection===r.Left?l.x-=this.options.targetPortSectionExtent:s.portDirection===r.Right&&(l.x+=this.options.targetPortSectionExtent),n.y===s.y&&n.portDirection===r.Up&&s.portDirection===r.Up){var c=Math.abs(n.x-s.x),d=this.options.sourcePortSectionExtent+this.options.targetPortSectionExtent;if(c<d){var m=(d-c)/2;n.y>s.x&&(m=-m),n.x-=m,s.x+=m}}var u=void 0;if(a+="M"+t(n.x)+","+n.y,n.y===s.y&&n.portDirection&(r.Left|r.Right)&&s.portDirection&(r.Left|r.Right)&&(u=n.y),void 0===u&&(n.y===s.y&&n.portDirection===r.Right&&s.portDirection===r.Left||n.portDirection===r.Right&&l.x>=o.x||n.portDirection===r.Left&&l.x<=o.x))if(i){var h=i.convertXToDate(Math.min(l.x,o.x)+1),p=i.convertXToDate(Math.max(l.x,o.x)-2);n.allocatedTimeSpans&&n.allocatedTimeSpans.isTimeSpanAllocated(h,p)||(u=n.y)}else u=n.y;if(void 0===u&&(s.portDirection===r.Right&&l.x<=o.x||s.portDirection===r.Left&&l.x>=o.x))if(i){h=this.options.timeAxis.convertXToDate(Math.min(l.x,o.x)+1),p=this.options.timeAxis.convertXToDate(Math.max(l.x,o.x)-2);s.allocatedTimeSpans&&s.allocatedTimeSpans.isTimeSpanAllocated(h,p)||(u=s.y)}else u=s.y;return void 0===u&&l.x>=o.x&&(n.portDirection===r.Down?u=n.yBelow:n.portDirection===r.Up&&(u=n.yAbove)),void 0===u&&(u=s.y>n.y?n.yBelow:n.yAbove),a+="H"+t(o.x),a+="V"+u,a+="H"+t(l.x),a+="V"+s.y,a+="H"+t(s.x)}}),s.PortDirections=r,s.RoutingType=o,e.exports=s},978:function(e,t,i){var a=i(3755),n=i(9748),r=n.NGANTT_BAR_RECT_CLASS,o=n.NGANTT_BAR_RECT_CAL_CLASS,s=n.NGANTT_BAR_PATH_CAL_CLASS,l=n.NGANTT_BAR_OUTLINE_CLASS,c=n.NGANTT_BAR_PHANTOM_NONWORK_CLASS,d=n.NGANTT_BAR_WIDTH_DEPENDENT_PROP_CLASS,m=n.NGANTT_COMPOUND_BAR_BACKGROUND_CLASS,u=n.NGANTT_COMPOUND_BAR_FOREGROUND_CLASS,h=n.BarType,p=n.ElemType,_=n.TimeType,f=i(5645),g=function(){};a.extend(g.prototype,{createBar:function(e){if(e.respectingCalendar){var t=e.barD3.classed(m),i=t||e.barD3.classed(u);i||(e.barD3.append("rect").attr("class",e.enrichClassFunc(r+" "+o+" "+d,{elemType:p.BarRectangle,shape:e.barShapeId})).attr("height",e.barHeight),e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+s,{elemType:p.BarRectangle,shape:e.barShapeId})))}else e.barD3.append("rect").attr("class",e.enrichClassFunc(r+" "+s+" "+d,{elemType:p.BarRectangle,shape:e.barShapeId})).attr("height",e.barHeight);if(t||(f.createProgressBar(e),f.createPredictedEndBar(e)),i||f.separateBarShapeOutlinesEnabled){e.barD3.selectAll("rect."+r).style("stroke-width",0),e.barD3.selectAll("path."+r).style("stroke-width",0);var a=e.barD3.append("rect").attr("class",e.enrichClassFunc(r+" "+l,{elemType:p.BarRectangle,shape:e.barShapeId})).attr("height",e.barHeight);i||a.style("fill","transparent")}t||f.createConstraintSymbols(e)},positionBar:function(e){if(e.barD3){var t=!e.calendar||e.calendar.determineTimeType(e.timeRange.start)===_.WorkingTime,i=e.convertXToLimitedX,a=e.barD3.classed(m),n=a||e.barD3.classed(u);if(!n&&e.calendar){for(var r="M0,"+(t?"0":e.barHeight),o=e.timeRange.start,d=i(e.timeAxis.convertDateToX(e.timeRange.start));null!==(o=e.calendar.findStartOfNextTimeTypeChange(o))&&o.getTime()<e.timeRange.end.getTime();){t=!t,r=r+"H"+(i(e.timeAxis.convertDateToX(o))-d)+"V"+(t?"0":e.barHeight)}e.barD3.select("path."+s).attr("d",r+"H"+e.width+"V"+e.barHeight+"H0V0")}if((n||f.separateBarShapeOutlinesEnabled)&&e.barD3.select("rect."+l).attr("width",Math.max(1,e.width)),e.draggingLeftSide||e.draggingRightSide){var h="";e.openOnLeftSide?h="M"+e.pointerX+","+e.barHeight+"H0M"+e.pointerX+","+e.barHeight+"V0M"+e.pointerX+",0H0":e.openOnRightSide&&(h="M"+e.width+",0H"+e.pointerX+"M"+e.pointerX+",0V"+e.barHeight+"M"+e.width+","+e.barHeight+"H"+e.pointerX),e.barD3.select("path."+c).attr("d",h)}a||(f.positionProgressBar(e),f.positionConstraintSymbols(e),f.positionPredictedEndBar(e))}e.worldViewVisible&&(e.worldViewPathData=[{x:0,y:0},{x:e.worldViewBarWidth,y:0},{x:e.worldViewBarWidth,y:e.barHeight},{x:0,y:e.barHeight},{x:0,y:0}])},checkForBarType:function(e){return e===h.StartEnd||e===h.StartDuration||e===h.EndDuration}}),e.exports=g},474:function(e,t,i){var a=i(3755),n=i(9748),r=n.NGANTT_BAR_RECT_CLASS,o=n.NGANTT_BAR_RECT_CAL_CLASS,s=n.NGANTT_BAR_PATH_CAL_CLASS,l=n.NGANTT_BAR_OUTLINE_CLASS,c=n.NGANTT_BAR_PHANTOM_NONWORK_CLASS,d=n.NGANTT_COMPOUND_BAR_BACKGROUND_CLASS,m=n.NGANTT_COMPOUND_BAR_FOREGROUND_CLASS,u=n.BarType,h=n.ElemType,p=n.TimeType,_=i(5645),f=function(){};a.extend(f.prototype,{createBar:function(e){if(e.respectingCalendar){var t=e.barD3.classed(d),i=t||e.barD3.classed(m);i||(e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+o,{elemType:h.BarRectangle,shape:e.barShapeId})),e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+s,{elemType:h.BarRectangle,shape:e.barShapeId})))}else e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+s,{elemType:h.BarRectangle,shape:e.barShapeId}));if(t||(_.createProgressBar(e),_.createPredictedEndBar(e)),i||_.separateBarShapeOutlinesEnabled){e.barD3.selectAll("path."+r).style("stroke-width",0);var a=e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+l,{elemType:h.BarRectangle,shape:e.barShapeId}));i||a.style("fill","transparent")}t||_.createConstraintSymbols(e)},positionBar:function(e){if(e.barD3){var t,i,a=!e.calendar||e.calendar.determineTimeType(e.timeRange.start)===p.WorkingTime,n=e.draggingLeftSide?Math.min(e.pointerX,0)+e.ganttWidget.options.barCornerWidth:e.ganttWidget.options.barCornerWidth,r=Math.max(n,0),u=e.convertXToLimitedX,h=Math.max(0,e.width),f=e.barD3.classed(d),g=f||e.barD3.classed(m);if(i="M0,"+e.barHeight+"V"+r,g||(t=a?"M0,"+e.barHeight+"V"+r:"M0,"+e.barHeight),i+=h<r?"L"+h+","+(r-h):"L"+r+",0H"+h,i+="V"+e.barHeight+"H0",!g){if(e.calendar)for(var T=0,D=e.timeRange.start,v=u(e.timeAxis.convertDateToX(e.timeRange.start));null!==(D=e.calendar.findStartOfNextTimeTypeChange(D))&&D.getTime()<e.timeRange.end.getTime();){a=!a;var y=u(e.timeAxis.convertDateToX(D))-v;a?t+=y<n?"H"+y+"V"+(n-y):"H"+y+"V0":(t+=T<n?y<=n?"L"+y+","+(n-y):"L"+n+",0H"+y:"H"+y,t+="V"+e.barHeight),T=y}a&&(h<n?t+="L"+h+","+(n-h):(T<n&&(t+="L"+n+",0"),t+="H"+h),t+="V"+e.barHeight),e.barD3.select("path."+s).attr("d",e.calendar?t+"H0":i+"H0"),e.barD3.select("path."+o).attr("d",i)}if((g||_.separateBarShapeOutlinesEnabled)&&e.barD3.select("path."+l).attr("d",i),e.draggingLeftSide||e.draggingRightSide){var w="";e.openOnLeftSide?(w="M"+e.pointerX+","+e.barHeight+"H0M"+e.pointerX+","+e.barHeight+"V"+e.ganttWidget.options.barCornerWidth,w+=n>0?"L0,"+n:"L"+n+",0H0"):e.openOnRightSide&&(w="M"+h+",",h<n?(w+=Math.max(n-h,0),e.pointerX<n?w+="L"+e.pointerX+","+(n-e.pointerX):w+="L"+n+",0H"+e.pointerX):w+="0H"+e.pointerX,w+="M"+e.pointerX+",0V"+e.barHeight+"M"+h+","+e.barHeight+"H"+e.pointerX),e.barD3.select("path."+c).attr("d",w)}f||(_.positionProgressBar(e),_.positionConstraintSymbols(e),_.positionPredictedEndBar(e))}e.worldViewVisible&&(e.worldViewPathData=[{x:0,y:0},{x:e.worldViewBarWidth,y:0},{x:e.worldViewBarWidth,y:e.barHeight},{x:0,y:e.barHeight},{x:0,y:0}])},checkForBarType:function(e){return e===u.StartEnd||e===u.StartDuration||e===u.EndDuration}}),e.exports=f},5645:function(e,t,i){i(9554),i(9600),i(1539),i(9714),i(4747);var a=i(9748),n=a.NGANTT_CONSTRAINT_LINE_CLASS,r=a.NGANTT_CONSTRAINT_SYMBOL_CLASS,o="ngantt-predicted-end-bar",s="ngantt-progress-bar",l="ngantt-progress-bar-background",c="ngantt-progress-nonworking-bar",d=a.BarShape,m=a.ElemType,u=a.TimeType,h=a.ConstraintType,p={isTextClippingAllowed:function(e){switch(e){case d.Diamond:case d.ArrowLeft:case d.ArrowRight:return!1;default:return!0}},createProgressBar:function(e){var t=e.dataItem.item;t.progressBackgroundVisible&&e.barD3.append("rect").attr("class",l).attr("height",e.ganttWidget.options.progressBarHeight).attr("y",e.barHeight-e.ganttWidget.options.progressBarHeight),t.progress&&(e.respectingCalendar?(e.barD3.append("rect").attr("class",c).attr("height",e.ganttWidget.options.progressBarHeight).attr("y",e.barHeight-e.ganttWidget.options.progressBarHeight),e.barD3.append("path").attr("class",s)):e.barD3.append("rect").attr("class",s).attr("height",e.ganttWidget.options.progressBarHeight).attr("y",e.barHeight-e.ganttWidget.options.progressBarHeight))},positionProgressBar:function(e){var t=e.dataItem.item;if(t){if(t.progressBackgroundVisible){var i=e.convertXToLimitedX,a=e.barD3.select(".ngantt-progress-bar-background");if(!a.empty()){var n=i(e.timeAxis.convertDateToX(e.timeRange.end))-(l=i(e.timeAxis.convertDateToX(e.timeRange.start)));a.attr("width",n)}}if(t.progress){i=e.convertXToLimitedX;var r=e.barD3.select(".ngantt-progress-bar");if(!r.empty()){var o=e.calculateProgressFunc.call(this);if(o){var s=i(e.timeAxis.convertDateToX(o)),l=i(e.timeAxis.convertDateToX(e.timeRange.start)),c=Math.max(0,s-l);if(e.calendar){var d="",m=e.timeRange.start,h=0;if(e.calendar.determineTimeType(m)!==u.WorkingTime&&(m=e.calendar.findStartOfNextTimeTypeChange(m))&&(h=i(e.timeAxis.convertDateToX(m))-l),m&&m.getTime()<o.getTime()){for(;;){(!(m=e.calendar.findStartOfNextTimeTypeChange(m))||m.getTime()>o.getTime())&&(m=o);var p=Math.max(i(e.timeAxis.convertDateToX(m))-l,0);if(d+="M"+h+","+(e.barHeight-e.ganttWidget.options.progressBarHeight)+"H"+p+"V"+e.barHeight+"H"+h+"Z",!(m=e.calendar.findStartOfNextTimeTypeChange(m))||m.getTime()>=o.getTime())break;h=i(e.timeAxis.convertDateToX(m))-l}r.attr("d",d)}}r.attr("width",c),e.barD3.select(".ngantt-progress-nonworking-bar").attr("width",c)}}}}},createPredictedEndBar:function(e){e.dataItem.item.predictedEnd&&e.barD3.append("rect").attr("class",o).attr("height",e.ganttWidget.options.predictedEndBarHeight).attr("y",e.barHeight-e.ganttWidget.options.predictedEndBarHeight)},positionPredictedEndBar:function(e){var t=e.dataItem.item;if(t&&t.predictedEnd){var i=e.convertXToLimitedX,a=e.barD3.select(".ngantt-predicted-end-bar");if(!a.empty()){var n=i(e.timeAxis.convertDateToX(t.predictedEnd)),r=i(e.timeAxis.convertDateToX(e.timeRange.start)),o=i(e.timeAxis.convertDateToX(e.timeRange.end)),s=o-n,l=s<0?o-r:n-r;a.attr("width",Math.abs(s)).attr("x",l)}}},createConstraintSymbols:function(e){var t=e.dataItem.item;if(t.constraints){if(e.rowDataItem.isHidden)return;t.constraints.forEach((function(t,i){e.barD3.insert("line",":first-child").attr("class",e.enrichClassFunc(n+" "+n+i,{elemType:m.ConstraintDateLine,constraintDateIndex:i})).attr("y1",-1).attr("y2",-1),e.barD3.insert("path",":first-child").attr("class",e.enrichClassFunc(r+" "+r+i,{elemType:m.ConstraintDateSymbol,constraintDateIndex:i})),(null==e.dataItem.outerStart||e.dataItem.outerStart>t.date)&&(e.dataItem.outerStart=t.date),(null==e.dataItem.outerEnd||e.dataItem.outerEnd<t.date)&&(e.dataItem.outerEnd=t.date)}))}else e.dataItem.outerStart=e.dataItem.outerEnd=void 0},positionConstraintSymbols:function(e){var t=e.dataItem.item;if(t.constraints){var i=e.convertXToLimitedX,a=i(e.timeAxis.convertDateToX(e.timeRange.start)),o=i(e.timeAxis.convertDateToX(e.timeRange.end));t.constraints.forEach((function(t,s){var l=e.barD3.select("."+r+s);if(!l.empty()){var c=e.timeAxis.convertDateToX(t.date),d=i(c),m=e.barD3.select("."+n+s);d<a?m.attr("visibility",null).attr("x1",d-a).attr("x2",0):d>o?m.attr("visibility",null).attr("x1",d-a).attr("x2",o-a):m.attr("visibility","hidden");var u,p=e.ganttWidget.options.constraintSymbolHeight,_=e.ganttWidget.options.detailedConstraintSymbolsEnabled,f=["M",(d-a).toString(),",-1l",(p/2).toString(),",-",p.toString(),"h-",p.toString(),"Z"].join(""),g=t.date.getTime();switch(t.type){case h.StartNoEarlierThan:u=e.timeRange.start.getTime()<g,_&&(f=["M",(d-a).toString(),",0v-14h1l6,4l-6,4v6Z"].join(""));break;case h.EndNoEarlierThan:u=e.timeRange.end.getTime()<g,_&&(f=["M",(d-a).toString(),",0v-14h7v7h-6v6Z"].join(""));break;case h.StartNoLaterThan:u=e.timeRange.start.getTime()>g,_&&(f=["M",(d-a).toString(),",0v-14h-1l-6,4l6,4v6Z"].join(""));break;case h.EndNoLaterThan:u=e.timeRange.end.getTime()>g,_&&(f=["M",(d-a).toString(),",0v-14h-7v7h6v6Z"].join(""));break;case h.MustStartOn:u=e.timeRange.start.getTime()!==g,_&&(f=["M",(d-a).toString(),",0v-6l",(p/2).toString(),",-",p.toString(),"h-",(p+1).toString(),"l",(p/2).toString(),",",p.toString(),"v6Z"].join(""));break;case h.MustEndOn:u=e.timeRange.end.getTime()!==g,_&&(f=["M",(d-a).toString(),",0v-7h3v-7h-7v7h3v7Z"].join(""))}l.attr("d",f),t.color&&l.style("fill",t.color),e.ganttWidget.options.constraintViolationsVisible&&u&&l.style("fill","#E01818")}}))}}};e.exports=p},9873:function(e,t,i){var a=i(3755),n=i(9748),r=n.NGANTT_BAR_RECT_CLASS,o="ngantt-summary-bar-path",s=n.NGANTT_BAR_TEXT_CLASS,l=n.NGANTT_COMPOUND_BAR_BACKGROUND_CLASS,c=n.BarType,d=n.ElemType,m=i(5645),u=function(){};a.extend(u.prototype,{createBar:function(e){e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+o,{elemType:d.BarRectangle,shape:e.barShapeId})),e.barD3.classed(l)||m.createConstraintSymbols(e)},positionBar:function(e){e.barD3&&(e.barD3.select(".ngantt-summary-bar-path").attr("d","M0,0V"+e.barHeight+"L"+Math.min(e.barHeight/2,e.width)+","+e.barHeight/2+"H"+Math.max(e.width-e.barHeight/2,0)+"L"+e.width+","+e.barHeight+"V0H0"),e.barD3.selectAll("."+s+", ."+s+" tspan").attr("x",8).attr("y",e.barHeight),e.barD3.classed(l)||m.positionConstraintSymbols(e));e.worldViewVisible&&(e.worldViewPathData=[{x:0,y:e.barHeight},{x:Math.min(e.barHeight/2,e.worldViewBarWidth),y:e.barHeight/2},{x:Math.max(e.worldViewBarWidth-e.barHeight/2,0),y:e.barHeight/2},{x:e.worldViewBarWidth,y:e.barHeight},{x:e.worldViewBarWidth,y:0},{x:0,y:0},{x:0,y:e.barHeight}])},checkForBarType:function(e){return e===c.StartEnd||e===c.StartDuration||e===c.EndDuration}}),e.exports=u},3670:function(e,t,i){i(6541);var a=i(3755),n=i(7930).nDateHelper,r=i(9748).TimeUnit,o=i(7857),s=function e(){if(!(this instanceof e))return new e;this._start=new Date,this._end=new Date(this._start.getTime()+864e5),this._baseTimeUnit=r.Seconds,this._baseTimeUnitWidth=1,this._actualTimeAreaWidth=0,this._timeAreaViewWidth=0,this._timeAreaViewScrollOffset=0,this._actualStart=null,this._actualEnd=null,this._actualStartPlusOneBaseTimeUnit=null,this._actualBaseTimeUnitWidth=1,this._currentlyVisibleStart=null,this._currentlyVisibleEnd=null,this._collapseCalendar=null,this._isCachingEvents=!1,this._eventArgsCached=null,this._eventIsPending=!1,this._lastDate=null,this._lastDuration=0,this._visualZoomFactor=1};a.extend(s.prototype,{cacheEvents:function(){this._isCachingEvents=!0},triggerCachedEvents:function(){this._isCachingEvents=!1,this._eventArgsCached&&(this._trigger(this._eventArgsCached),this._eventArgsCached=null)},anythingChangedCallback:function(e){return void 0!==e&&(this._eventFunc=e),this._eventFunc},_anyTimePropertyChanged:function(){var t=this._collapseCalendar;this._timeRangeHasWorkingTime=o.hasWorkingTime(t,this._actualEnd,this._actualStart),this._baseTimeUnitInMilliseconds=1e3*e.exports.timeUnitToSeconds(this._baseTimeUnit);var i=this._actualBaseTimeUnitWidth,a=this._actualStart,n=this._actualEnd,r=this._actualTimeAreaWidth;this._actualStart=this._start,this._timeRangeHasWorkingTime||i===this._actualBaseTimeUnitWidth&&this._start.getTime()==a||(this._actualStartPlusOneBaseTimeUnit=new Date(this._actualStart.getTime()+this._baseTimeUnitInMilliseconds)),this._actualEnd=this._end;var s,l=(this._timeRangeHasWorkingTime?o.calculateWorkingTime(t,this._end,this._start):this._baseTimeUnitInMilliseconds)/this._baseTimeUnitInMilliseconds;l<1&&(l=1,null!==(s=o.addWorkingTime(t,this._actualStart,l*this._baseTimeUnitInMilliseconds))&&(this._actualEnd=s));(this._actualBaseTimeUnitWidth=this._baseTimeUnitWidth,this._actualTimeAreaWidth=Math.ceil(l*this._actualBaseTimeUnitWidth-1e-4),this._actualTimeAreaWidth<100)&&(this._actualTimeAreaWidth=100,0!==this._baseTimeUnitWidth&&null!==(s=o.addWorkingTime(t,this._actualStart,this._actualTimeAreaWidth/this._baseTimeUnitWidth*this._baseTimeUnitInMilliseconds))&&(this._actualEnd=s));this._actualTimeAreaWidth<this._timeAreaViewWidth&&(this._actualBaseTimeUnitWidth=this._timeAreaViewWidth/l,this._actualTimeAreaWidth=this._timeAreaViewWidth);var c=this.convertDateToX(this._actualEnd);c<this._timeAreaViewScrollOffset+this._timeAreaViewWidth-1&&(this._timeAreaViewScrollOffset=c-this._timeAreaViewWidth+1);var d=!1;if((this._actualBaseTimeUnitWidth!==i||this._actualStart!=a||this._actualEnd!=n||this._actualTimeAreaWidth!=r)&&(d=!0),this._currentlyVisibleStart=this.convertXToDate(this._timeAreaViewScrollOffset),this._currentlyVisibleEnd=this.convertXToDate(this._timeAreaViewScrollOffset+this._timeAreaViewWidth-1),d){delete this._fittedTimeAreaViewStart,delete this._fittedTimeAreaViewEnd;var m={sender:this};this._isCachingEvents?this._eventArgsCached||(this._eventArgsCached=m):this._trigger(m)}},_trigger:function(e){if(!this._eventIsPending&&this._eventFunc){this._eventFunc(e)}},convertDateToX:function(e,t){var i,a,n=this._collapseCalendar;n&&this._lastDate&&this._lastDate<e?(i=this._lastDate,a=this._lastDuration):(i=this._actualStart,a=0);var r=this._timeRangeHasWorkingTime?o.calculateWorkingTime(n,e,i):e>this._actualStart?this._baseTimeUnitInMilliseconds:0;if(null!==r){r+=a;var s=Math.floor(r/[1e3,6e4,36e5,864e5][this._baseTimeUnit]*this._actualBaseTimeUnitWidth+.1);return!1===t&&(s<0?s=0:s>=this._actualTimeAreaWidth&&(s=this._actualTimeAreaWidth-1)),this._lastDate=e,this._lastDuration=r,s}return null},setFittedTimeAreaViewStartAndEnd:function(e,t){this._fittedTimeAreaViewStart=new Date(e),this._fittedTimeAreaViewEnd=new Date(t)},convertXToDate:function(e,t,i){var a=this,r=[1e3,6e4,36e5,864e5],s=a._collapseCalendar,l=o.addWorkingTime(s,a._actualStart,e*r[a._baseTimeUnit]/a._actualBaseTimeUnitWidth);if(i&&null!==l){var c=o.addWorkingTime(s,a._actualStart,(e+1)*r[a._baseTimeUnit]/a._actualBaseTimeUnitWidth);null!==c&&(c=new Date(c.valueOf()-1),l=n.determineBestDateBetween(l,c))}if(null===l)return e>0?a.actualEnd():a._actualStart;if(l.setMilliseconds(0),!1===t){if(l<a._actualStart)return a._actualStart;if(l>a._actualEnd)return a._actualEnd}var d,m="uncalculated";return[a._fittedTimeAreaViewStart,a._fittedTimeAreaViewEnd,a._actualStart,a._actualEnd].every((function(t){return!(t&&l.getTime()<t.getTime()&&("uncalculated"==m&&(m=o.addWorkingTime(s,a._actualStart,(e+1)*r[a._baseTimeUnit]/a._actualBaseTimeUnitWidth)),!m||m.getTime()>t.getTime()))||(d=new Date(t),!1)}))?l:d},hasCollapsedTimeAtX:function(e){if(!this._collapseCalendar)return!1;var t=this.convertXToDate(e,!0),i=this.convertXToDate(e+1,!0);return o.calculateWorkingTime(this._collapseCalendar,i,t)<i-t},start:function(){return 0===arguments.length?this._start:(this._start.getTime()!==arguments[0].getTime()&&(this._start=new Date(arguments[0]),this._anyTimePropertyChanged()),this)},end:function(){return 0===arguments.length?this._end:(this._end.getTime()!==arguments[0].getTime()&&(this._end=new Date(arguments[0]),this._anyTimePropertyChanged()),this)},baseTimeUnit:function(){return 0===arguments.length?this._baseTimeUnit:(this._baseTimeUnit!=arguments[0]&&(this._baseTimeUnitWidth=this._baseTimeUnitWidth/e.exports.timeUnitToSeconds(this._baseTimeUnit)*e.exports.timeUnitToSeconds(arguments[0]),this._baseTimeUnit=arguments[0],this._anyTimePropertyChanged()),this)},baseTimeUnitWidth:function(){return 0===arguments.length?this._baseTimeUnitWidth:(this._baseTimeUnitWidth!==arguments[0]&&(this._baseTimeUnitWidth=arguments[0],this._anyTimePropertyChanged()),this)},setResolution:function(t,i){this.baseTimeUnitWidth(i/e.exports.timeUnitToSeconds(t)*e.exports.timeUnitToSeconds(this._baseTimeUnit))},getResolution:function(t){return this._baseTimeUnitWidth/e.exports.timeUnitToSeconds(this._baseTimeUnit)*e.exports.timeUnitToSeconds(t)},timeAreaViewWidth:function(){if(0===arguments.length)return this._timeAreaViewWidth;if(this._timeAreaViewWidth!==arguments[0]){this._timeAreaViewWidth=arguments[0];var e=this._isCachingEvents;e||(this._isCachingEvents=!0),this._anyTimePropertyChanged();var t=this._actualTimeAreaWidth-this._timeAreaViewWidth;this._timeAreaViewScrollOffset>t&&(this._timeAreaViewScrollOffset=t),this._eventArgsCached||(this._eventArgsCached={sender:this}),e||this.triggerCachedEvents()}return this},synchronizationNeeded:function(e){return this.start().getTime()!==e.start().getTime()||this.end().getTime()!==e.end().getTime()||this.baseTimeUnit()!==e.baseTimeUnit()||this.baseTimeUnitWidth()!==e.baseTimeUnitWidth()||this.collapseCalendar()!==e.collapseCalendar()||this.timeAreaViewScrollOffset()!==e.timeAreaViewScrollOffset()},synchronizeWith:function(e){if(this.synchronizationNeeded(e)){var t=this._isCachingEvents;t||this.cacheEvents(),this.start(e.start()),this.end(e.end()),this.baseTimeUnit(e.baseTimeUnit()),this.baseTimeUnitWidth(e.baseTimeUnitWidth()),this.collapseCalendar(e.collapseCalendar()),this.timeAreaViewScrollOffset(e.timeAreaViewScrollOffset()),t||this.triggerCachedEvents()}},timeAreaViewScrollOffset:function(){if(0===arguments.length)return Math.round(this._timeAreaViewScrollOffset);var e=arguments[0],t=Math.max(0,e),i=this._actualTimeAreaWidth-this._timeAreaViewWidth;if(t>i&&(t=i),this._timeAreaViewScrollOffset!==e&&(this._timeAreaViewScrollOffset=t,this._currentlyVisibleStart=this.convertXToDate(this._timeAreaViewScrollOffset),this._currentlyVisibleEnd=this.convertXToDate(this._timeAreaViewScrollOffset+this._timeAreaViewWidth-1),!arguments[1])){var a={sender:this};this._isCachingEvents?this._eventArgsCached||(this._eventArgsCached=a):this._trigger(a)}return this},rescale:function(e,t){var i=this._isCachingEvents;i||(this._isCachingEvents=!0);var a=this._timeAreaViewScrollOffset,n=this._actualBaseTimeUnitWidth;if(this._baseTimeUnitWidth=t,this._anyTimePropertyChanged(),(t=this._actualBaseTimeUnitWidth)!=n){var r=a*t/n+e*(t/n-1)/this.visualZoomFactor();r<0&&(r=0),this._timeAreaViewScrollOffset=r,this._anyTimePropertyChanged()}i||(this._eventArgsCached&&(this._eventArgsCached.centerCoordinateOnRescaling=a),this.triggerCachedEvents())},actualTimeAreaWidth:function(){return this._actualTimeAreaWidth},actualStart:function(){return this._actualStart},actualEnd:function(){return o.hasWorkingTime(this._collapseCalendar,this._actualEnd,this._actualStart)?this._actualEnd:this._actualStartPlusOneBaseTimeUnit},currentlyVisibleStart:function(){return this._currentlyVisibleStart},currentlyVisibleEnd:function(){return this._currentlyVisibleEnd},isDateVisible:function(e){var t=e.valueOf();return this._actualStart.getTime()<=t&&t<this._actualEnd.getTime()},isDateNotVisible:function(e){var t=e.valueOf();return this._actualStart>t?-1:t>this._actualEnd?1:0},isDateBeforeStart:function(e){return this._actualStart>e.valueOf()},isDateAfterEnd:function(e){return this._actualEnd<e.valueOf()},actualBaseTimeUnitWidth:function(){return this._actualBaseTimeUnitWidth},actualWidthPerSecond:function(){return this._actualBaseTimeUnitWidth/e.exports.timeUnitToSeconds(this._baseTimeUnit)},collapseCalendar:function(){return 0===arguments.length?this._collapseCalendar:((this._collapseCalendar!==arguments[0]||arguments[1])&&(this._collapseCalendar=arguments[0],this._lastDate=null,this._lastDuration=0,this._anyTimePropertyChanged()),this)},addTimeUnit:function(e,t){switch(t){case r.Seconds:return e.setTime(e.getTime()+1e3),e;case r.Minutes:return e.setTime(e.getTime()+6e4),e;case r.Hours:return e.setTime(e.getTime()+36e5),e;case r.Days:return e.setTime(e.getTime()+864e5),e}return new Date(0)},visualZoomFactor:function(){return 0===arguments.length?this._visualZoomFactor:(this._visualZoomFactor!==arguments[0]&&(this._visualZoomFactor=arguments[0]),this)}}),s.timeUnitToSeconds=function(e){switch(e){case r.Seconds:case r.Minutes:case r.Hours:case r.Days:return[1,60,3600,86400][e];default:return 0}},s.TimeUnit=r,e.exports=s},284:function(e,t,i){i(9554),i(2772),i(9600),i(7042),i(7941),i(1539),i(4916),i(9714),i(5306),i(3123),i(4747);var a=i(3755);i(2228);var n=i(7930),r=i(5680),o=i(7920),s=i(9748).TimeUnit,l=".ntimescale",c="ntimescale-ribbon",d="ntimescale-ribbon-cell",m="ntimescale-ribbon-cell-rect",u="ntimescale-ribbon-cell-rect-hover",h="ntimescale-scroll-handle-background",p="ntimescale-scroll-handle-background-hover",_="ntimescale-scroll-handle-content",f="ntimescale-scroll-handle-right",g="ntimescale-up-handle-background",T="ntimescale-up-handle-background-hover",D="pinch",v="pan",y="singletap",w=n.nOSDetector.isIEWebBrowserControl||n.nOSDetector.isIE||n.nOSDetector.isEdge?0:-.5,S=i(7857),b=i(3670),I=i(4741),A=I.RibbonType,E=a.extend({},A),R={};R[E.Seconds]=1,R[E.Seconds5]=5,R[E.Seconds10]=10,R[E.Seconds15]=15,R[E.Seconds30]=30,R[E.Minutes]=60,R[E.Minutes5]=300,R[E.Minutes10]=600,R[E.Minutes15]=900,R[E.Minutes30]=1800,R[E.Minutes30Small]=1800,R[E.Hours]=3600,R[E.Hours2]=7200,R[E.Hours3]=10800,R[E.Hours6]=21600,R[E.Hours12]=43200,R[E.Hours12Small]=43200,R[E.Days]=86400,R[E.Weeks]=604800,R[E.Months]=2592e3,R[E.Quarters]=7776e3,R[E.Years]=31536e3,R[E.RelSeconds]=1,R[E.RelSeconds5]=5,R[E.RelSeconds10]=10,R[E.RelSeconds15]=15,R[E.RelSeconds30]=30,R[E.RelSeconds30Small]=30,R[E.RelMinutes]=60,R[E.RelMinutes5]=300,R[E.RelMinutes10]=600,R[E.RelMinutes15]=900,R[E.RelMinutes30]=1800,R[E.RelMinutes30Small]=1800,R[E.RelHours]=3600,R[E.RelHours2]=7200,R[E.RelHours3]=10800,R[E.RelHours6]=21600,R[E.RelHours12]=43200,R[E.RelDays]=86400,R[E.RelWeeks]=604800,R[E.RelMonths]=2592e3,R[E.RelQuarters]=7776e3,R[E.RelYears]=31536e3,a.widget("netronic.nTimescaleWidget",{options:{locale:null,timeZone:null,formattingByMoment:!1,timescaleElementForInput:null,timeAxis:null,baseTimeUnit:void 0,height:0,smartNavigationEnabled:!0,smartNavigationVersion:1,delayedScrolling:!1,rescalingByMouseWheelEnabled:!0,ribbonsWideningFactor:1,relativeDateModeEnabled:!1,singleRibbonMode:!1,labelRibbonVisible:!1,reversedRibbonOrder:!1},_create:function(){var e=this;this._ribbonTypesByTimescaleType=[],this._ribbonTypesByTimescaleType[E.Seconds]=[A.Days,A.Seconds],this._ribbonTypesByTimescaleType[E.Seconds5]=[A.Days,A.Seconds5],this._ribbonTypesByTimescaleType[E.Seconds10]=[A.Days,A.Seconds10],this._ribbonTypesByTimescaleType[E.Seconds15]=[A.Days,A.Seconds15],this._ribbonTypesByTimescaleType[E.Seconds30]=[A.Days,A.Seconds30],this._ribbonTypesByTimescaleType[E.Minutes]=[A.Days,A.Minutes],this._ribbonTypesByTimescaleType[E.Minutes5]=[A.Days,A.Minutes5],this._ribbonTypesByTimescaleType[E.Minutes10]=[A.Days,A.Minutes10],this._ribbonTypesByTimescaleType[E.Minutes15]=[A.Days,A.Minutes15],this._ribbonTypesByTimescaleType[E.Minutes30]=[A.Days,A.Minutes30],this._ribbonTypesByTimescaleType[E.Minutes30Small]=[A.Days,A.Minutes30Small],this._ribbonTypesByTimescaleType[E.Hours]=[A.Days,A.Hours],this._ribbonTypesByTimescaleType[E.Hours3]=[A.Days,A.Hours3],this._ribbonTypesByTimescaleType[E.Hours2]=[A.Days,A.Hours2],this._ribbonTypesByTimescaleType[E.Hours6]=[A.Days,A.Hours6],this._ribbonTypesByTimescaleType[E.Hours12]=[A.Days,A.Hours12],this._ribbonTypesByTimescaleType[E.Hours12Small]=[A.Days,A.Hours12Small],this._ribbonTypesByTimescaleType[E.Days]=[A.Months,A.Weeks,A.Days],this._ribbonTypesByTimescaleType[E.Weeks]=[A.Months,A.Weeks],this._ribbonTypesByTimescaleType[E.Months]=[A.Years,A.Months],this._ribbonTypesByTimescaleType[E.Quarters]=[A.Years,A.Quarters],this._ribbonTypesByTimescaleType[E.Years]=[A.Years],this._ribbonTypesByTimescaleType[E.RelSeconds]=[A.RelMinutes,A.RelSeconds],this._ribbonTypesByTimescaleType[E.RelSeconds5]=[A.RelMinutes,A.RelSeconds5],this._ribbonTypesByTimescaleType[E.RelSeconds10]=[A.RelMinutes,A.RelSeconds10],this._ribbonTypesByTimescaleType[E.RelSeconds15]=[A.RelMinutes,A.RelSeconds15],this._ribbonTypesByTimescaleType[E.RelSeconds30]=[A.RelMinutes,A.RelSeconds30],this._ribbonTypesByTimescaleType[E.RelSeconds30Small]=[A.RelMinutes5,A.RelSeconds30],this._ribbonTypesByTimescaleType[E.RelMinutes]=[A.RelHours,A.RelMinutes],this._ribbonTypesByTimescaleType[E.RelMinutes5]=[A.RelHours,A.RelMinutes5],this._ribbonTypesByTimescaleType[E.RelMinutes10]=[A.RelHours,A.RelMinutes10],this._ribbonTypesByTimescaleType[E.RelMinutes15]=[A.RelHours,A.RelMinutes15],this._ribbonTypesByTimescaleType[E.RelMinutes30]=[A.RelHours,A.RelMinutes30],this._ribbonTypesByTimescaleType[E.RelMinutes30Small]=[A.RelHours2,A.RelMinutes30],this._ribbonTypesByTimescaleType[E.RelHours]=[A.RelDays,A.RelHours],this._ribbonTypesByTimescaleType[E.RelHours3]=[A.RelDays,A.RelHours3],this._ribbonTypesByTimescaleType[E.RelHours2]=[A.RelDays,A.RelHours2],this._ribbonTypesByTimescaleType[E.RelHours6]=[A.RelDays,A.RelHours6],this._ribbonTypesByTimescaleType[E.RelHours12]=[A.RelDays,A.RelHours12],this._ribbonTypesByTimescaleType[E.RelDays]=[A.RelWeeks,A.RelDays],this._ribbonTypesByTimescaleType[E.RelWeeks]=[A.RelMonths,A.RelWeeks],this._ribbonTypesByTimescaleType[E.RelMonths]=[A.RelQuarters,A.RelMonths],this._ribbonTypesByTimescaleType[E.RelQuarters]=[A.RelYears,A.RelQuarters],this._ribbonTypesByTimescaleType[E.RelYears]=[A.RelYears],this._ribbonTextFormatsByTimescaleType=[],this._ribbonTextFormatsAdapted=!1,this._timescaleD3ForRendering=r.select(this.element[0]),this.element.addClass("ntimescale"),this._currentTimescaleType=void 0,this._mostDetailedTimescaleType=e.options.relativeDateModeEnabled?E.RelSeconds:E.Seconds,this._leastDetailedTimescaleType=e.options.relativeDateModeEnabled?E.RelYears:E.Years,this._ignoreNextScrollEvent=!1,this._pinchStartUnitWidth=1,this._cachedCurrentTimescaleType=void 0,this._cachedTimeAxis=null,this._cachedTimeAxisActualStart=0,this._cachedTimeAxisActualEnd=0,this._cachedTimeAxisBaseTimeUnit=void 0,this._cachedTimeAxisActualBaseTimeUnitWidth=0,this._cachedCollapseCalendar=void 0,this._cachedWidth=0,this._cachedScrollLeft=-1,this._ribbons=[],this._timescaleD3ForRendering.data([this]),this._cachedCellRect=null,this._ignoreClick=!1,this._mouseIsInside=!1,this._mouseAndSmartNavigationEnabled=!0,this._id=n.nSubsequentIDGenerator.generate(),e.options.locale instanceof n.nLocale||(a(window).on("netronic_nLocales_localeChanged"+l+this._id,(function(){e._localeChanged()})),a(window).on("netronic_nDateHelper_timeZoneChanged"+l+this._id,(function(){e._localeChanged()}))),this._pointerEvents=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseenter","mouseleave","click","touchstart","touchmove","touchend","MSPointerDown","MSPointerMove","MSPointerUp","pointerdown","pointermove","pointerup"],this._pointerEvents=this._pointerEvents.join([l,this._id," "].join(""))},_init:function(){"use strict";var e=this;if(this._initRibbonTextFormats(),this._limitMostDetailedTimescaleType(),e.options.timescaleElementForInput){var t=a(e.options.timescaleElementForInput);t.addClass("ntimescale-overlay"),t.bind("mouseenter",(function(t){return e._onMouseEnter(t)})),t.bind("mousemove",(function(t){return e._onMouseMove(t)})),t.bind("mouseleave",(function(t){return e._onMouseLeave(t)})),t.bind("wheel",(function(t){return e._onWheel(t)}));var i=new o.Manager(e.options.timescaleElementForInput);i.add(new o.Pinch({event:D})),i.on("pinchstart",(function(t){e.onPinchStart(t)})),i.on(D,(function(t){e.onPinch(t)})),i.add(new o.Pan({event:v,direction:o.DIRECTION_HORIZONTAL})),i.on("panstart",(function(t){e._onPanStart(t)})),i.on("panmove",(function(t){e._onPan(t)})),i.on("panend",(function(t){e._onPanEnd(t)})),i.add(new o.Tap({event:y})),i.on(y,(function(t){e._onSingleTap(t)}))}e._mouseAndSmartNavigationEnabled=e.options.smartNavigationEnabled&&e.options.rescalingByMouseWheelEnabled,e._localeListenerFunc=function(){e._localeChanged()},e.options.locale instanceof n.nLocale&&e.options.locale.addListener(e._localeListenerFunc),e.options.reversedRibbonOrder&&e._ribbonTypesByTimescaleType.forEach((function(t,i){e._ribbonTypesByTimescaleType[i]=t.reverse()}))},_destroy:function(){a(window).off(l+this._id),this.options.timescaleElementForInput=null,this.options.timeAxis=null,this.options.locale instanceof n.nLocale&&this.options.locale.removeListener(this._localeListenerFunc)},_setOption:function(e,t){var i=this,a=i.options[e];switch(i._super(e,t),e){case"locale":a&&a.removeListener(this._localeListenerFunc),this._super(e,t),t&&t.addListener(this._localeListenerFunc),this._localeChanged();break;case"timeZone":case"formattingByMoment":this._localeChanged();break;case"height":this._cachedTimeAxis=null,this.render();break;case"baseTimeUnit":this._limitMostDetailedTimescaleType();break;case"smartNavigationEnabled":this._mouseAndSmartNavigationEnabled=t&&this.options.rescalingByMouseWheelEnabled,this.render();break;case"singleRibbonMode":case"smartNavigationVersion":case"labelRibbonVisible":this.render();break;case"rescalingByMouseWheelEnabled":this._mouseAndSmartNavigationEnabled=t&&this.options.smartNavigationEnabled;break;case"relativeDateModeEnabled":n.nDateHelper.relativeDateModeEnabled=t,this._mostDetailedTimescaleType=E.RelSeconds,this._leastDetailedTimescaleType=E.RelQuarters,this.render();break;case"reversedRibbonOrder":t!==a&&(i._ribbonTypesByTimescaleType.forEach((function(e,t){i._ribbonTypesByTimescaleType[t]=e.reverse()})),this._localeChanged())}},_localeChanged:function(){"use strict";var e=this;e._ribbonTextFormatsAdapted=!1;var t=function(){e._initRibbonTextFormats(!0)};e.options.locale instanceof n.nLocale?e.options.locale.applyDateFormat(t):t(),e.render(!0)},_initRibbonTextFormats:function(){"use strict";var t=this;t._ribbonTextFormatsByTimescaleType[E.Seconds]=[["D"],["T"]],t._ribbonTextFormatsByTimescaleType[E.Seconds5]=[["D"],["T"]],t._ribbonTextFormatsByTimescaleType[E.Seconds10]=[["D"],["T"]],t._ribbonTextFormatsByTimescaleType[E.Seconds15]=[["D"],["T"]],t._ribbonTextFormatsByTimescaleType[E.Seconds30]=[["D"],["T"]],t._ribbonTextFormatsByTimescaleType[E.Minutes]=[["D"],["t"]],t._ribbonTextFormatsByTimescaleType[E.Minutes5]=[["D"],["t"]],t._ribbonTextFormatsByTimescaleType[E.Minutes10]=[["D"],["t"]],t._ribbonTextFormatsByTimescaleType[E.Minutes15]=[["D"],["t"]],t._ribbonTextFormatsByTimescaleType[E.Minutes30]=[["D"],["t"]],t._ribbonTextFormatsByTimescaleType[E.Minutes30Small]=[["D",[["%B","%b"]]],["t"]],t._ribbonTextFormatsByTimescaleType[E.Hours]=[["D"],["t"]],t._ribbonTextFormatsByTimescaleType[E.Hours2]=[["D"],["t"]],t._ribbonTextFormatsByTimescaleType[E.Hours3]=[["D"],["t"]],t._ribbonTextFormatsByTimescaleType[E.Hours6]=[["D"],["t"]],t._ribbonTextFormatsByTimescaleType[E.Hours12]=[["D",[["%A","%a"],["%B","%b"]]],["t"]],t._ribbonTextFormatsByTimescaleType[E.Hours12Small]=[["D",[["%A,",""],["%A",""],["%B","%b"]]],["t"]],t._ribbonTextFormatsByTimescaleType[E.Days]=[["%B %Y"],["W"],["%d"]],t._ribbonTextFormatsByTimescaleType[E.Weeks]=[["%B %Y"],["W"]],t._ribbonTextFormatsByTimescaleType[E.Months]=[["%Y"],["%b"]],t._ribbonTextFormatsByTimescaleType[E.Quarters]=[["%Y"],["Q"]],t._ribbonTextFormatsByTimescaleType[E.Years]=[["%Y"]],t._ribbonTextFormatsByTimescaleType[E.RelSeconds]=[["M : d : h : m"],["s"]],t._ribbonTextFormatsByTimescaleType[E.RelSeconds5]=[["M : d : h : m"],["s"]],t._ribbonTextFormatsByTimescaleType[E.RelSeconds10]=[["M : d : h : m"],["s"]],t._ribbonTextFormatsByTimescaleType[E.RelSeconds15]=[["M : d : h : m"],["s"]],t._ribbonTextFormatsByTimescaleType[E.RelSeconds30]=[["M : d : h : m"],["s"]],t._ribbonTextFormatsByTimescaleType[E.RelSeconds30Small]=[["M : d : h : m"],["s"]],t._ribbonTextFormatsByTimescaleType[E.RelMinutes]=[["M : d : h : m"],["m"]],t._ribbonTextFormatsByTimescaleType[E.RelMinutes5]=[["M : d : h : m"],["m"]],t._ribbonTextFormatsByTimescaleType[E.RelMinutes10]=[["M : d : h : m"],["m"]],t._ribbonTextFormatsByTimescaleType[E.RelMinutes15]=[["M : d : h : m"],["m"]],t._ribbonTextFormatsByTimescaleType[E.RelMinutes30]=[["M : d : h : m"],["m"]],t._ribbonTextFormatsByTimescaleType[E.RelMinutes30Small]=[["M : d : h : m"],["m"]],t._ribbonTextFormatsByTimescaleType[E.RelHours]=[["M : d : h : m"],["h"]],t._ribbonTextFormatsByTimescaleType[E.RelHours2]=[["M : d : h : m"],["h"]],t._ribbonTextFormatsByTimescaleType[E.RelHours3]=[["M : d : h : m"],["h"]],t._ribbonTextFormatsByTimescaleType[E.RelHours6]=[["M : d : h : m"],["h"]],t._ribbonTextFormatsByTimescaleType[E.RelHours12]=[["M : d : h : m"],["h"]],t._ribbonTextFormatsByTimescaleType[E.RelDays]=[["M : d : h : m"],["d"]],t._ribbonTextFormatsByTimescaleType[E.RelWeeks]=[["M : d : h : m"],["d"]],t._ribbonTextFormatsByTimescaleType[E.RelMonths]=[["M : d : h : m"],["M"]],t._ribbonTextFormatsByTimescaleType[E.RelQuarters]=[["M : d : h : m"],["Q"]],t._ribbonTextFormatsByTimescaleType[E.RelYears]=[["M : d : h : m"],["Y"]],t.options.reversedRibbonOrder&&t._ribbonTextFormatsByTimescaleType.forEach((function(e,i){t._ribbonTextFormatsByTimescaleType[i]=e.reverse()}));var i=t.options.locale?t.options.locale.params():n.nLocales.locale();t._ribbonTextFormatsAdapted||(t._ribbonTextFormatsAdapted=!0,Object.keys(t._ribbonTextFormatsByTimescaleType).forEach((function(e){for(var a=0;a<t._ribbonTextFormatsByTimescaleType[e].length;a++){var n=t._ribbonTextFormatsByTimescaleType[e][a],r=n[0];-1!==r.indexOf("t")?r=r.replace("t",i.patterns.t):-1!==r.indexOf("T")?r=r.replace("T",i.patterns.T):-1!==r.indexOf("W")?r=r.replace("W",i.patterns.W):-1!==r.indexOf("D")?r=r.replace("D",i.patterns.D):-1!==r.indexOf("Q")&&(r=r.replace("Q",i.patterns.Q)),r=r.replace("'den '","%A' den '");for(var o=1;o<n.length;o++)for(var s=0;s<n[o].length;s++)r=r.replace(n[o][s][0],n[o][s][1]);t._ribbonTextFormatsByTimescaleType[e][a]=r}})));var a=e.exports.prototype._minimumUnitWidths={},r=t.options.reversedRibbonOrder?0:1;-1===t._ribbonTextFormatsByTimescaleType[E.Seconds][r].indexOf("%p")?a[E.Seconds]=64:a[E.Seconds]=70,-1===t._ribbonTextFormatsByTimescaleType[E.Seconds5][r].indexOf("%p")?a[E.Seconds5]=64:a[E.Seconds5]=70,-1===t._ribbonTextFormatsByTimescaleType[E.Seconds10][r].indexOf("%p")?a[E.Seconds10]=64:a[E.Seconds10]=70,-1===t._ribbonTextFormatsByTimescaleType[E.Seconds15][r].indexOf("%p")?a[E.Seconds15]=64:a[E.Seconds15]=70,-1===t._ribbonTextFormatsByTimescaleType[E.Seconds30][r].indexOf("%p")?a[E.Seconds30]=64:a[E.Seconds30]=70,-1===t._ribbonTextFormatsByTimescaleType[E.Minutes][r].indexOf("%p")?a[E.Minutes]=40:a[E.Minutes]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Minutes5][r].indexOf("%p")?a[E.Minutes5]=40:a[E.Minutes5]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Minutes10][r].indexOf("%p")?a[E.Minutes10]=40:a[E.Minutes10]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Minutes15][r].indexOf("%p")?a[E.Minutes15]=40:a[E.Minutes15]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Minutes30][r].indexOf("%p")?a[E.Minutes30]=40:a[E.Minutes30]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Minutes30Small][r].indexOf("%p")?a[E.Minutes30Small]=40:a[E.Minutes30Small]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Hours][r].indexOf("%p")?a[E.Hours]=40:a[E.Hours]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Hours2][r].indexOf("%p")?a[E.Hours2]=40:a[E.Hours2]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Hours3][r].indexOf("%p")?a[E.Hours3]=40:a[E.Hours3]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Hours6][r].indexOf("%p")?a[E.Hours6]=40:a[E.Hours6]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Hours12][r].indexOf("%p")?a[E.Hours12]=48:a[E.Hours12]=64,-1===t._ribbonTextFormatsByTimescaleType[E.Hours12Small][r].indexOf("%p")?a[E.Hours12Small]=40:a[E.Hours12Small]=56,a[E.Days]=24,a[E.Weeks]=48,a[E.Months]=64,a[E.Quarters]=32,a[E.Years]=100,a[E.RelSeconds]=30,a[E.RelSeconds5]=30,a[E.RelSeconds10]=30,a[E.RelSeconds15]=30,a[E.RelSeconds30]=30,a[E.RelSeconds30Small]=68,a[E.RelMinutes]=30,a[E.RelMinutes5]=30,a[E.RelMinutes10]=30,a[E.RelMinutes15]=30,a[E.RelMinutes30]=53,a[E.RelMinutes30Small]=53,a[E.RelHours]=30,a[E.RelHours2]=30,a[E.RelHours3]=30,a[E.RelHours6]=30,a[E.RelHours12]=53,a[E.RelDays]=30,a[E.RelWeeks]=30,a[E.RelMonths]=39,a[E.RelQuarters]=116,a[E.RelYears]=116},_limitMostDetailedTimescaleType:function(){"use strict";var e=this;if(this.options.timeAxis instanceof b)switch(null!=this.options.baseTimeUnit?this.options.baseTimeUnit:this.options.timeAxis.baseTimeUnit()){case s.Days:this._mostDetailedTimescaleType=e.options.relativeDateModeEnabled?E.RelDays:E.Days;break;case s.Hours:this._mostDetailedTimescaleType=e.options.relativeDateModeEnabled?E.RelHours:E.Hours;break;case s.Minutes:this._mostDetailedTimescaleType=e.options.relativeDateModeEnabled?E.RelMinutes:E.Minutes;break;default:this._mostDetailedTimescaleType=e.options.relativeDateModeEnabled?E.RelSeconds:E.Seconds}},_selectCellRectAt:function(e,t,i){"use strict";var o,s=this;void 0!==s._panStartScrollOffset&&(i=!0);var l=s._timescaleD3ForRendering.selectAll(".ntimescale-up-handle");if(l.size()&&"hidden"!==l.attr("visibility")){var c=(o=l.node().getBoundingClientRect()).width/2,d=e-o.left-c,m=t-o.top;if(Math.sqrt(d*d+m*m)<=c)return r.select(s._cachedCellRect).classed(u,!1),s._cachedCellRect=null,s._timescaleD3ForRendering.select(".ntimescale-up-handle-background").classed(T,!0),s._cachedCellRect}var h=!1;if(s._timescaleD3ForRendering.selectAll(".ntimescale-scroll-handle-version2").each((function(){o=this.getBoundingClientRect(),c=o.height/2,r.select(this).classed(f)?(d=e-o.left,m=t-o.top-c,Math.sqrt(d*d+m*m)<=c&&(r.select(s._cachedCellRect).classed(u,!1),s._cachedCellRect=null,s._timescaleD3ForRendering.select(".ntimescale-scroll-handle-right .ntimescale-scroll-handle-background").classed(p,!0),h=!0)):(d=e-o.left-c,m=t-o.top-c,Math.sqrt(d*d+m*m)<=c&&(r.select(s._cachedCellRect).classed(u,!1),s._cachedCellRect=null,s._timescaleD3ForRendering.select(".ntimescale-scroll-handle-left .ntimescale-scroll-handle-background").classed(p,!0),h=!0))})),h)return s._cachedCellRect;if(s._timescaleD3ForRendering.select(".ntimescale-up-handle-background").classed(T,!1),s._timescaleD3ForRendering.select(".ntimescale-scroll-handle-right .ntimescale-scroll-handle-background").classed(p,!1),s._timescaleD3ForRendering.select(".ntimescale-scroll-handle-left .ntimescale-scroll-handle-background").classed(p,!1),s._cachedCellRect){if(o=s._cachedCellRect.getBoundingClientRect(),!i&&o.left<=e&&e<o.right&&o.top<=t&&t<o.bottom)return s._cachedCellRect;r.select(s._cachedCellRect).classed(u,!1),s._cachedCellRect=null}return i||n.nDateHelper.applyTimeZone(s.options.timeZone,(function(){s._timescaleD3ForRendering.selectAll(".ntimescale-ribbon-cell-rect").each((function(){s._cachedCellRect||s._currentTimescaleType===s._mostDetailedTimescaleType&&0===a(this).closest(".ntimescale-ribbon").data("revIndex")||(o=this.getBoundingClientRect()).left<=e&&e<o.right&&o.top<=t&&t<o.bottom&&(o.width<s.options.timeAxis.timeAreaViewWidth()||s.options.timeAxis.convertDateToX(n.nDateHelper.toDate(this.__data__.originalDateOrMoment))!==s.options.timeAxis.timeAreaViewScrollOffset()||s.options.timeAxis.convertDateToX(n.nDateHelper.toDate(this.__data__.nextDateOrMoment))!==s.options.timeAxis.timeAreaViewScrollOffset()+s.options.timeAxis.timeAreaViewWidth())&&(s._mouseIsInside&&r.select(this).classed(u,!0),s._cachedCellRect=this)}))})),s._cachedCellRect},_refreshRibbons:function(e){"use strict";var t=this,i=t.options.timeAxis;if(e||t._cachedCurrentTimescaleType!==t._currentTimescaleType||t._cachedTimeAxis!=i||t._cachedTimeAxisActualStart!=i.actualStart()||t._cachedTimeAxisActualEnd!=i.actualEnd()||t._cachedTimeAxisBaseTimeUnit!=i.baseTimeUnit()||t._cachedTimeAxisActualBaseTimeUnitWidth!=i.actualBaseTimeUnitWidth()||t._cachedWidth!=i.timeAreaViewWidth()||t._cachedScrollLeft!=i.timeAreaViewScrollOffset()||t._cachedCollapseCalendar!=i.collapseCalendar()){t._fillCache();var a=function(){n.nDateHelper.applyTimeZone(t.options.timeZone,(function(){for(var e=0;e<t._ribbons.length;e++)t._ribbons[e].render(i)}))};t.options.locale instanceof n.nLocale?t.options.locale.applyDateFormat(a):a()}},getCurrentTypicalCellWidthOfMostDetailedRibbon:function(){"use strict";var e=this;if(e._ribbons)return n.nDateHelper.applyTimeZone(e.options.timeZone,(function(){var t=e._ribbons[e.options.reversedRibbonOrder?0:e._ribbons.length-1];if(t)return t._getCurrentTypicalCellWidth(e.options.timeAxis)}))},getDatesOfMostDetailedRibbon:function(){"use strict";var e=this;return n.nDateHelper.applyTimeZone(e.options.timeZone,(function(){if(e._ribbons){var t=e._ribbons[e.options.reversedRibbonOrder?0:e._ribbons.length-1];if(t)return t._getDates(e.options.timeAxis)}}))},getCellsOfMostDetailedRibbon:function(){"use strict";var e=this;if(e._ribbons){var t=e._ribbons[e.options.reversedRibbonOrder?0:e._ribbons.length-1];if(t)return t.cells()}},_fillCache:function(){"use strict";var e=this;e._cachedCurrentTimescaleType=e._currentTimescaleType,e._cachedTimeAxis=e.options.timeAxis,e._cachedTimeAxisActualStart=e.options.timeAxis.actualStart(),e._cachedTimeAxisActualEnd=e.options.timeAxis.actualEnd(),e._cachedTimeAxisBaseTimeUnit=e.options.timeAxis.baseTimeUnit(),e._cachedTimeAxisActualBaseTimeUnitWidth=e.options.timeAxis.actualBaseTimeUnitWidth(),e._cachedWidth=e.options.timeAxis.timeAreaViewWidth(),e._cachedScrollLeft=e.options.timeAxis.timeAreaViewScrollOffset(),e._cachedCollapseCalendar=e.options.timeAxis.collapseCalendar()},_renderRibbons:function(e){"use strict";for(var t=this,i=t._leastDetailedTimescaleType,a=t.options.timeAxis.actualWidthPerSecond(),r=t._leastDetailedTimescaleType;r>=t._mostDetailedTimescaleType;r--){if(!(a*R[r.toString()]>=t._minimumUnitWidths[r.toString()]*t.options.ribbonsWideningFactor))break;i=r}i!==t._currentTimescaleType||e?n.nDateHelper.applyTimeZone(t.options.timeZone,(function(){t._currentTimescaleType=i;var e=t._ribbonTypesByTimescaleType[t._currentTimescaleType].slice(),a=t._ribbonTextFormatsByTimescaleType[t._currentTimescaleType].slice();t.options.singleRibbonMode&&(e=[e.pop()],a=[a.pop()]);var r=function(){t._ribbons.length=0;for(var i=0;i<e.length;i++)t._ribbons[i]=new I(t.options.timeAxis,e[i],a[i])};t.options.locale instanceof n.nLocale?t.options.locale.applyDateFormat(r):r(),t._fillCache()})):t._refreshRibbons(e)},_onMouseEnter:function(e){"use strict";this._mouseAndSmartNavigationEnabled&&(this._mouseIsInside=!0,this.options.smartNavigationVersion<2&&this._timescaleD3ForRendering.selectAll(".ntimescale-scroll-handle").transition().attr("transform","translate("+this.options.timeAxis.timeAreaViewWidth()+")"),this._selectCellRectAt(e.clientX,e.clientY,!!e.buttons))},_onMouseMove:function(e){"use strict";var t=this;if(t._mouseAndSmartNavigationEnabled){if(clearTimeout(this._smartNavigationTimer),e.buttons)return;this._ignoreClick=!1,t.options.smartNavigationVersion<2&&this._timescaleD3ForRendering.selectAll(".ntimescale-scroll-handle").transition().attr("transform","translate("+this.options.timeAxis.timeAreaViewWidth()+")"),this._smartNavigationTimer=setTimeout((function(){t._selectCellRectAt(e.clientX,e.clientY,!!e.buttons)}),50)}},_onMouseLeave:function(){"use strict";this._mouseAndSmartNavigationEnabled&&(this._mouseIsInside=!1,clearTimeout(this._smartNavigationTimer),this.options.smartNavigationVersion<2&&this._timescaleD3ForRendering.selectAll(".ntimescale-scroll-handle").transition().attr("transform","translate("+(this.options.timeAxis.timeAreaViewWidth()+11+3)+")"),this._cachedCellRect&&(r.select(this._cachedCellRect).classed(u,!1),this._cachedCellRect=null),this._timescaleD3ForRendering.select(".ntimescale-up-handle-background").classed(T,!1),this._timescaleD3ForRendering.select(".ntimescale-scroll-handle-right .ntimescale-scroll-handle-background").classed(p,!1),this._timescaleD3ForRendering.select(".ntimescale-scroll-handle-left .ntimescale-scroll-handle-background").classed(p,!1))},_onWheel:function(e){"use strict";if(!e.ctrlKey&&!e.altKey&&!e.metaKey)if(e.preventDefault(),e.shiftKey);else if(this.options.rescalingByMouseWheelEnabled){var t=this.options.timeAxis.actualBaseTimeUnitWidth(),i=(e.originalEvent.deltaX||e.originalEvent.deltaY)<0?1.25*t:.8*t;return this._rescale(e.pageX,i),!1}},_rescale:function(t,i){"use strict";var a=this;t-=a.options.timescaleElementForInput.getBoundingClientRect().left+document.body.scrollLeft,a.options.delayedScrolling&&a.options.timeAxis.cacheEvents();var r=e.exports.prototype._minimumUnitWidths[a._mostDetailedTimescaleType]*this.options.ribbonsWideningFactor;null!=this.options.baseTimeUnit&&this.options.baseTimeUnit!==this.options.timeAxis.baseTimeUnit()&&(r*=b.timeUnitToSeconds(this.options.timeAxis.baseTimeUnit())/b.timeUnitToSeconds(this.options.baseTimeUnit)),(i=Math.min(i,r))>a.options.timeAxis.actualBaseTimeUnitWidth()&&1==this._ribbons[a.options.reversedRibbonOrder?0:this._ribbons.length-1]._cells.length||(a.options.timeAxis.rescale(t,i),a.render(),void 0!==a._timeAxisTriggerEventTimerID&&clearTimeout(a._timeAxisTriggerEventTimerID),a.options.delayedScrolling?a._timeAxisTriggerEventTimerID=setTimeout((function(){delete a._timeAxisTriggerEventTimerID,a.options.timeAxis.triggerCachedEvents()}),n.nOSDetector.isIE||n.nOSDetector.isFirefox?300:200):delete a._timeAxisTriggerEventTimerID)},onPinchStart:function(){this._pinchStartUnitWidth=this.options.timeAxis.actualBaseTimeUnitWidth()},onPinch:function(e){var t=this._pinchStartUnitWidth*e.scale;this._rescale(e.center.x,t)},_onPanStart:function(){r.select(this.options.timescaleElementForInput).style("pointer-events","all"),n.nCursorHelper.setCursor(this.options.timescaleElementForInput,"ew-grabbing"),this._panStartScrollOffset=this.options.timeAxis.timeAreaViewScrollOffset()},_onPan:function(e){this.options.timeAxis.timeAreaViewScrollOffset(this._panStartScrollOffset-e.deltaX/this.options.timeAxis.visualZoomFactor())},_onPanEnd:function(e){r.select(this.options.timescaleElementForInput).style("pointer-events",null),n.nCursorHelper.setCursor(this.options.timescaleElementForInput,null),delete this._panStartScrollOffset;var t=a.extend({},e.srcEvent);t.buttons=0,this._onMouseMove(t)},_onSingleTap:function(e){"use strict";if(this._mouseAndSmartNavigationEnabled){if(this._ignoreClick)return void(this._ignoreClick=!1);var t=this;n.nDateHelper.applyTimeZone(t.options.timeZone,(function(){var i=t._selectCellRectAt(e.center.x,e.center.y);t._cachedCellRect=null;var o=a(e.target).css("display");a(e.target).css("display","none");var s=document.elementFromPoint(e.srcEvent.clientX,e.srcEvent.clientY);if(a(e.target).css("display",o||""),s&&a(s).closest('[class~="ntimescale-up-handle"]').length){var l=t.options.timeAxis.actualBaseTimeUnitWidth(),c=.5*l,d=t.options.timescaleElementForInput.getBoundingClientRect();r.select(t).transition().duration(500).tween("Up",(function(){var e=r.interpolate(l,c);return function(i){t._rescale(d.left+document.body.scrollLeft+t.options.timeAxis.timeAreaViewWidth()/2,e(i))}})),setTimeout((function(){t._selectCellRectAt(e.center.x,e.center.y,"touch"===e.pointerType)}),601)}else if(s&&a(s).closest('[class~="ntimescale-scroll-handle-left"]').length){var m=t.options.timeAxis.timeAreaViewScrollOffset();if(t.options.smartNavigationVersion<2){var u=n.nDateHelper.toDate(t._ribbons[t.options.reversedRibbonOrder?t._ribbons.length-1:0]._cells[0].nextDateOrMoment);h=t.options.timeAxis.convertDateToX(u)}else h=m+t.options.timeAxis.timeAreaViewWidth();r.select(t).transition().duration(500).tween("ScrollLeft",(function(){var e=r.interpolateRound(m,h);return function(i){t.options.timeAxis.timeAreaViewScrollOffset(e(i))}}))[r.timeFormat?"on":"each"]("end",(function(){t.options.smartNavigationVersion<2&&t._timescaleD3ForRendering.selectAll(".ntimescale-scroll-handle").attr("transform","translate("+t.options.timeAxis.timeAreaViewWidth()+")")})),setTimeout((function(){t._selectCellRectAt(e.center.x,e.center.y,"touch"===e.pointerType)}),501)}else if(s&&a(s).closest('[class~="ntimescale-scroll-handle-right"]').length){var h;m=t.options.timeAxis.timeAreaViewScrollOffset();if(t.options.smartNavigationVersion<2){u=n.nDateHelper.toDate(t._ribbons[t.options.reversedRibbonOrder?t._ribbons.length-1:0]._cells[0].previousDateOrMoment);h=t.options.timeAxis.convertDateToX(u)}else h=m-t.options.timeAxis.timeAreaViewWidth();r.select(t).transition().duration(500).tween("ScrollRight",(function(){var e=r.interpolateRound(m,h);return function(i){t.options.timeAxis.timeAreaViewScrollOffset(e(i))}}))[r.timeFormat?"on":"each"]("end",(function(){t.options.smartNavigationVersion<2&&t._timescaleD3ForRendering.selectAll(".ntimescale-scroll-handle").attr("transform","translate("+t.options.timeAxis.timeAreaViewWidth()+")")})),setTimeout((function(){t._selectCellRectAt(e.center.x,e.center.y,"touch"===e.pointerType)}),501)}else if(i){var p=t.options.timeAxis.actualBaseTimeUnitWidth(),_=n.nDateHelper.toDate(i.__data__.originalDateOrMoment);_.getTime()<t.options.timeAxis.start().getTime()&&_.setTime(t.options.timeAxis.start().getTime());var f=n.nDateHelper.toDate(i.__data__.nextDateOrMoment);f.getTime()>t.options.timeAxis.end().getTime()&&f.setTime(t.options.timeAxis.end().getTime());var g=S.calculateWorkingTime(t.options.timeAxis.collapseCalendar(),f,_)/1e3*t.options.timeAxis.actualWidthPerSecond(),T=t.options.timeAxis.timeAreaViewWidth()/g*p,D=t.options.timeAxis.convertDateToX(_)-t.options.timeAxis.timeAreaViewScrollOffset(),v=t.options.timeAxis.actualBaseTimeUnitWidth();d=t.options.timescaleElementForInput.getBoundingClientRect();t._rescale(d.left+document.body.scrollLeft,T);var y=t.options.timeAxis.actualBaseTimeUnitWidth();y!==v&&(y!==T?t.options.timeAxis.timeAreaViewScrollOffset(Math.max(0,t.options.timeAxis.convertDateToX(_)-D)):t.options.timeAxis.timeAreaViewScrollOffset(t.options.timeAxis.convertDateToX(_))),setTimeout((function(){t._selectCellRectAt(e.center.x,e.center.y,"touch"===e.pointerType),"touch"!==e.pointerType&&t.options.smartNavigationVersion<2&&t._timescaleD3ForRendering.selectAll(".ntimescale-scroll-handle").transition().attr("transform","translate("+t.options.timeAxis.timeAreaViewWidth()+")")}),200)}}))}},render:function(e){var t=this,i=t.options.timeAxis.timeAreaViewWidth();if(i){var o=t.options.timeAxis.actualTimeAreaWidth(),s=t.options.timeAxis.timeAreaViewScrollOffset(),l=t.options.locale;l instanceof n.nLocale||(l=null);var u=l?l.applyDateFormat:function(e){return e()};t._renderRibbons(e),t._timescaleD3ForRendering.selectAll("g").remove(),t._timescaleD3ForRendering.selectAll("rect").remove();var p=0;t.options.labelRibbonVisible&&(p=10/t._ribbons.length,t._timescaleD3ForRendering.append("rect").attr("width",1e4).attr("height",t.options.height).attr("class",d));var f=t.options.height/t._ribbons.length-p,T=t._timescaleD3ForRendering.selectAll("g").data(t._ribbons).enter().append("g").attr("class",c).attr("transform",(function(e,i){return a(this).data("revIndex",t._ribbons.length-1-i),"translate(0, "+i*f+")"}));if(T.selectAll("g").data((function(e){return e.cells()})).enter().append("g").attr("class",(function(e){var i=r.select(this.parentNode).data()[0],a=e.dateOrMoment;return n.nDateHelper.applyTimeZone(t.options.timeZone,(function(){var e="ntimescale-ribbon-cell ntimescale-ribbon-cell-"+i.getCellClassNameSuffix();if(i.type()<=A.Days){var t=n.nDateHelper.isMoment(a)?a.day():a.getDay();0!=t&&6!=t||(e+=" ntimescale-ribbon-cell-weekend")}return e}))})).each((function(e,a){var o=r.select(this),s=r.select(this.parentNode).data()[0],c=e.x;o.append("rect").attr("class",m).attr("width",e.width).attr("height",f).attr("x",c),e.previousDateSkipped?(o.append("line").attr("class","ntimescale-ribbon-cell-nonworking-outer-tick").attr("x1",c+w).attr("y1",0).attr("x2",c+w).attr("y2",f),o.append("line").attr("class","ntimescale-ribbon-cell-nonworking-inner-tick").attr("x1",c+w).attr("y1",0).attr("x2",c+w).attr("y2",f)):o.append("line").attr("class","ntimescale-ribbon-cell-tick").attr("x1",c+w).attr("y1",t.options.relativeDateModeEnabled?t.options.reversedRibbonOrder?0:f/2+2:0).attr("x2",c+w).attr("y2",t.options.relativeDateModeEnabled&&t.options.reversedRibbonOrder?f/2-2:f);var d=e.width>=i;t.options.relativeDateModeEnabled&&0===a&&!d||o.append("text").attr("x",c).attr("y",t.options.relativeDateModeEnabled?t.options.reversedRibbonOrder?f/2+5:f/2-4:f/2).attr("dy",".3em").attr("dx",t.options.relativeDateModeEnabled?0:5).style("text-anchor",t.options.relativeDateModeEnabled?"middle":"start").text((function(){return n.nDateHelper.applyTimeZone(t.options.timeZone,(function(){var i=n.nDateHelper.isMoment(e.dateOrMoment);if(t.options.relativeDateModeEnabled){var a=n.nDateHelper.dateToRelativeDateTimeString(e.dateOrMoment),o=-1===s.textFormat().indexOf(":"),c="-"===a[0]?"-":" ",d=a.split(":");return s.textFormat().replace("M",d[0]+(o?"M":"")).replace("d",(o?c:"")+d[1]+(o?"d":"")).replace("h",(o?c:"")+d[2]+(o?"h":"")).replace("m",(o?c:"")+d[3]+(o?"m":"")).replace("s",(o?c:"")+d[4]+(o?"s":""))}if(s.type()===A.Quarters){var m=i?e.dateOrMoment.quarter():Math.floor(e.dateOrMoment.getMonth()/3)+1;return s.textFormat()+" "+m}if(s.type()===A.Weeks){var h,p="USA"===(l?l.params():n.nLocales.locale()).weekNumbering,_=n.nDateHelper.toDate(e.dateOrMoment),f=new Date(_.getFullYear(),0);if(p)h=Math.ceil(Math.floor((_.getTime()-6e4*_.getTimezoneOffset()-(f.getTime()-6e4*f.getTimezoneOffset()))/864e5+.001+f.getDay()+1)/7);else{var g=Math.floor((_.getTime()-6e4*_.getTimezoneOffset()-(f.getTime()-6e4*f.getTimezoneOffset()))/864e5+.001),T=(f.getDay()||7)-1,D=u.call(l,(function(){return n.nDateHelper.toDate(s.addTimeUnit(s.normalizeDateOrMoment(new Date(f))))}));if(h=Math.floor((g+1-D.getDate())/7+1),T<=3)h++;else if(0===h)switch(f.getDay()){case 5:h=53;break;case 6:h=52,29===new Date(_.getFullYear()-1,2,0).getDate()&&h++;break;default:h=52}}var v=r.format("02d")(h),y=s.textFormat().replace("%W",v).replace("%U",v);return u.call(l,(function(){return(r.timeFormat?r.timeFormat:r.time.format)(y)(_)}))}return i&&t.options.formattingByMoment?u.call(l,(function(){return e.dateOrMoment.format(s.textFormatForMomentJS())})):u.call(l,(function(){return s.textFormatForD3()(n.nDateHelper.toDisplayDate(e.dateOrMoment))}))}))}))})),this._mouseAndSmartNavigationEnabled){var D=r.select(r.timeFormat?T.nodes().pop():T[0][T[0].length-1]);if(t.options.smartNavigationVersion<2){var v=D.append("g").attr("class","ntimescale-scroll-handle ntimescale-scroll-handle-left "+n.nEventDispatcher.TAP_EVENT_CLASS_NAME).attr("transform","translate("+(i+11+3)+")");v.append("path").attr("d","M0,1h-4l-7,7v"+(t.options.height/2-16)+"l7,7h4L0,1").attr("transform","translate(0,"+(f-t.options.height)+")"),v.append("path").attr("class",_).attr("d","M0,0 V12 L6,6 L0,0").attr("transform","translate(-8, "+(f-3*t.options.height/4-6)+")")}else{var y=14,S=-f*(t._ribbons.length-1)+y;(v=D.append("g").attr("class","ntimescale-scroll-handle ntimescale-scroll-handle-version2 ntimescale-scroll-handle-left "+n.nEventDispatcher.TAP_EVENT_CLASS_NAME).attr("transform","translate("+(i-1)+","+(+S+1)+")").attr("visibility",s+1<=o-i?null:"hidden")).append("path").attr("transform","rotate(90)").attr("class",h).attr("d","M-"+y+",0 a1,1 0 0,0 "+2*y+",0"),v.append("path").attr("class","ntimescale-scroll-handle-content ntimescale-scroll-handle-symbol").attr("d","M12.970992,0L21.524992,0 11.658996,12.152008 8.5930022,15.931 8.6660002,16.020996 11.772003,19.846008 21.636,32 13.082,32 4.3889922,21.290009 4.3150023,21.200989 4.2769927,21.247009 0,15.977997 4.2769927,10.708008z").attr("transform","translate(-2, 6) scale(0.4) rotate(180)")}if(t.options.smartNavigationVersion<2)(v=D.append("g").attr("class","ntimescale-scroll-handle ntimescale-scroll-handle-right "+n.nEventDispatcher.TAP_EVENT_CLASS_NAME).attr("transform","translate("+(i+11+3)+")")).append("path").attr("d","M0,1h-4l-7,7v"+(t.options.height/2-16)+"l7,7h4L0,1").attr("transform","translate(0,"+(f-t.options.height/2)+")"),v.append("path").attr("class",_).attr("d","M0,6L6,12 V0 L0,6").attr("transform","translate(-9, "+(f-t.options.height/4-6)+")");else{y=14,S=-f*(t._ribbons.length-1)+y;(v=D.append("g").attr("class","ntimescale-scroll-handle ntimescale-scroll-handle-version2 ntimescale-scroll-handle-right "+n.nEventDispatcher.TAP_EVENT_CLASS_NAME).attr("transform","translate(1,"+(+S+1)+")").attr("visibility",s<1?"hidden":null)).append("path").attr("transform","rotate(-90)").attr("class",h).attr("d","M-"+y+",0 a1,1 0 0,0 "+2*y+",0"),v.append("path").attr("class","ntimescale-scroll-handle-content ntimescale-scroll-handle-symbol").attr("d","M12.970992,0L21.524992,0 11.658996,12.152008 8.5930022,15.931 8.6660002,16.020996 11.772003,19.846008 21.636,32 13.082,32 4.3889922,21.290009 4.3150023,21.200989 4.2769927,21.247009 0,15.977997 4.2769927,10.708008z").attr("transform","translate(2, -6) scale(0.4)")}if(t.options.smartNavigationVersion>1){var b=r.select(r.timeFormat?T.nodes()[0]:T[0][0]).append("g").attr("transform","translate("+i/2+")").attr("class","ntimescale-up-handle "+n.nEventDispatcher.TAP_EVENT_CLASS_NAME).attr("visibility",s+1<=o-i||s>=1?null:"hidden");y=18;b.append("path").attr("transform","translate(0, 1)").attr("class",g).attr("d","M-"+y+",0 a1,1 0 0,0 "+2*y+",0"),b.append("path").attr("class","ntimescale-up-handle-symbol").attr("d","M16.261993,0L16.359985,0.065002445 16.454987,0 16.48999,0.15399169 32,11.294986 32,19.745 16.359985,8.5149861 0,19.745 0,11.294986 16.22699,0.15399169z").attr("transform","translate(-8, 3) scale(0.5)")}this._mouseIsInside&&t.options.smartNavigationVersion<2&&this._timescaleD3ForRendering.selectAll(".ntimescale-scroll-handle").attr("transform","translate("+this.options.timeAxis.timeAreaViewWidth()+")")}}return this}});var x=a.netronic.nTimescaleWidget;x.RibbonType=A,x.TimescaleType=E,e.exports=x},4741:function(e,t,i){var a=i(3755),n=i(5680),r=i(7930),o=i(7857),s={Seconds:0,Seconds5:1,Seconds10:2,Seconds15:3,Seconds30:4,Minutes:5,Minutes5:6,Minutes10:7,Minutes15:8,Minutes30:9,Minutes30Small:10,Hours:11,Hours2:12,Hours3:13,Hours6:14,Hours12:15,Hours12Small:16,Days:17,Weeks:18,Months:19,Quarters:20,Years:21,RelSeconds:22,RelSeconds5:23,RelSeconds10:24,RelSeconds15:25,RelSeconds30:26,RelSeconds30Small:27,RelMinutes:28,RelMinutes5:29,RelMinutes10:30,RelMinutes15:31,RelMinutes30:32,RelMinutes30Small:33,RelHours:34,RelHours2:35,RelHours3:36,RelHours6:37,RelHours12:38,RelDays:39,RelWeeks:40,RelMonths:41,RelQuarters:42,RelYears:43},l=function(e,t,i){"use strict";this._cells=[],this._type=t,this._relativeDateModeEnabled=t>=22&&t<=43,this._textFormat=i,r.nDateHelper.isMomentJSCurrentlyUsed?(this._textFormatForMomentJS=r.nDateHelper.d3TimeFormatToMomentFormat(i),this._textFormatForD3=(n.timeFormat?n.utcFormat:n.time.format.utc)(i)):this._textFormatForD3=(n.timeFormat?n.timeFormat:n.time.format)(i),this.render(e)},c={};c[s.Seconds]={cellClassNameSuffix:"second",modulus:1,unit:"s"},c[s.Seconds5]={cellClassNameSuffix:"second5",modulus:5,unit:"s"},c[s.Seconds10]={cellClassNameSuffix:"second10",modulus:10,unit:"s"},c[s.Seconds15]={cellClassNameSuffix:"second15",modulus:15,unit:"s"},c[s.Seconds30]={cellClassNameSuffix:"second30",modulus:30,unit:"s"},c[s.Minutes]={cellClassNameSuffix:"minute",modulus:1,unit:"m"},c[s.Minutes5]={cellClassNameSuffix:"minute5",modulus:5,unit:"m"},c[s.Minutes10]={cellClassNameSuffix:"minute10",modulus:10,unit:"m"},c[s.Minutes15]={cellClassNameSuffix:"minute15",modulus:15,unit:"m"},c[s.Minutes30]={cellClassNameSuffix:"minute30",modulus:30,unit:"m"},c[s.Minutes30Small]={cellClassNameSuffix:"minute30small",modulus:30,unit:"m"},c[s.Hours]={cellClassNameSuffix:"hour",modulus:1,unit:"h"},c[s.Hours2]={cellClassNameSuffix:"hour2",modulus:2,unit:"h"},c[s.Hours3]={cellClassNameSuffix:"hour3",modulus:3,unit:"h"},c[s.Hours6]={cellClassNameSuffix:"hour6",modulus:6,unit:"h"},c[s.Hours12]={cellClassNameSuffix:"hour12",modulus:12,unit:"h"},c[s.Hours12Small]={cellClassNameSuffix:"hour12small",modulus:12,unit:"h"},c[s.Days]={cellClassNameSuffix:"day",modulus:1,unit:"d"},c[s.Weeks]={cellClassNameSuffix:"week",modulus:1,unit:"w"},c[s.Months]={cellClassNameSuffix:"month",modulus:1,unit:"M"},c[s.Quarters]={cellClassNameSuffix:"quarter",modulus:1,unit:"Q"},c[s.Years]={cellClassNameSuffix:"year",modulus:1,unit:"y"},c[s.RelSeconds]={cellClassNameSuffix:"second",modulus:1,unit:"s"},c[s.RelSeconds5]={cellClassNameSuffix:"second5",modulus:5,unit:"s"},c[s.RelSeconds10]={cellClassNameSuffix:"second10",modulus:10,unit:"s"},c[s.RelSeconds15]={cellClassNameSuffix:"second15",modulus:15,unit:"s"},c[s.RelSeconds30]={cellClassNameSuffix:"second30",modulus:30,unit:"s"},c[s.RelMinutes]={cellClassNameSuffix:"minute",modulus:1,unit:"m"},c[s.RelMinutes5]={cellClassNameSuffix:"minute5",modulus:5,unit:"m"},c[s.RelMinutes10]={cellClassNameSuffix:"minute10",modulus:10,unit:"m"},c[s.RelMinutes15]={cellClassNameSuffix:"minute15",modulus:15,unit:"m"},c[s.RelMinutes30]={cellClassNameSuffix:"minute30",modulus:30,unit:"m"},c[s.RelHours]={cellClassNameSuffix:"hour",modulus:1,unit:"h"},c[s.RelHours2]={cellClassNameSuffix:"hour2",modulus:2,unit:"h"},c[s.RelHours3]={cellClassNameSuffix:"hour3",modulus:3,unit:"h"},c[s.RelHours6]={cellClassNameSuffix:"hour6",modulus:6,unit:"h"},c[s.RelHours12]={cellClassNameSuffix:"hour12",modulus:12,unit:"h"},c[s.RelDays]={cellClassNameSuffix:"day",modulus:1,unit:"d"},c[s.RelWeeks]={cellClassNameSuffix:"week",modulus:5,unit:"d"},c[s.RelMonths]={cellClassNameSuffix:"month",modulus:30,unit:"d"},c[s.RelQuarters]={cellClassNameSuffix:"quarter",modulus:90,unit:"d"},c[s.RelYears]={cellClassNameSuffix:"year",modulus:270,unit:"d"},a.extend(l.prototype,{normalizeDateOrMoment:function(e){"use strict";var t=c[this._type];return r.nDateHelper.normalizeDateOrMoment(e,t.unit,t.modulus,this._relativeDateModeEnabled)},_roundDateOrMoment:function(e){"use strict";var t=c[this._type];return r.nDateHelper.roundDateOrMoment(e,t.unit,this._relativeDateModeEnabled)},addTimeUnit:function(e){"use strict";var t=c[this._type];return r.nDateHelper.addToDateOrMoment(e,t.unit,t.modulus,this._relativeDateModeEnabled)},render:function(e){"use strict";var t,i,a=this,n=Math.max(e.timeAreaViewScrollOffset(),0),l=0,d=e.timeAreaViewWidth()-1,m=r.nDateHelper.dateToMomentIfNecessary(e.convertXToDate(n)),u=r.nDateHelper.createDateOrMoment(m),h=r.nDateHelper.dateToMomentIfNecessary(e.convertXToDate(n+d)),p=r.nDateHelper.dateToMomentIfNecessary(e.convertXToDate(Math.max(0,n-1)));p=a._roundDateOrMoment(p),m=a.normalizeDateOrMoment(m),a._cells=[];for(var _=!0,f=!1,g=!1;m.valueOf()<=h.valueOf();){var T=a.addTimeUnit(m);T=a.normalizeDateOrMoment(T);var D=!1;if(a._type===s.Weeks&&"USA"===r.nLocales.locale().weekNumbering){var v=r.nDateHelper.isMomentJSCurrentlyUsed?m.year():m.getFullYear();(r.nDateHelper.isMomentJSCurrentlyUsed?T.year():T.getFullYear())>v&&(T=r.nDateHelper.roundDateOrMoment(T,"y"),D=!0)}if((t=e.convertDateToX(r.nDateHelper.toDate(T))-n)>d&&(t=d),i=m,t-l<=0)(_||0===t)&&(u=r.nDateHelper.createDateOrMoment(T)),_=!1,m=T,f=!0;else{_=!1;var y=o.addWorkingTime(e.collapseCalendar(),r.nDateHelper.toDate(m),0),w=y?r.nDateHelper.dateToMomentIfNecessary(y):m;f||(g?(a._type=s.Days,w=a._roundDateOrMoment(w),a._type=s.Weeks):w=a._roundDateOrMoment(w),w.valueOf()!==m.valueOf()&&(f=!0));var S={dateOrMoment:w,x:l,width:Math.max(t-l+1,0),originalDateOrMoment:i,nextDateOrMoment:T,previousDateOrMoment:p,previousDateSkipped:f,ribbonType:a._type,modulus:c[a._type].modulus};a._cells.push(S),p=m,m=T,l=t,f=!1,g=D}}a._cells.length&&(y=o.addWorkingTime(e.collapseCalendar(),r.nDateHelper.toDate(u),0),a._cells[0].dateOrMoment=y?r.nDateHelper.dateToMomentIfNecessary(y):u)},_getCurrentTypicalCellWidth:function(e){"use strict";var t=e.timeAreaViewScrollOffset(),i=this.normalizeDateOrMoment(r.nDateHelper.dateToMomentIfNecessary(e.convertXToDate(t)));return this.addTimeUnit(i).valueOf()-i.valueOf()},_getDates:function(e){"use strict";var t=this,i=e.timeAreaViewScrollOffset(),a=r.nDateHelper.dateToMomentIfNecessary(e.convertXToDate(i));a=t.normalizeDateOrMoment(a);for(var n=e.convertXToDate(i+e.timeAreaViewWidth()),o=[];a.valueOf()<n;)o.push(r.nDateHelper.toDate(a)),a=t.addTimeUnit(a),a=t.normalizeDateOrMoment(a);return o},type:function(){return this._type},textFormat:function(){return this._textFormat},textFormatForMomentJS:function(){return this._textFormatForMomentJS},textFormatForD3:function(){return this._textFormatForD3},cells:function(){"use strict";return this._cells},getCellClassNameSuffix:function(){return c[this._type].cellClassNameSuffix}}),l.RibbonType=s,e.exports=l},189:function(e,t,i){var a=i(3755),n=i(9748),r=n.NGANTT_BAR_RECT_CLASS,o=n.NGANTT_BAR_RECT_CAL_CLASS,s=n.NGANTT_BAR_PATH_CAL_CLASS,l=n.NGANTT_BAR_OUTLINE_CLASS,c=n.BarType,d=n.ElemType,m=n.TimeType,u=i(7857),h=i(5645),p=function(){};a.extend(p.prototype,{createBar:function(e){e.respectingCalendar?(e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+o,{elemType:d.BarRectangle,shape:e.barShapeId})),e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+s,{elemType:d.BarRectangle,shape:e.barShapeId})),h.separateBarShapeOutlinesEnabled&&(e.barD3.selectAll("path."+r).style("stroke-width",0),e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+l,{elemType:d.BarRectangle,shape:e.barShapeId})).style("fill","transparent"))):e.barD3.append("path").attr("class",e.enrichClassFunc(r+" "+s,{elemType:d.BarRectangle,shape:e.barShapeId}))},positionBar:function(e){if(e.barD3){var t=!e.calendar||e.calendar.determineTimeType(e.timeRange.start)===m.WorkingTime,i=e.convertXToLimitedX;if(e.calendar){for(var a="M0,"+e.barHeight,n=a,r=u.calculateWorkingTime(e.calendar,e.timeRange.end,e.timeRange.start),c=e.timeRange.start;null!==(c=e.calendar.findStartOfNextTimeTypeChange(c))&&c.getTime()<e.timeRange.end.getTime();){t=!t;var d=Math.max(i(e.timeAxis.convertDateToX(c))-i(e.timeAxis.convertDateToX(e.timeRange.start))-1,0),p=(1-u.calculateWorkingTime(e.calendar,c,e.timeRange.start)/r)*e.barHeight;a=a+"L"+d+","+p,n=n+"L"+d+","+(t?e.barHeight:p)+"V"+(t?p:e.barHeight)}a+="L"+e.width+",0V"+e.barHeight+"H0",e.barD3.select("."+o).attr("d",a),e.barD3.select("."+s).attr("d",n+"L"+e.width+","+(t?"0":e.barHeight)+"V"+e.barHeight+"H0"),h.separateBarShapeOutlinesEnabled&&e.barD3.select("path."+l).attr("d",a)}else e.barD3.select("."+s).attr("d","M0,"+e.barHeight+"L"+e.width+",0V"+e.barHeight+"H0")}e.worldViewVisible&&(e.worldViewPathData=[{x:0,y:e.barHeight},{x:e.worldViewBarWidth,y:0},{x:e.worldViewBarWidth,y:e.barHeight},{x:0,y:e.barHeight}])},checkForBarType:function(e){return e===c.StartEnd}}),e.exports=p},5579:function(e,t,i){i(9554),i(7941),i(4747);var a=i(9748);if(Object.keys(a).forEach((function(e){t[e]=a[e]})),t.nGanttDebugHelper=i(4505),t.nCalendar=i(6640),t.nCalendarHelper=i(7857),t.nTimeAxis=i(3670),t.nTimescaleWidget=i(284),t.nTimescaleWidgetRibbon=i(4741),t.nLinkRouter=i(2354),t.nBarDragging=i(797),t.nGanttWidget=i(8054),t.nGanttSynchronizerWidget=i(5027),t.nShapeHelper=i(5645),t.nBarFactory=i(2299),t.nArrowBarShape=i(3922),t.nArrowLeftShape=i(7913),t.nArrowRightShape=i(1150),t.nDiamondShape=i(3462),t.nDownwardRampBarShape=i(5618),t.nRectangleBarShape=i(978),t.nRectangleWithLeftTopBevelBarShape=i(474),t.nSummaryBarShape=i(9873),t.nUpwardRampBarShape=i(189),self){var n=self.netronic=self.netronic||{};Object.keys(t).forEach((function(e){n[e]=t[e]}))}},3099:function(e){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},6077:function(e,t,i){var a=i(111);e.exports=function(e){if(!a(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},1223:function(e,t,i){var a=i(5112),n=i(30),r=i(3070),o=a("unscopables"),s=Array.prototype;null==s[o]&&r.f(s,o,{configurable:!0,value:n(null)}),e.exports=function(e){s[o][e]=!0}},1530:function(e,t,i){"use strict";var a=i(8710).charAt;e.exports=function(e,t,i){return t+(i?a(e,t).length:1)}},5787:function(e){e.exports=function(e,t,i){if(!(e instanceof t))throw TypeError("Incorrect "+(i?i+" ":"")+"invocation");return e}},9670:function(e,t,i){var a=i(111);e.exports=function(e){if(!a(e))throw TypeError(String(e)+" is not an object");return e}},1285:function(e,t,i){"use strict";var a=i(7908),n=i(1400),r=i(7466);e.exports=function(e){for(var t=a(this),i=r(t.length),o=arguments.length,s=n(o>1?arguments[1]:void 0,i),l=o>2?arguments[2]:void 0,c=void 0===l?i:n(l,i);c>s;)t[s++]=e;return t}},8533:function(e,t,i){"use strict";var a=i(2092).forEach,n=i(9341)("forEach");e.exports=n?[].forEach:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}},1318:function(e,t,i){var a=i(5656),n=i(7466),r=i(1400),o=function(e){return function(t,i,o){var s,l=a(t),c=n(l.length),d=r(o,c);if(e&&i!=i){for(;c>d;)if((s=l[d++])!=s)return!0}else for(;c>d;d++)if((e||d in l)&&l[d]===i)return e||d||0;return!e&&-1}};e.exports={includes:o(!0),indexOf:o(!1)}},2092:function(e,t,i){var a=i(9974),n=i(8361),r=i(7908),o=i(7466),s=i(5417),l=[].push,c=function(e){var t=1==e,i=2==e,c=3==e,d=4==e,m=6==e,u=7==e,h=5==e||m;return function(p,_,f,g){for(var T,D,v=r(p),y=n(v),w=a(_,f,3),S=o(y.length),b=0,I=g||s,A=t?I(p,S):i||u?I(p,0):void 0;S>b;b++)if((h||b in y)&&(D=w(T=y[b],b,v),e))if(t)A[b]=D;else if(D)switch(e){case 3:return!0;case 5:return T;case 6:return b;case 2:l.call(A,T)}else switch(e){case 4:return!1;case 7:l.call(A,T)}return m?-1:c||d?d:A}};e.exports={forEach:c(0),map:c(1),filter:c(2),some:c(3),every:c(4),find:c(5),findIndex:c(6),filterOut:c(7)}},1194:function(e,t,i){var a=i(7293),n=i(5112),r=i(7392),o=n("species");e.exports=function(e){return r>=51||!a((function(){var t=[];return(t.constructor={})[o]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},9341:function(e,t,i){"use strict";var a=i(7293);e.exports=function(e,t){var i=[][e];return!!i&&a((function(){i.call(null,t||function(){throw 1},1)}))}},3671:function(e,t,i){var a=i(3099),n=i(7908),r=i(8361),o=i(7466),s=function(e){return function(t,i,s,l){a(i);var c=n(t),d=r(c),m=o(c.length),u=e?m-1:0,h=e?-1:1;if(s<2)for(;;){if(u in d){l=d[u],u+=h;break}if(u+=h,e?u<0:m<=u)throw TypeError("Reduce of empty array with no initial value")}for(;e?u>=0:m>u;u+=h)u in d&&(l=i(l,d[u],u,c));return l}};e.exports={left:s(!1),right:s(!0)}},5417:function(e,t,i){var a=i(111),n=i(3157),r=i(5112)("species");e.exports=function(e,t){var i;return n(e)&&("function"!=typeof(i=e.constructor)||i!==Array&&!n(i.prototype)?a(i)&&null===(i=i[r])&&(i=void 0):i=void 0),new(void 0===i?Array:i)(0===t?0:t)}},7072:function(e,t,i){var a=i(5112)("iterator"),n=!1;try{var r=0,o={next:function(){return{done:!!r++}},return:function(){n=!0}};o[a]=function(){return this},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!n)return!1;var i=!1;try{var r={};r[a]=function(){return{next:function(){return{done:i=!0}}}},e(r)}catch(e){}return i}},4326:function(e){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},648:function(e,t,i){var a=i(1694),n=i(4326),r=i(5112)("toStringTag"),o="Arguments"==n(function(){return arguments}());e.exports=a?n:function(e){var t,i,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),r))?i:o?n(t):"Object"==(a=n(t))&&"function"==typeof t.callee?"Arguments":a}},9920:function(e,t,i){var a=i(6656),n=i(3887),r=i(1236),o=i(3070);e.exports=function(e,t){for(var i=n(t),s=o.f,l=r.f,c=0;c<i.length;c++){var d=i[c];a(e,d)||s(e,d,l(t,d))}}},8544:function(e,t,i){var a=i(7293);e.exports=!a((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},4994:function(e,t,i){"use strict";var a=i(3383).IteratorPrototype,n=i(30),r=i(9114),o=i(8003),s=i(7497),l=function(){return this};e.exports=function(e,t,i){var c=t+" Iterator";return e.prototype=n(a,{next:r(1,i)}),o(e,c,!1,!0),s[c]=l,e}},8880:function(e,t,i){var a=i(9781),n=i(3070),r=i(9114);e.exports=a?function(e,t,i){return n.f(e,t,r(1,i))}:function(e,t,i){return e[t]=i,e}},9114:function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},6135:function(e,t,i){"use strict";var a=i(7593),n=i(3070),r=i(9114);e.exports=function(e,t,i){var o=a(t);o in e?n.f(e,o,r(0,i)):e[o]=i}},654:function(e,t,i){"use strict";var a=i(2109),n=i(4994),r=i(9518),o=i(7674),s=i(8003),l=i(8880),c=i(1320),d=i(5112),m=i(1913),u=i(7497),h=i(3383),p=h.IteratorPrototype,_=h.BUGGY_SAFARI_ITERATORS,f=d("iterator"),g="keys",T="values",D="entries",v=function(){return this};e.exports=function(e,t,i,d,h,y,w){n(i,t,d);var S,b,I,A=function(e){if(e===h&&L)return L;if(!_&&e in x)return x[e];switch(e){case g:case T:case D:return function(){return new i(this,e)}}return function(){return new i(this)}},E=t+" Iterator",R=!1,x=e.prototype,C=x[f]||x["@@iterator"]||h&&x[h],L=!_&&C||A(h),B="Array"==t&&x.entries||C;if(B&&(S=r(B.call(new e)),p!==Object.prototype&&S.next&&(m||r(S)===p||(o?o(S,p):"function"!=typeof S[f]&&l(S,f,v)),s(S,E,!0,!0),m&&(u[E]=v))),h==T&&C&&C.name!==T&&(R=!0,L=function(){return C.call(this)}),m&&!w||x[f]===L||l(x,f,L),u[t]=L,h)if(b={values:A(T),keys:y?L:A(g),entries:A(D)},w)for(I in b)(_||R||!(I in x))&&c(x,I,b[I]);else a({target:t,proto:!0,forced:_||R},b);return b}},7235:function(e,t,i){var a=i(857),n=i(6656),r=i(6061),o=i(3070).f;e.exports=function(e){var t=a.Symbol||(a.Symbol={});n(t,e)||o(t,e,{value:r.f(e)})}},9781:function(e,t,i){var a=i(7293);e.exports=!a((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},317:function(e,t,i){var a=i(7854),n=i(111),r=a.document,o=n(r)&&n(r.createElement);e.exports=function(e){return o?r.createElement(e):{}}},8324:function(e){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},7871:function(e){e.exports="object"==typeof window},6833:function(e,t,i){var a=i(8113);e.exports=/(?:iphone|ipod|ipad).*applewebkit/i.test(a)},5268:function(e,t,i){var a=i(4326),n=i(7854);e.exports="process"==a(n.process)},1036:function(e,t,i){var a=i(8113);e.exports=/web0s(?!.*chrome)/i.test(a)},8113:function(e,t,i){var a=i(5005);e.exports=a("navigator","userAgent")||""},7392:function(e,t,i){var a,n,r=i(7854),o=i(8113),s=r.process,l=s&&s.versions,c=l&&l.v8;c?n=(a=c.split("."))[0]<4?1:a[0]+a[1]:o&&(!(a=o.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=o.match(/Chrome\/(\d+)/))&&(n=a[1]),e.exports=n&&+n},748:function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},2109:function(e,t,i){var a=i(7854),n=i(1236).f,r=i(8880),o=i(1320),s=i(3505),l=i(9920),c=i(4705);e.exports=function(e,t){var i,d,m,u,h,p=e.target,_=e.global,f=e.stat;if(i=_?a:f?a[p]||s(p,{}):(a[p]||{}).prototype)for(d in t){if(u=t[d],m=e.noTargetGet?(h=n(i,d))&&h.value:i[d],!c(_?d:p+(f?".":"#")+d,e.forced)&&void 0!==m){if(typeof u==typeof m)continue;l(u,m)}(e.sham||m&&m.sham)&&r(u,"sham",!0),o(i,d,u,e)}}},7293:function(e){e.exports=function(e){try{return!!e()}catch(e){return!0}}},7007:function(e,t,i){"use strict";i(4916);var a=i(1320),n=i(2261),r=i(7293),o=i(5112),s=i(8880),l=o("species"),c=RegExp.prototype;e.exports=function(e,t,i,d){var m=o(e),u=!r((function(){var t={};return t[m]=function(){return 7},7!=""[e](t)})),h=u&&!r((function(){var t=!1,i=/a/;return"split"===e&&((i={}).constructor={},i.constructor[l]=function(){return i},i.flags="",i[m]=/./[m]),i.exec=function(){return t=!0,null},i[m](""),!t}));if(!u||!h||i){var p=/./[m],_=t(m,""[e],(function(e,t,i,a,r){var o=t.exec;return o===n||o===c.exec?u&&!r?{done:!0,value:p.call(t,i,a)}:{done:!0,value:e.call(i,t,a)}:{done:!1}}));a(String.prototype,e,_[0]),a(c,m,_[1])}d&&s(c[m],"sham",!0)}},9974:function(e,t,i){var a=i(3099);e.exports=function(e,t,i){if(a(e),void 0===t)return e;switch(i){case 0:return function(){return e.call(t)};case 1:return function(i){return e.call(t,i)};case 2:return function(i,a){return e.call(t,i,a)};case 3:return function(i,a,n){return e.call(t,i,a,n)}}return function(){return e.apply(t,arguments)}}},5005:function(e,t,i){var a=i(857),n=i(7854),r=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?r(a[e])||r(n[e]):a[e]&&a[e][t]||n[e]&&n[e][t]}},1246:function(e,t,i){var a=i(648),n=i(7497),r=i(5112)("iterator");e.exports=function(e){if(null!=e)return e[r]||e["@@iterator"]||n[a(e)]}},647:function(e,t,i){var a=i(7908),n=Math.floor,r="".replace,o=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,s=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,i,l,c,d){var m=i+e.length,u=l.length,h=s;return void 0!==c&&(c=a(c),h=o),r.call(d,h,(function(a,r){var o;switch(r.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,i);case"'":return t.slice(m);case"<":o=c[r.slice(1,-1)];break;default:var s=+r;if(0===s)return a;if(s>u){var d=n(s/10);return 0===d?a:d<=u?void 0===l[d-1]?r.charAt(1):l[d-1]+r.charAt(1):a}o=l[s-1]}return void 0===o?"":o}))}},7854:function(e,t,i){var a=function(e){return e&&e.Math==Math&&e};e.exports=a("object"==typeof globalThis&&globalThis)||a("object"==typeof window&&window)||a("object"==typeof self&&self)||a("object"==typeof i.g&&i.g)||function(){return this}()||Function("return this")()},6656:function(e,t,i){var a=i(7908),n={}.hasOwnProperty;e.exports=Object.hasOwn||function(e,t){return n.call(a(e),t)}},3501:function(e){e.exports={}},842:function(e,t,i){var a=i(7854);e.exports=function(e,t){var i=a.console;i&&i.error&&(1===arguments.length?i.error(e):i.error(e,t))}},490:function(e,t,i){var a=i(5005);e.exports=a("document","documentElement")},4664:function(e,t,i){var a=i(9781),n=i(7293),r=i(317);e.exports=!a&&!n((function(){return 7!=Object.defineProperty(r("div"),"a",{get:function(){return 7}}).a}))},8361:function(e,t,i){var a=i(7293),n=i(4326),r="".split;e.exports=a((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==n(e)?r.call(e,""):Object(e)}:Object},9587:function(e,t,i){var a=i(111),n=i(7674);e.exports=function(e,t,i){var r,o;return n&&"function"==typeof(r=t.constructor)&&r!==i&&a(o=r.prototype)&&o!==i.prototype&&n(e,o),e}},2788:function(e,t,i){var a=i(5465),n=Function.toString;"function"!=typeof a.inspectSource&&(a.inspectSource=function(e){return n.call(e)}),e.exports=a.inspectSource},9909:function(e,t,i){var a,n,r,o=i(8536),s=i(7854),l=i(111),c=i(8880),d=i(6656),m=i(5465),u=i(6200),h=i(3501),p="Object already initialized",_=s.WeakMap;if(o||m.state){var f=m.state||(m.state=new _),g=f.get,T=f.has,D=f.set;a=function(e,t){if(T.call(f,e))throw new TypeError(p);return t.facade=e,D.call(f,e,t),t},n=function(e){return g.call(f,e)||{}},r=function(e){return T.call(f,e)}}else{var v=u("state");h[v]=!0,a=function(e,t){if(d(e,v))throw new TypeError(p);return t.facade=e,c(e,v,t),t},n=function(e){return d(e,v)?e[v]:{}},r=function(e){return d(e,v)}}e.exports={set:a,get:n,has:r,enforce:function(e){return r(e)?n(e):a(e,{})},getterFor:function(e){return function(t){var i;if(!l(t)||(i=n(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return i}}}},7659:function(e,t,i){var a=i(5112),n=i(7497),r=a("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||o[r]===e)}},3157:function(e,t,i){var a=i(4326);e.exports=Array.isArray||function(e){return"Array"==a(e)}},4705:function(e,t,i){var a=i(7293),n=/#|\.prototype\./,r=function(e,t){var i=s[o(e)];return i==c||i!=l&&("function"==typeof t?a(t):!!t)},o=r.normalize=function(e){return String(e).replace(n,".").toLowerCase()},s=r.data={},l=r.NATIVE="N",c=r.POLYFILL="P";e.exports=r},111:function(e){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},1913:function(e){e.exports=!1},7850:function(e,t,i){var a=i(111),n=i(4326),r=i(5112)("match");e.exports=function(e){var t;return a(e)&&(void 0!==(t=e[r])?!!t:"RegExp"==n(e))}},408:function(e,t,i){var a=i(9670),n=i(7659),r=i(7466),o=i(9974),s=i(1246),l=i(9212),c=function(e,t){this.stopped=e,this.result=t};e.exports=function(e,t,i){var d,m,u,h,p,_,f,g=i&&i.that,T=!(!i||!i.AS_ENTRIES),D=!(!i||!i.IS_ITERATOR),v=!(!i||!i.INTERRUPTED),y=o(t,g,1+T+v),w=function(e){return d&&l(d),new c(!0,e)},S=function(e){return T?(a(e),v?y(e[0],e[1],w):y(e[0],e[1])):v?y(e,w):y(e)};if(D)d=e;else{if("function"!=typeof(m=s(e)))throw TypeError("Target is not iterable");if(n(m)){for(u=0,h=r(e.length);h>u;u++)if((p=S(e[u]))&&p instanceof c)return p;return new c(!1)}d=m.call(e)}for(_=d.next;!(f=_.call(d)).done;){try{p=S(f.value)}catch(e){throw l(d),e}if("object"==typeof p&&p&&p instanceof c)return p}return new c(!1)}},9212:function(e,t,i){var a=i(9670);e.exports=function(e){var t=e.return;if(void 0!==t)return a(t.call(e)).value}},3383:function(e,t,i){"use strict";var a,n,r,o=i(7293),s=i(9518),l=i(8880),c=i(6656),d=i(5112),m=i(1913),u=d("iterator"),h=!1;[].keys&&("next"in(r=[].keys())?(n=s(s(r)))!==Object.prototype&&(a=n):h=!0);var p=null==a||o((function(){var e={};return a[u].call(e)!==e}));p&&(a={}),m&&!p||c(a,u)||l(a,u,(function(){return this})),e.exports={IteratorPrototype:a,BUGGY_SAFARI_ITERATORS:h}},7497:function(e){e.exports={}},4310:function(e){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},5948:function(e,t,i){var a,n,r,o,s,l,c,d,m=i(7854),u=i(1236).f,h=i(261).set,p=i(6833),_=i(1036),f=i(5268),g=m.MutationObserver||m.WebKitMutationObserver,T=m.document,D=m.process,v=m.Promise,y=u(m,"queueMicrotask"),w=y&&y.value;w||(a=function(){var e,t;for(f&&(e=D.domain)&&e.exit();n;){t=n.fn,n=n.next;try{t()}catch(e){throw n?o():r=void 0,e}}r=void 0,e&&e.enter()},p||f||_||!g||!T?v&&v.resolve?((c=v.resolve(void 0)).constructor=v,d=c.then,o=function(){d.call(c,a)}):o=f?function(){D.nextTick(a)}:function(){h.call(m,a)}:(s=!0,l=T.createTextNode(""),new g(a).observe(l,{characterData:!0}),o=function(){l.data=s=!s})),e.exports=w||function(e){var t={fn:e,next:void 0};r&&(r.next=t),n||(n=t,o()),r=t}},3366:function(e,t,i){var a=i(7854);e.exports=a.Promise},133:function(e,t,i){var a=i(7392),n=i(7293);e.exports=!!Object.getOwnPropertySymbols&&!n((function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&a&&a<41}))},8536:function(e,t,i){var a=i(7854),n=i(2788),r=a.WeakMap;e.exports="function"==typeof r&&/native code/.test(n(r))},8523:function(e,t,i){"use strict";var a=i(3099),n=function(e){var t,i;this.promise=new e((function(e,a){if(void 0!==t||void 0!==i)throw TypeError("Bad Promise constructor");t=e,i=a})),this.resolve=a(t),this.reject=a(i)};e.exports.f=function(e){return new n(e)}},30:function(e,t,i){var a,n=i(9670),r=i(6048),o=i(748),s=i(3501),l=i(490),c=i(317),d=i(6200),m=d("IE_PROTO"),u=function(){},h=function(e){return"<script>"+e+"</"+"script>"},p=function(){try{a=document.domain&&new ActiveXObject("htmlfile")}catch(e){}var e,t;p=a?function(e){e.write(h("")),e.close();var t=e.parentWindow.Object;return e=null,t}(a):((t=c("iframe")).style.display="none",l.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write(h("document.F=Object")),e.close(),e.F);for(var i=o.length;i--;)delete p.prototype[o[i]];return p()};s[m]=!0,e.exports=Object.create||function(e,t){var i;return null!==e?(u.prototype=n(e),i=new u,u.prototype=null,i[m]=e):i=p(),void 0===t?i:r(i,t)}},6048:function(e,t,i){var a=i(9781),n=i(3070),r=i(9670),o=i(1956);e.exports=a?Object.defineProperties:function(e,t){r(e);for(var i,a=o(t),s=a.length,l=0;s>l;)n.f(e,i=a[l++],t[i]);return e}},3070:function(e,t,i){var a=i(9781),n=i(4664),r=i(9670),o=i(7593),s=Object.defineProperty;t.f=a?s:function(e,t,i){if(r(e),t=o(t,!0),r(i),n)try{return s(e,t,i)}catch(e){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(e[t]=i.value),e}},1236:function(e,t,i){var a=i(9781),n=i(5296),r=i(9114),o=i(5656),s=i(7593),l=i(6656),c=i(4664),d=Object.getOwnPropertyDescriptor;t.f=a?d:function(e,t){if(e=o(e),t=s(t,!0),c)try{return d(e,t)}catch(e){}if(l(e,t))return r(!n.f.call(e,t),e[t])}},1156:function(e,t,i){var a=i(5656),n=i(8006).f,r={}.toString,o="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return o&&"[object Window]"==r.call(e)?function(e){try{return n(e)}catch(e){return o.slice()}}(e):n(a(e))}},8006:function(e,t,i){var a=i(6324),n=i(748).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return a(e,n)}},5181:function(e,t){t.f=Object.getOwnPropertySymbols},9518:function(e,t,i){var a=i(6656),n=i(7908),r=i(6200),o=i(8544),s=r("IE_PROTO"),l=Object.prototype;e.exports=o?Object.getPrototypeOf:function(e){return e=n(e),a(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?l:null}},6324:function(e,t,i){var a=i(6656),n=i(5656),r=i(1318).indexOf,o=i(3501);e.exports=function(e,t){var i,s=n(e),l=0,c=[];for(i in s)!a(o,i)&&a(s,i)&&c.push(i);for(;t.length>l;)a(s,i=t[l++])&&(~r(c,i)||c.push(i));return c}},1956:function(e,t,i){var a=i(6324),n=i(748);e.exports=Object.keys||function(e){return a(e,n)}},5296:function(e,t){"use strict";var i={}.propertyIsEnumerable,a=Object.getOwnPropertyDescriptor,n=a&&!i.call({1:2},1);t.f=n?function(e){var t=a(this,e);return!!t&&t.enumerable}:i},7674:function(e,t,i){var a=i(9670),n=i(6077);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),t=i instanceof Array}catch(e){}return function(i,r){return a(i),n(r),t?e.call(i,r):i.__proto__=r,i}}():void 0)},288:function(e,t,i){"use strict";var a=i(1694),n=i(648);e.exports=a?{}.toString:function(){return"[object "+n(this)+"]"}},3887:function(e,t,i){var a=i(5005),n=i(8006),r=i(5181),o=i(9670);e.exports=a("Reflect","ownKeys")||function(e){var t=n.f(o(e)),i=r.f;return i?t.concat(i(e)):t}},857:function(e,t,i){var a=i(7854);e.exports=a},2534:function(e){e.exports=function(e){try{return{error:!1,value:e()}}catch(e){return{error:!0,value:e}}}},9478:function(e,t,i){var a=i(9670),n=i(111),r=i(8523);e.exports=function(e,t){if(a(e),n(t)&&t.constructor===e)return t;var i=r.f(e);return(0,i.resolve)(t),i.promise}},2248:function(e,t,i){var a=i(1320);e.exports=function(e,t,i){for(var n in t)a(e,n,t[n],i);return e}},1320:function(e,t,i){var a=i(7854),n=i(8880),r=i(6656),o=i(3505),s=i(2788),l=i(9909),c=l.get,d=l.enforce,m=String(String).split("String");(e.exports=function(e,t,i,s){var l,c=!!s&&!!s.unsafe,u=!!s&&!!s.enumerable,h=!!s&&!!s.noTargetGet;"function"==typeof i&&("string"!=typeof t||r(i,"name")||n(i,"name",t),(l=d(i)).source||(l.source=m.join("string"==typeof t?t:""))),e!==a?(c?!h&&e[t]&&(u=!0):delete e[t],u?e[t]=i:n(e,t,i)):u?e[t]=i:o(t,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||s(this)}))},7651:function(e,t,i){var a=i(4326),n=i(2261);e.exports=function(e,t){var i=e.exec;if("function"==typeof i){var r=i.call(e,t);if("object"!=typeof r)throw TypeError("RegExp exec method returned something other than an Object or null");return r}if("RegExp"!==a(e))throw TypeError("RegExp#exec called on incompatible receiver");return n.call(e,t)}},2261:function(e,t,i){"use strict";var a,n,r=i(7066),o=i(2999),s=i(2309),l=i(30),c=i(9909).get,d=i(9441),m=i(8173),u=RegExp.prototype.exec,h=s("native-string-replace",String.prototype.replace),p=u,_=(a=/a/,n=/b*/g,u.call(a,"a"),u.call(n,"a"),0!==a.lastIndex||0!==n.lastIndex),f=o.UNSUPPORTED_Y||o.BROKEN_CARET,g=void 0!==/()??/.exec("")[1];(_||g||f||d||m)&&(p=function(e){var t,i,a,n,o,s,d,m=this,T=c(m),D=T.raw;if(D)return D.lastIndex=m.lastIndex,t=p.call(D,e),m.lastIndex=D.lastIndex,t;var v=T.groups,y=f&&m.sticky,w=r.call(m),S=m.source,b=0,I=e;if(y&&(-1===(w=w.replace("y","")).indexOf("g")&&(w+="g"),I=String(e).slice(m.lastIndex),m.lastIndex>0&&(!m.multiline||m.multiline&&"\n"!==e[m.lastIndex-1])&&(S="(?: "+S+")",I=" "+I,b++),i=new RegExp("^(?:"+S+")",w)),g&&(i=new RegExp("^"+S+"$(?!\\s)",w)),_&&(a=m.lastIndex),n=u.call(y?i:m,I),y?n?(n.input=n.input.slice(b),n[0]=n[0].slice(b),n.index=m.lastIndex,m.lastIndex+=n[0].length):m.lastIndex=0:_&&n&&(m.lastIndex=m.global?n.index+n[0].length:a),g&&n&&n.length>1&&h.call(n[0],i,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(n[o]=void 0)})),n&&v)for(n.groups=s=l(null),o=0;o<v.length;o++)s[(d=v[o])[0]]=n[d[1]];return n}),e.exports=p},7066:function(e,t,i){"use strict";var a=i(9670);e.exports=function(){var e=a(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},2999:function(e,t,i){var a=i(7293),n=function(e,t){return RegExp(e,t)};t.UNSUPPORTED_Y=a((function(){var e=n("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=a((function(){var e=n("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},9441:function(e,t,i){var a=i(7293);e.exports=a((function(){var e=RegExp(".","string".charAt(0));return!(e.dotAll&&e.exec("\n")&&"s"===e.flags)}))},8173:function(e,t,i){var a=i(7293);e.exports=a((function(){var e=RegExp("(?<a>b)","string".charAt(5));return"b"!==e.exec("b").groups.a||"bc"!=="b".replace(e,"$<a>c")}))},4488:function(e){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},3505:function(e,t,i){var a=i(7854),n=i(8880);e.exports=function(e,t){try{n(a,e,t)}catch(i){a[e]=t}return t}},6340:function(e,t,i){"use strict";var a=i(5005),n=i(3070),r=i(5112),o=i(9781),s=r("species");e.exports=function(e){var t=a(e),i=n.f;o&&t&&!t[s]&&i(t,s,{configurable:!0,get:function(){return this}})}},8003:function(e,t,i){var a=i(3070).f,n=i(6656),r=i(5112)("toStringTag");e.exports=function(e,t,i){e&&!n(e=i?e:e.prototype,r)&&a(e,r,{configurable:!0,value:t})}},6200:function(e,t,i){var a=i(2309),n=i(9711),r=a("keys");e.exports=function(e){return r[e]||(r[e]=n(e))}},5465:function(e,t,i){var a=i(7854),n=i(3505),r="__core-js_shared__",o=a[r]||n(r,{});e.exports=o},2309:function(e,t,i){var a=i(1913),n=i(5465);(e.exports=function(e,t){return n[e]||(n[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.15.1",mode:a?"pure":"global",copyright:"© 2021 Denis Pushkarev (zloirock.ru)"})},6707:function(e,t,i){var a=i(9670),n=i(3099),r=i(5112)("species");e.exports=function(e,t){var i,o=a(e).constructor;return void 0===o||null==(i=a(o)[r])?t:n(i)}},8710:function(e,t,i){var a=i(9958),n=i(4488),r=function(e){return function(t,i){var r,o,s=String(n(t)),l=a(i),c=s.length;return l<0||l>=c?e?"":void 0:(r=s.charCodeAt(l))<55296||r>56319||l+1===c||(o=s.charCodeAt(l+1))<56320||o>57343?e?s.charAt(l):r:e?s.slice(l,l+2):o-56320+(r-55296<<10)+65536}};e.exports={codeAt:r(!1),charAt:r(!0)}},3111:function(e,t,i){var a=i(4488),n="["+i(1361)+"]",r=RegExp("^"+n+n+"*"),o=RegExp(n+n+"*$"),s=function(e){return function(t){var i=String(a(t));return 1&e&&(i=i.replace(r,"")),2&e&&(i=i.replace(o,"")),i}};e.exports={start:s(1),end:s(2),trim:s(3)}},261:function(e,t,i){var a,n,r,o=i(7854),s=i(7293),l=i(9974),c=i(490),d=i(317),m=i(6833),u=i(5268),h=o.location,p=o.setImmediate,_=o.clearImmediate,f=o.process,g=o.MessageChannel,T=o.Dispatch,D=0,v={},y="onreadystatechange",w=function(e){if(v.hasOwnProperty(e)){var t=v[e];delete v[e],t()}},S=function(e){return function(){w(e)}},b=function(e){w(e.data)},I=function(e){o.postMessage(e+"",h.protocol+"//"+h.host)};p&&_||(p=function(e){for(var t=[],i=1;arguments.length>i;)t.push(arguments[i++]);return v[++D]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},a(D),D},_=function(e){delete v[e]},u?a=function(e){f.nextTick(S(e))}:T&&T.now?a=function(e){T.now(S(e))}:g&&!m?(r=(n=new g).port2,n.port1.onmessage=b,a=l(r.postMessage,r,1)):o.addEventListener&&"function"==typeof postMessage&&!o.importScripts&&h&&"file:"!==h.protocol&&!s(I)?(a=I,o.addEventListener("message",b,!1)):a=y in d("script")?function(e){c.appendChild(d("script")).onreadystatechange=function(){c.removeChild(this),w(e)}}:function(e){setTimeout(S(e),0)}),e.exports={set:p,clear:_}},1400:function(e,t,i){var a=i(9958),n=Math.max,r=Math.min;e.exports=function(e,t){var i=a(e);return i<0?n(i+t,0):r(i,t)}},5656:function(e,t,i){var a=i(8361),n=i(4488);e.exports=function(e){return a(n(e))}},9958:function(e){var t=Math.ceil,i=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?i:t)(e)}},7466:function(e,t,i){var a=i(9958),n=Math.min;e.exports=function(e){return e>0?n(a(e),9007199254740991):0}},7908:function(e,t,i){var a=i(4488);e.exports=function(e){return Object(a(e))}},7593:function(e,t,i){var a=i(111);e.exports=function(e,t){if(!a(e))return e;var i,n;if(t&&"function"==typeof(i=e.toString)&&!a(n=i.call(e)))return n;if("function"==typeof(i=e.valueOf)&&!a(n=i.call(e)))return n;if(!t&&"function"==typeof(i=e.toString)&&!a(n=i.call(e)))return n;throw TypeError("Can't convert object to primitive value")}},1694:function(e,t,i){var a={};a[i(5112)("toStringTag")]="z",e.exports="[object z]"===String(a)},9711:function(e){var t=0,i=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++t+i).toString(36)}},3307:function(e,t,i){var a=i(133);e.exports=a&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},6061:function(e,t,i){var a=i(5112);t.f=a},5112:function(e,t,i){var a=i(7854),n=i(2309),r=i(6656),o=i(9711),s=i(133),l=i(3307),c=n("wks"),d=a.Symbol,m=l?d:d&&d.withoutSetter||o;e.exports=function(e){return r(c,e)&&(s||"string"==typeof c[e])||(s&&r(d,e)?c[e]=d[e]:c[e]=m("Symbol."+e)),c[e]}},1361:function(e){e.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},2222:function(e,t,i){"use strict";var a=i(2109),n=i(7293),r=i(3157),o=i(111),s=i(7908),l=i(7466),c=i(6135),d=i(5417),m=i(1194),u=i(5112),h=i(7392),p=u("isConcatSpreadable"),_=9007199254740991,f="Maximum allowed index exceeded",g=h>=51||!n((function(){var e=[];return e[p]=!1,e.concat()[0]!==e})),T=m("concat"),D=function(e){if(!o(e))return!1;var t=e[p];return void 0!==t?!!t:r(e)};a({target:"Array",proto:!0,forced:!g||!T},{concat:function(e){var t,i,a,n,r,o=s(this),m=d(o,0),u=0;for(t=-1,a=arguments.length;t<a;t++)if(D(r=-1===t?o:arguments[t])){if(u+(n=l(r.length))>_)throw TypeError(f);for(i=0;i<n;i++,u++)i in r&&c(m,u,r[i])}else{if(u>=_)throw TypeError(f);c(m,u++,r)}return m.length=u,m}})},6541:function(e,t,i){"use strict";var a=i(2109),n=i(2092).every;a({target:"Array",proto:!0,forced:!i(9341)("every")},{every:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},3290:function(e,t,i){var a=i(2109),n=i(1285),r=i(1223);a({target:"Array",proto:!0},{fill:n}),r("fill")},7327:function(e,t,i){"use strict";var a=i(2109),n=i(2092).filter;a({target:"Array",proto:!0,forced:!i(1194)("filter")},{filter:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},9554:function(e,t,i){"use strict";var a=i(2109),n=i(8533);a({target:"Array",proto:!0,forced:[].forEach!=n},{forEach:n})},2772:function(e,t,i){"use strict";var a=i(2109),n=i(1318).indexOf,r=i(9341),o=[].indexOf,s=!!o&&1/[1].indexOf(1,-0)<0,l=r("indexOf");a({target:"Array",proto:!0,forced:s||!l},{indexOf:function(e){return s?o.apply(this,arguments)||0:n(this,e,arguments.length>1?arguments[1]:void 0)}})},6992:function(e,t,i){"use strict";var a=i(5656),n=i(1223),r=i(7497),o=i(9909),s=i(654),l="Array Iterator",c=o.set,d=o.getterFor(l);e.exports=s(Array,"Array",(function(e,t){c(this,{type:l,target:a(e),index:0,kind:t})}),(function(){var e=d(this),t=e.target,i=e.kind,a=e.index++;return!t||a>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:a,done:!1}:"values"==i?{value:t[a],done:!1}:{value:[a,t[a]],done:!1}}),"values"),r.Arguments=r.Array,n("keys"),n("values"),n("entries")},9600:function(e,t,i){"use strict";var a=i(2109),n=i(8361),r=i(5656),o=i(9341),s=[].join,l=n!=Object,c=o("join",",");a({target:"Array",proto:!0,forced:l||!c},{join:function(e){return s.call(r(this),void 0===e?",":e)}})},1249:function(e,t,i){"use strict";var a=i(2109),n=i(2092).map;a({target:"Array",proto:!0,forced:!i(1194)("map")},{map:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},5827:function(e,t,i){"use strict";var a=i(2109),n=i(3671).left,r=i(9341),o=i(7392),s=i(5268);a({target:"Array",proto:!0,forced:!r("reduce")||!s&&o>79&&o<83},{reduce:function(e){return n(this,e,arguments.length,arguments.length>1?arguments[1]:void 0)}})},7042:function(e,t,i){"use strict";var a=i(2109),n=i(111),r=i(3157),o=i(1400),s=i(7466),l=i(5656),c=i(6135),d=i(5112),m=i(1194)("slice"),u=d("species"),h=[].slice,p=Math.max;a({target:"Array",proto:!0,forced:!m},{slice:function(e,t){var i,a,d,m=l(this),_=s(m.length),f=o(e,_),g=o(void 0===t?_:t,_);if(r(m)&&("function"!=typeof(i=m.constructor)||i!==Array&&!r(i.prototype)?n(i)&&null===(i=i[u])&&(i=void 0):i=void 0,i===Array||void 0===i))return h.call(m,f,g);for(a=new(void 0===i?Array:i)(p(g-f,0)),d=0;f<g;f++,d++)f in m&&c(a,d,m[f]);return a.length=d,a}})},5212:function(e,t,i){"use strict";var a=i(2109),n=i(2092).some;a({target:"Array",proto:!0,forced:!i(9341)("some")},{some:function(e){return n(this,e,arguments.length>1?arguments[1]:void 0)}})},561:function(e,t,i){"use strict";var a=i(2109),n=i(1400),r=i(9958),o=i(7466),s=i(7908),l=i(5417),c=i(6135),d=i(1194)("splice"),m=Math.max,u=Math.min,h=9007199254740991,p="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var i,a,d,_,f,g,T=s(this),D=o(T.length),v=n(e,D),y=arguments.length;if(0===y?i=a=0:1===y?(i=0,a=D-v):(i=y-2,a=u(m(r(t),0),D-v)),D+i-a>h)throw TypeError(p);for(d=l(T,a),_=0;_<a;_++)(f=v+_)in T&&c(d,_,T[f]);if(d.length=a,i<a){for(_=v;_<D-a;_++)g=_+i,(f=_+a)in T?T[g]=T[f]:delete T[g];for(_=D;_>D-a+i;_--)delete T[_-1]}else if(i>a)for(_=D-a;_>v;_--)g=_+i-1,(f=_+a-1)in T?T[g]=T[f]:delete T[g];for(_=0;_<i;_++)T[_+v]=arguments[_+2];return T.length=D-a+i,d}})},2420:function(e,t,i){i(2109)({target:"Math",stat:!0},{sign:i(4310)})},9653:function(e,t,i){"use strict";var a=i(9781),n=i(7854),r=i(4705),o=i(1320),s=i(6656),l=i(4326),c=i(9587),d=i(7593),m=i(7293),u=i(30),h=i(8006).f,p=i(1236).f,_=i(3070).f,f=i(3111).trim,g="Number",T=n.Number,D=T.prototype,v=l(u(D))==g,y=function(e){var t,i,a,n,r,o,s,l,c=d(e,!1);if("string"==typeof c&&c.length>2)if(43===(t=(c=f(c)).charCodeAt(0))||45===t){if(88===(i=c.charCodeAt(2))||120===i)return NaN}else if(48===t){switch(c.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+c}for(o=(r=c.slice(2)).length,s=0;s<o;s++)if((l=r.charCodeAt(s))<48||l>n)return NaN;return parseInt(r,a)}return+c};if(r(g,!T(" 0o1")||!T("0b1")||T("+0x1"))){for(var w,S=function(e){var t=arguments.length<1?0:e,i=this;return i instanceof S&&(v?m((function(){D.valueOf.call(i)})):l(i)!=g)?c(new T(y(t)),i,S):y(t)},b=a?h(T):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger,fromString,range".split(","),I=0;b.length>I;I++)s(T,w=b[I])&&!s(S,w)&&_(S,w,p(T,w));S.prototype=D,D.constructor=S,o(n,g,S)}},7941:function(e,t,i){var a=i(2109),n=i(7908),r=i(1956);a({target:"Object",stat:!0,forced:i(7293)((function(){r(1)}))},{keys:function(e){return r(n(e))}})},1539:function(e,t,i){var a=i(1694),n=i(1320),r=i(288);a||n(Object.prototype,"toString",r,{unsafe:!0})},8674:function(e,t,i){"use strict";var a,n,r,o,s=i(2109),l=i(1913),c=i(7854),d=i(5005),m=i(3366),u=i(1320),h=i(2248),p=i(7674),_=i(8003),f=i(6340),g=i(111),T=i(3099),D=i(5787),v=i(2788),y=i(408),w=i(7072),S=i(6707),b=i(261).set,I=i(5948),A=i(9478),E=i(842),R=i(8523),x=i(2534),C=i(9909),L=i(4705),B=i(5112),O=i(7871),M=i(5268),V=i(7392),k=B("species"),F="Promise",N=C.get,W=C.set,P=C.getterFor(F),H=m&&m.prototype,X=m,U=H,G=c.TypeError,Y=c.document,z=c.process,j=R.f,Z=j,K=!!(Y&&Y.createEvent&&c.dispatchEvent),q="function"==typeof PromiseRejectionEvent,Q="unhandledrejection",J=!1,$=L(F,(function(){var e=v(X)!==String(X);if(!e&&66===V)return!0;if(l&&!U.finally)return!0;if(V>=51&&/native code/.test(X))return!1;var t=new X((function(e){e(1)})),i=function(e){e((function(){}),(function(){}))};return(t.constructor={})[k]=i,!(J=t.then((function(){}))instanceof i)||!e&&O&&!q})),ee=$||!w((function(e){X.all(e).catch((function(){}))})),te=function(e){var t;return!(!g(e)||"function"!=typeof(t=e.then))&&t},ie=function(e,t){if(!e.notified){e.notified=!0;var i=e.reactions;I((function(){for(var a=e.value,n=1==e.state,r=0;i.length>r;){var o,s,l,c=i[r++],d=n?c.ok:c.fail,m=c.resolve,u=c.reject,h=c.domain;try{d?(n||(2===e.rejection&&oe(e),e.rejection=1),!0===d?o=a:(h&&h.enter(),o=d(a),h&&(h.exit(),l=!0)),o===c.promise?u(G("Promise-chain cycle")):(s=te(o))?s.call(o,m,u):m(o)):u(a)}catch(e){h&&!l&&h.exit(),u(e)}}e.reactions=[],e.notified=!1,t&&!e.rejection&&ne(e)}))}},ae=function(e,t,i){var a,n;K?((a=Y.createEvent("Event")).promise=t,a.reason=i,a.initEvent(e,!1,!0),c.dispatchEvent(a)):a={promise:t,reason:i},!q&&(n=c["on"+e])?n(a):e===Q&&E("Unhandled promise rejection",i)},ne=function(e){b.call(c,(function(){var t,i=e.facade,a=e.value;if(re(e)&&(t=x((function(){M?z.emit("unhandledRejection",a,i):ae(Q,i,a)})),e.rejection=M||re(e)?2:1,t.error))throw t.value}))},re=function(e){return 1!==e.rejection&&!e.parent},oe=function(e){b.call(c,(function(){var t=e.facade;M?z.emit("rejectionHandled",t):ae("rejectionhandled",t,e.value)}))},se=function(e,t,i){return function(a){e(t,a,i)}},le=function(e,t,i){e.done||(e.done=!0,i&&(e=i),e.value=t,e.state=2,ie(e,!0))},ce=function(e,t,i){if(!e.done){e.done=!0,i&&(e=i);try{if(e.facade===t)throw G("Promise can't be resolved itself");var a=te(t);a?I((function(){var i={done:!1};try{a.call(t,se(ce,i,e),se(le,i,e))}catch(t){le(i,t,e)}})):(e.value=t,e.state=1,ie(e,!1))}catch(t){le({done:!1},t,e)}}};if($&&(U=(X=function(e){D(this,X,F),T(e),a.call(this);var t=N(this);try{e(se(ce,t),se(le,t))}catch(e){le(t,e)}}).prototype,(a=function(e){W(this,{type:F,done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=h(U,{then:function(e,t){var i=P(this),a=j(S(this,X));return a.ok="function"!=typeof e||e,a.fail="function"==typeof t&&t,a.domain=M?z.domain:void 0,i.parent=!0,i.reactions.push(a),0!=i.state&&ie(i,!1),a.promise},catch:function(e){return this.then(void 0,e)}}),n=function(){var e=new a,t=N(e);this.promise=e,this.resolve=se(ce,t),this.reject=se(le,t)},R.f=j=function(e){return e===X||e===r?new n(e):Z(e)},!l&&"function"==typeof m&&H!==Object.prototype)){o=H.then,J||(u(H,"then",(function(e,t){var i=this;return new X((function(e,t){o.call(i,e,t)})).then(e,t)}),{unsafe:!0}),u(H,"catch",U.catch,{unsafe:!0}));try{delete H.constructor}catch(e){}p&&p(H,U)}s({global:!0,wrap:!0,forced:$},{Promise:X}),_(X,F,!1,!0),f(F),r=d(F),s({target:F,stat:!0,forced:$},{reject:function(e){var t=j(this);return t.reject.call(void 0,e),t.promise}}),s({target:F,stat:!0,forced:l||$},{resolve:function(e){return A(l&&this===r?X:this,e)}}),s({target:F,stat:!0,forced:ee},{all:function(e){var t=this,i=j(t),a=i.resolve,n=i.reject,r=x((function(){var i=T(t.resolve),r=[],o=0,s=1;y(e,(function(e){var l=o++,c=!1;r.push(void 0),s++,i.call(t,e).then((function(e){c||(c=!0,r[l]=e,--s||a(r))}),n)})),--s||a(r)}));return r.error&&n(r.value),i.promise},race:function(e){var t=this,i=j(t),a=i.reject,n=x((function(){var n=T(t.resolve);y(e,(function(e){n.call(t,e).then(i.resolve,a)}))}));return n.error&&a(n.value),i.promise}})},4916:function(e,t,i){"use strict";var a=i(2109),n=i(2261);a({target:"RegExp",proto:!0,forced:/./.exec!==n},{exec:n})},9714:function(e,t,i){"use strict";var a=i(1320),n=i(9670),r=i(7293),o=i(7066),s="toString",l=RegExp.prototype,c=l.toString,d=r((function(){return"/a/b"!=c.call({source:"a",flags:"b"})})),m=c.name!=s;(d||m)&&a(RegExp.prototype,s,(function(){var e=n(this),t=String(e.source),i=e.flags;return"/"+t+"/"+String(void 0===i&&e instanceof RegExp&&!("flags"in l)?o.call(e):i)}),{unsafe:!0})},8783:function(e,t,i){"use strict";var a=i(8710).charAt,n=i(9909),r=i(654),o="String Iterator",s=n.set,l=n.getterFor(o);r(String,"String",(function(e){s(this,{type:o,string:String(e),index:0})}),(function(){var e,t=l(this),i=t.string,n=t.index;return n>=i.length?{value:void 0,done:!0}:(e=a(i,n),t.index+=e.length,{value:e,done:!1})}))},5306:function(e,t,i){"use strict";var a=i(7007),n=i(7293),r=i(9670),o=i(7466),s=i(9958),l=i(4488),c=i(1530),d=i(647),m=i(7651),u=i(5112)("replace"),h=Math.max,p=Math.min,_="$0"==="a".replace(/./,"$0"),f=!!/./[u]&&""===/./[u]("a","$0");a("replace",(function(e,t,i){var a=f?"$":"$0";return[function(e,i){var a=l(this),n=null==e?void 0:e[u];return void 0!==n?n.call(e,a,i):t.call(String(a),e,i)},function(e,n){if("string"==typeof n&&-1===n.indexOf(a)&&-1===n.indexOf("$<")){var l=i(t,this,e,n);if(l.done)return l.value}var u=r(this),_=String(e),f="function"==typeof n;f||(n=String(n));var g=u.global;if(g){var T=u.unicode;u.lastIndex=0}for(var D=[];;){var v=m(u,_);if(null===v)break;if(D.push(v),!g)break;""===String(v[0])&&(u.lastIndex=c(_,o(u.lastIndex),T))}for(var y,w="",S=0,b=0;b<D.length;b++){v=D[b];for(var I=String(v[0]),A=h(p(s(v.index),_.length),0),E=[],R=1;R<v.length;R++)E.push(void 0===(y=v[R])?y:String(y));var x=v.groups;if(f){var C=[I].concat(E,A,_);void 0!==x&&C.push(x);var L=String(n.apply(void 0,C))}else L=d(I,_,A,E,x,n);A>=S&&(w+=_.slice(S,A)+L,S=A+I.length)}return w+_.slice(S)}]}),!!n((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}))||!_||f)},3123:function(e,t,i){"use strict";var a=i(7007),n=i(7850),r=i(9670),o=i(4488),s=i(6707),l=i(1530),c=i(7466),d=i(7651),m=i(2261),u=i(2999),h=i(7293),p=u.UNSUPPORTED_Y,_=[].push,f=Math.min,g=4294967295;a("split",(function(e,t,i){var a;return a="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,i){var a=String(o(this)),r=void 0===i?g:i>>>0;if(0===r)return[];if(void 0===e)return[a];if(!n(e))return t.call(a,e,r);for(var s,l,c,d=[],u=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,p=new RegExp(e.source,u+"g");(s=m.call(p,a))&&!((l=p.lastIndex)>h&&(d.push(a.slice(h,s.index)),s.length>1&&s.index<a.length&&_.apply(d,s.slice(1)),c=s[0].length,h=l,d.length>=r));)p.lastIndex===s.index&&p.lastIndex++;return h===a.length?!c&&p.test("")||d.push(""):d.push(a.slice(h)),d.length>r?d.slice(0,r):d}:"0".split(void 0,0).length?function(e,i){return void 0===e&&0===i?[]:t.call(this,e,i)}:t,[function(t,i){var n=o(this),r=null==t?void 0:t[e];return void 0!==r?r.call(t,n,i):a.call(String(n),t,i)},function(e,n){var o=i(a,this,e,n,a!==t);if(o.done)return o.value;var m=r(this),u=String(e),h=s(m,RegExp),_=m.unicode,T=(m.ignoreCase?"i":"")+(m.multiline?"m":"")+(m.unicode?"u":"")+(p?"g":"y"),D=new h(p?"^(?:"+m.source+")":m,T),v=void 0===n?g:n>>>0;if(0===v)return[];if(0===u.length)return null===d(D,u)?[u]:[];for(var y=0,w=0,S=[];w<u.length;){D.lastIndex=p?0:w;var b,I=d(D,p?u.slice(w):u);if(null===I||(b=f(c(D.lastIndex+(p?w:0)),u.length))===y)w=l(u,w,_);else{if(S.push(u.slice(y,w)),S.length===v)return S;for(var A=1;A<=I.length-1;A++)if(S.push(I[A]),S.length===v)return S;w=y=b}}return S.push(u.slice(y)),S}]}),!!h((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var i="ab".split(e);return 2!==i.length||"a"!==i[0]||"b"!==i[1]})),p)},1817:function(e,t,i){"use strict";var a=i(2109),n=i(9781),r=i(7854),o=i(6656),s=i(111),l=i(3070).f,c=i(9920),d=r.Symbol;if(n&&"function"==typeof d&&(!("description"in d.prototype)||void 0!==d().description)){var m={},u=function(){var e=arguments.length<1||void 0===arguments[0]?void 0:String(arguments[0]),t=this instanceof u?new d(e):void 0===e?d():d(e);return""===e&&(m[t]=!0),t};c(u,d);var h=u.prototype=d.prototype;h.constructor=u;var p=h.toString,_="Symbol(test)"==String(d("test")),f=/^Symbol\((.*)\)[^)]+$/;l(h,"description",{configurable:!0,get:function(){var e=s(this)?this.valueOf():this,t=p.call(e);if(o(m,e))return"";var i=_?t.slice(7,-1):t.replace(f,"$1");return""===i?void 0:i}}),a({global:!0,forced:!0},{Symbol:u})}},2165:function(e,t,i){i(7235)("iterator")},2526:function(e,t,i){"use strict";var a=i(2109),n=i(7854),r=i(5005),o=i(1913),s=i(9781),l=i(133),c=i(3307),d=i(7293),m=i(6656),u=i(3157),h=i(111),p=i(9670),_=i(7908),f=i(5656),g=i(7593),T=i(9114),D=i(30),v=i(1956),y=i(8006),w=i(1156),S=i(5181),b=i(1236),I=i(3070),A=i(5296),E=i(8880),R=i(1320),x=i(2309),C=i(6200),L=i(3501),B=i(9711),O=i(5112),M=i(6061),V=i(7235),k=i(8003),F=i(9909),N=i(2092).forEach,W=C("hidden"),P="Symbol",H=O("toPrimitive"),X=F.set,U=F.getterFor(P),G=Object.prototype,Y=n.Symbol,z=r("JSON","stringify"),j=b.f,Z=I.f,K=w.f,q=A.f,Q=x("symbols"),J=x("op-symbols"),$=x("string-to-symbol-registry"),ee=x("symbol-to-string-registry"),te=x("wks"),ie=n.QObject,ae=!ie||!ie.prototype||!ie.prototype.findChild,ne=s&&d((function(){return 7!=D(Z({},"a",{get:function(){return Z(this,"a",{value:7}).a}})).a}))?function(e,t,i){var a=j(G,t);a&&delete G[t],Z(e,t,i),a&&e!==G&&Z(G,t,a)}:Z,re=function(e,t){var i=Q[e]=D(Y.prototype);return X(i,{type:P,tag:e,description:t}),s||(i.description=t),i},oe=c?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof Y},se=function(e,t,i){e===G&&se(J,t,i),p(e);var a=g(t,!0);return p(i),m(Q,a)?(i.enumerable?(m(e,W)&&e[W][a]&&(e[W][a]=!1),i=D(i,{enumerable:T(0,!1)})):(m(e,W)||Z(e,W,T(1,{})),e[W][a]=!0),ne(e,a,i)):Z(e,a,i)},le=function(e,t){p(e);var i=f(t),a=v(i).concat(ue(i));return N(a,(function(t){s&&!ce.call(i,t)||se(e,t,i[t])})),e},ce=function(e){var t=g(e,!0),i=q.call(this,t);return!(this===G&&m(Q,t)&&!m(J,t))&&(!(i||!m(this,t)||!m(Q,t)||m(this,W)&&this[W][t])||i)},de=function(e,t){var i=f(e),a=g(t,!0);if(i!==G||!m(Q,a)||m(J,a)){var n=j(i,a);return!n||!m(Q,a)||m(i,W)&&i[W][a]||(n.enumerable=!0),n}},me=function(e){var t=K(f(e)),i=[];return N(t,(function(e){m(Q,e)||m(L,e)||i.push(e)})),i},ue=function(e){var t=e===G,i=K(t?J:f(e)),a=[];return N(i,(function(e){!m(Q,e)||t&&!m(G,e)||a.push(Q[e])})),a};(l||(R((Y=function(){if(this instanceof Y)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=B(e),i=function(e){this===G&&i.call(J,e),m(this,W)&&m(this[W],t)&&(this[W][t]=!1),ne(this,t,T(1,e))};return s&&ae&&ne(G,t,{configurable:!0,set:i}),re(t,e)}).prototype,"toString",(function(){return U(this).tag})),R(Y,"withoutSetter",(function(e){return re(B(e),e)})),A.f=ce,I.f=se,b.f=de,y.f=w.f=me,S.f=ue,M.f=function(e){return re(O(e),e)},s&&(Z(Y.prototype,"description",{configurable:!0,get:function(){return U(this).description}}),o||R(G,"propertyIsEnumerable",ce,{unsafe:!0}))),a({global:!0,wrap:!0,forced:!l,sham:!l},{Symbol:Y}),N(v(te),(function(e){V(e)})),a({target:P,stat:!0,forced:!l},{for:function(e){var t=String(e);if(m($,t))return $[t];var i=Y(t);return $[t]=i,ee[i]=t,i},keyFor:function(e){if(!oe(e))throw TypeError(e+" is not a symbol");if(m(ee,e))return ee[e]},useSetter:function(){ae=!0},useSimple:function(){ae=!1}}),a({target:"Object",stat:!0,forced:!l,sham:!s},{create:function(e,t){return void 0===t?D(e):le(D(e),t)},defineProperty:se,defineProperties:le,getOwnPropertyDescriptor:de}),a({target:"Object",stat:!0,forced:!l},{getOwnPropertyNames:me,getOwnPropertySymbols:ue}),a({target:"Object",stat:!0,forced:d((function(){S.f(1)}))},{getOwnPropertySymbols:function(e){return S.f(_(e))}}),z)&&a({target:"JSON",stat:!0,forced:!l||d((function(){var e=Y();return"[null]"!=z([e])||"{}"!=z({a:e})||"{}"!=z(Object(e))}))},{stringify:function(e,t,i){for(var a,n=[e],r=1;arguments.length>r;)n.push(arguments[r++]);if(a=t,(h(t)||void 0!==e)&&!oe(e))return u(t)||(t=function(e,t){if("function"==typeof a&&(t=a.call(this,e,t)),!oe(t))return t}),n[1]=t,z.apply(null,n)}});Y.prototype[H]||E(Y.prototype,H,Y.prototype.valueOf),k(Y,P),L[W]=!0},4747:function(e,t,i){var a=i(7854),n=i(8324),r=i(8533),o=i(8880);for(var s in n){var l=a[s],c=l&&l.prototype;if(c&&c.forEach!==r)try{o(c,"forEach",r)}catch(e){c.forEach=r}}},3948:function(e,t,i){var a=i(7854),n=i(8324),r=i(6992),o=i(8880),s=i(5112),l=s("iterator"),c=s("toStringTag"),d=r.values;for(var m in n){var u=a[m],h=u&&u.prototype;if(h){if(h[l]!==d)try{o(h,l,d)}catch(e){h[l]=d}if(h[c]||o(h,c,m),n[m])for(var p in r)if(h[p]!==r[p])try{o(h,p,r[p])}catch(e){h[p]=r[p]}}}},5680:function(e){"use strict";e.exports=a},7930:function(t){"use strict";t.exports=e},7920:function(e){"use strict";e.exports=n},3755:function(e){"use strict";e.exports=t},2228:function(e){"use strict";e.exports=i}},o={};function s(e){if(o[e])return o[e].exports;var t=o[e]={exports:{}};return r[e](t,t.exports,s),t.exports}return s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s(5579)}()}));